<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; LMER: Average Change Over Time – Advanced Modeling and Reproducibility for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-03-lmer-other-random-effects-and-covariates.html" rel="next">
<link href="./05-01-introduction-to-mixed-effects-models.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed04999718f06b735b1f8009dce43b94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7c121de436c7c20b050f1da4c0bef0bb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-00-modeling-nonindependence.html">Modeling Nonindependence</a></li><li class="breadcrumb-item"><a href="./05-02-lmer-average-change-over-time.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Modeling and Reproducibility for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-introduction-to-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-more-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-creating-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Tables with gt</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-mathematical-foundations-probability-density.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-likelihood-framework-for-evidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-likelihood-framework-for-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-modeling-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonlinearity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-polynomial-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Polynomial Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-information-criteria-and-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Information Criteria and Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-03-logarithmic-transformations-predictor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-04-logarithmic-transformations-outcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-05-rule-of-the-bulge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Rule of the Bulge—An Example”</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-00-modeling-dichotomous-outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Dichotomous Outcomes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-01-linear-probability-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-02-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-03-more-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">More Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-00-modeling-nonindependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonindependence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-01-introduction-to-mixed-effects-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to Mixed-Effects Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-02-lmer-average-change-over-time.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-03-lmer-other-random-effects-and-covariates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">LMER: Other Random-Effects and Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-04-lmer-alt-representations-and-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">LMER: Alternative Representations and Assumptions</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05-00-modeling-nonindependence.html">Modeling Nonindependence</a></li><li class="breadcrumb-item"><a href="./05-02-lmer-average-change-over-time.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Quarto Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this set of notes, you will learn how to use the linear mixed-effects model to examine the mean change over time in a set of longitudinal/repeated measurements. To do this, we will use data from the file <a href="https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/vocabulary.csv"><em>vocabulary.csv</em></a> (see <a href="http://zief0002.github.io/fluffy-ants/codebooks/vocabulary.html">data codebook</a>).</p>
<p>These data include repeated measurements of scaled vocabulary scores for <span class="math inline">\(n=64\)</span> students.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#for tidy, glance, and augment functions for lme4 models</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#for fitting mixed-effects models</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/vocabulary.csv"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>vocabulary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 6
      id vocab_08 vocab_09 vocab_10 vocab_11 female
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1     1     1.75     2.6      3.76     3.68      1
 2     2     0.9      2.47     2.44     3.43      0
 3     3     0.8      0.93     0.4      2.27      0
 4     4     2.42     4.15     4.56     4.21      1
 5     5    -1.31    -1.31    -0.66    -2.22      0
 6     6    -1.56     1.67     0.18     2.33      0
 7     7     1.09     1.5      0.52     2.33      0
 8     8    -1.92     1.03     0.5      3.04      0
 9     9    -1.61     0.29     0.73     3.24      0
10    10     2.47     3.64     2.87     5.38      1
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>We will use these data to explore the change in vocabulary over time (longitudinal variation in the vocabulary scores). In most longitudinal analyses, the primary goal is to examine the mean change of some outcome over time. To do this we will focus on the following research question: (1) What is the growth pattern in the average vocabulary score over time?</p>
<p><br></p>
<section id="data-structure-tidylong-data-vs.-wide-data" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="data-structure-tidylong-data-vs.-wide-data"><span class="header-section-number">17.1</span> Data Structure: Tidy/Long Data vs.&nbsp;Wide Data</h2>
<p>Before doing any analysis of the data, it is worth understanding the structure of the data. There are two common structures for repeated measures data: <em>tidy/long structured data</em> and <em>wide structured data</em>.</p>
<ul>
<li>In <strong>tidy/long</strong> structured data, there is a single column per variable. For example, the outcome variable (vocabulary scores) would be organized into a single column. Similarly, the predictor that designates time (grade-level in our example) would also be organized into a single column.</li>
<li>In <strong>wide</strong> structured data, the outcome variable (or predictor variables) is typically spread out over multiple columns. Often there are not columns that include data on the time predictor; instead this information is typically embedded in the column name.</li>
</ul>
<p>The vocabulary data is currently structured as wide data; the vocabulary scores are organized into four separate columns and the information about grade-level (the time predictor) is embedded in the variable names (e.g., <code>vocab_08</code> indicates 8th-grade). The same data are presented below in the tidy/long structure.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 256 × 4
      id female grade    vocab_score
   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
 1     1      1 vocab_08        1.75
 2     1      1 vocab_09        2.6 
 3     1      1 vocab_10        3.76
 4     1      1 vocab_11        3.68
 5     2      0 vocab_08        0.9 
 6     2      0 vocab_09        2.47
 7     2      0 vocab_10        2.44
 8     2      0 vocab_11        3.43
 9     3      0 vocab_08        0.8 
10     3      0 vocab_09        0.93
# ℹ 246 more rows</code></pre>
</div>
</div>
<p>Notice that in the tidy/long structured data that the vocabulary scores (outcome) are now organized into a single column. Grade-level (the time predictor) is also now explicitly included in the data and is also organized as a single column in the data. Note that in the long structure, each row now represents a particular student at a particular grade-level, and that each student’s data now encompasses several rows.</p>
<p>There are advantages to each of the structures. For example the wide structure has the advantage of being a better structure for data entry. Since each row corresponds to a different student, there are fewer rows and therefore less redundancy in the data entry process. Compare this to the tidy/long data where each student’s data encompasses four rows. If you were doing data entry in this structure you would need to record the student’s sex four times rather than once in the wide structure.</p>
<p>The tidy/long structure is the structure that is needed for modeling. Thus, if one of the analytic goals is to fit a linear mixed-effects model to explain variation or examine predictor effects, the tidy/long data structure is key. Note that the wide structured data is also used in some analyses (e.g., computing correlations).</p>
<p><br></p>
<section id="switching-between-the-two-data-structures" class="level3" data-number="17.1.1">
<h3 data-number="17.1.1" class="anchored" data-anchor-id="switching-between-the-two-data-structures"><span class="header-section-number">17.1.1</span> Switching between the Two Data Structures</h3>
<p>The library <code>{tidyr}</code> (loaded as part of the <code>{tidyverse}</code> metapackage) has two functions that convert data between these two structures:</p>
<ul>
<li><code>pivot_longer()</code> (wide <span class="math inline">\(\rightarrow\)</span> tidy/long), and</li>
<li><code>pivot_wider()</code> (tidy/long <span class="math inline">\(\rightarrow\)</span> wide).</li>
</ul>
<p>Below, I show the code for going from the wide structured data (<code>vocabulary</code>) to the tidy/long structure.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert from wide to long structured data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vocabulary_long <span class="ot">=</span> vocabulary <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> vocab_08<span class="sc">:</span>vocab_11, <span class="at">names_to =</span> <span class="st">"grade"</span>, <span class="at">values_to =</span> <span class="st">"vocab_score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, grade)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>vocabulary_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 256 × 4
      id female grade    vocab_score
   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
 1     1      1 vocab_08        1.75
 2     1      1 vocab_09        2.6 
 3     1      1 vocab_10        3.76
 4     1      1 vocab_11        3.68
 5     2      0 vocab_08        0.9 
 6     2      0 vocab_09        2.47
 7     2      0 vocab_10        2.44
 8     2      0 vocab_11        3.43
 9     3      0 vocab_08        0.8 
10     3      0 vocab_09        0.93
# ℹ 246 more rows</code></pre>
</div>
</div>
<p>Here is an animated tutorial for understanding this syntax.</p>
<iframe height="750" src="https://haswal.github.io/pivot/" onload="javascript:(function(o){o.style.height=o.contentWindow.document.body.scrollHeight+&quot;px&quot;;}(this));" style="height:750px;width:100%;border:none;overflow:hidden;"></iframe>
<p>For more information about using these functions, Google “tidyr pivot” and read through any number of great tutorials or vignettes; for example <a href="https://tidyr.tidyverse.org/articles/pivot.html">here</a>. You can also read Hadley Wickham’s <span class="citation" data-cites="Wickham:2014">(<a href="#ref-Wickham:2014" role="doc-biblioref">2014</a>)</span> original paper on tidy data.</p>
<p><br></p>
</section>
</section>
<section id="exploration-plot-of-the-mean-and-individual-profiles" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="exploration-plot-of-the-mean-and-individual-profiles"><span class="header-section-number">17.2</span> Exploration: Plot of the Mean and Individual Profiles</h2>
<p>There are two plots that are particularly useful in exploring longitudinal data. The first is a plot of the mean value of the outcome at each time point (<em>mean profile plot</em>). This shows the average growth profile and is useful for determining the functional form of the fixed-effects part of the model; is the mean change over time linear? Quadratic? Log-linear?</p>
<p>Another plot that is often examined is a plot of the individual patterns or profiles, referred to as a <em>spaghetti plot</em>. A spaghetti plot is useful for determining whether there is variation from the average profile. This helps us to consider the set of random-effects to include in the model. Below we examine both the mean profile and individual profiles simultaneously.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>                      <span class="co">#Add individual profiles</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">group =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#Add mean profile line</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>           <span class="co">#Add mean profile points</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"8th-grade"</span>, <span class="st">"9th-grade"</span>, <span class="st">"10th-grade"</span>, <span class="st">"11th-grade"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ind-profiles" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot showing the change in vocabulary score over time for 64 students. The average growth profile is displayed as a thicker line." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ind-profiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-ind-profiles-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Plot showing the change in vocabulary score over time for 64 students. The average growth profile is displayed as a thicker line.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ind-profiles-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.1: Plot showing the change in vocabulary score over time for 64 students. The average growth profile is displayed as a thicker line.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Because our research question is focused on examining the average change of vocabulary scores over time, we will focus on the mean profile. Based on this plot:</p>
<ul>
<li>The average profile displays change over time that is positive (growth) and linear (or perhaps log-linear).</li>
</ul>
<p><br></p>
</section>
<section id="unconditional-random-intercepts-model" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="unconditional-random-intercepts-model"><span class="header-section-number">17.3</span> Unconditional Random Intercepts Model</h2>
<p>As in a conventional fixed-effects regression analysis we begin a mixed-effects analysis by fitting the intercept-only model. This model is referred to as the <em>unconditional random intercepts model</em> or the <em>unconditional means model</em>. The model posits that there is <em>no change over time</em> in the average vocabulary score.</p>
<p>This model includes a fixed-effect of intercept and a random-effect of intercept, and no other predictors. This is the simplest model we can fit while still accounting for the dependence in the data (e.g., including a random-effect). The statistical model in this example can be expressed as:</p>
<p><span class="math display">\[
\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \epsilon_{ij}
\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(\mathrm{Vocabulary~Score}_{ij}\)</span> is the vocabulary score for Student <span class="math inline">\(j\)</span> at time point <span class="math inline">\(i\)</span>;</li>
<li><span class="math inline">\(\beta_0\)</span> is the fixed-effect of intercept;</li>
<li><span class="math inline">\(b_{0j}\)</span> is the random-effect of intercept for Student <span class="math inline">\(j\)</span>; and</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> is the error for Student <span class="math inline">\(j\)</span> at time point <span class="math inline">\(i\)</span>.</li>
</ul>
<p><br></p>
<section id="fitting-and-interpreting-the-model" class="level3" data-number="17.3.1">
<h3 data-number="17.3.1" class="anchored" data-anchor-id="fitting-and-interpreting-the-model"><span class="header-section-number">17.3.1</span> Fitting and Interpreting the Model</h3>
<p>We fit the model and display the output below. We include the argument <code>REML=FALSE</code> to force the <code>lmer()</code> function to produce maximum likelihood estimates (rather than restricted maximum likelihood estimates). In practice, we will generally want to fit these models using ML estimation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Recall that there are two types of fitted equations we can produce from this model: (1) the global fitted equation, and (2) student-specific fitted equation. The global fitted equation is based on only the fixed effects. We obtain the fixed-effects estimates using the <code>tidy()</code> function from the <code>{broom.mixed}</code> package with the argument <code>effects="fixed"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  effect term        estimate std.error statistic
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  (Intercept)     2.53     0.231      11.0</code></pre>
</div>
</div>
<p>Using the fixed-effects estimates, the global fitted equation based on the fixed-effects model is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = 2.53
\]</span></p>
<p>We interpret coefficients from the fixed-effects model the same way we interpret coefficients produced from the <code>lm()</code> output. For example,</p>
<ul>
<li>The predicted average vocabulary language score for all students at all time points is 2.53.</li>
</ul>
<p>We can also write the student specific fitted equations. Each student specific fitted equation is based on the fixed-effects AND the student-specific random-effect. To obtain the student-specific random-effects we use the <code>tidy()</code> function from the <code>{broom.mixed}</code> package with the argument <code>effects="ran_vals"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain random effects</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_vals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 6
   effect   group level term        estimate std.error
   &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
 1 ran_vals id    1     (Intercept)    0.359     0.629
 2 ran_vals id    2     (Intercept)   -0.193     0.629
 3 ran_vals id    3     (Intercept)   -1.24      0.629
 4 ran_vals id    4     (Intercept)    1.13      0.629
 5 ran_vals id    5     (Intercept)   -3.38      0.629
 6 ran_vals id    6     (Intercept)   -1.63      0.629
 7 ran_vals id    7     (Intercept)   -1.02      0.629
 8 ran_vals id    8     (Intercept)   -1.62      0.629
 9 ran_vals id    9     (Intercept)   -1.62      0.629
10 ran_vals id    10    (Intercept)    0.915     0.629
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>For example, Student 1’s fitted equation is:</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Vocabulary~Score}_{i1}} &amp;= 2.53 + 0.359 \\[1ex]\hat{\mathrm{Vocabulary~Score}_{i1}} &amp;= 2.53 + 0.359 \\[1ex]
&amp;= 2.89
\end{split}
\]</span></p>
<ul>
<li>The predicted average vocabulary language score for Student 1 at all time points is 2.889.</li>
</ul>
<p>The argument <code>effects="ran_coefs"</code> in the <code>tidy()</code> function gives the student-specific intercepts directly.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain student-specific coefficients</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 5
   effect    group level term        estimate
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;
 1 ran_coefs id    1     (Intercept)    2.89 
 2 ran_coefs id    2     (Intercept)    2.34 
 3 ran_coefs id    3     (Intercept)    1.29 
 4 ran_coefs id    4     (Intercept)    3.66 
 5 ran_coefs id    5     (Intercept)   -0.852
 6 ran_coefs id    6     (Intercept)    0.907
 7 ran_coefs id    7     (Intercept)    1.52 
 8 ran_coefs id    8     (Intercept)    0.913
 9 ran_coefs id    9     (Intercept)    0.913
10 ran_coefs id    10    (Intercept)    3.45 
# ℹ 54 more rows</code></pre>
</div>
</div>
<p>From here, we see that Student 2’s fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{i2}} = 2.34
\]</span></p>
<p>The predicted average vocabulary language score for Student 2 (at all time points) is 2.34. From the two students’ fitted equations we see that Student 1’s “growth” curve is higher than the average “growth” curve and Student 2’s “growth” curve is lower than the average “growth” curve. Here is a plot of those three “growth” curves.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.53</span>) <span class="sc">+</span> <span class="co">#Global 'growth' curve</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.89</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span> <span class="co">#Student 1 'growth' curve</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.34</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span> <span class="co">#Student 1 'growth' curve</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"8th-grade"</span>, <span class="st">"9th-grade"</span>, <span class="st">"10th-grade"</span>, <span class="st">"11th-grade"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fitted-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-fitted-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.2: Predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="partitioning-unexplained-variation" class="level3" data-number="17.3.2">
<h3 data-number="17.3.2" class="anchored" data-anchor-id="partitioning-unexplained-variation"><span class="header-section-number">17.3.2</span> Partitioning Unexplained Variation</h3>
<p>This model is not very informative for applied researchers in terms of characterizing change over time, but it is essential to decompose the variation into within- and between-subjects variation. In our model, there are two sources of variation. The first source of variation measures the between-student variation (how different are students’ individual “growth” curves). The second source of variation measures the within-student variation (how different are an individual’s outcome values from their individual “growth” curve).</p>
<p>To see this graphically, we show Student 1’s data along with the global “growth” curve and Student 1’s specific “growth” curves. The between-student variation is akin to the average of the squared deviations between each student-specific “growth” curve and the global “growth” curve. The left-hand plot below shows these residuals for Student 1, referred to as <em>Level-2 residuals</em>. The within-student variation is akin to the average of the squared deviations between each student’s outcome (vocabulary scores) and that student’s specific “growth” curve. The right-hand plot below shows these residuals for Student 1, referred to as <em>Level-1 residuals</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-between-and-within-variation" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Student 1's vocabulary scores at each time point along with the predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line) and Student 1 (blue, dashed line). The between-student variation (LEFT) and within-student variation (RIGHT) based on the residuals for Student 1 are also displayed." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-between-and-within-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/lmer-sources-of-variation.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Student 1's vocabulary scores at each time point along with the predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line) and Student 1 (blue, dashed line). The between-student variation (LEFT) and within-student variation (RIGHT) based on the residuals for Student 1 are also displayed.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-between-and-within-variation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.3: Student 1’s vocabulary scores at each time point along with the predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line) and Student 1 (blue, dashed line). The between-student variation (LEFT) and within-student variation (RIGHT) based on the residuals for Student 1 are also displayed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We quantify the amount of between- and within-student variation using an estimate of variance. The between-student variance estimate is denoted <span class="math inline">\(\sigma^2_{b_0}\)</span> (or simply <span class="math inline">\(\sigma^20\)</span>), and the within-student variance estimate is denoted <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. We can access these paramater estimates using the argument <code>effects="ran_pars"</code> in the <code>tidy()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain variance estimates</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  effect   group    term            estimate
  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
1 ran_pars id       sd__(Intercept)     1.72
2 ran_pars Residual sd__Observation     1.35</code></pre>
</div>
</div>
<p>Note that the output is in the standard deviation metric. We need to square these values to get the actual variance estimates.</p>
<p><strong>Between-Student Variance:</strong></p>
<p><span class="math display">\[
\hat\sigma^2_0 = 1.72^2 = 2.96
\]</span></p>
<p><strong>Within-Student Variance:</strong></p>
<p><span class="math display">\[
\hat\sigma^2_{\epsilon} = 1.35^2 = 1.82
\]</span></p>
<p>These values represent the unexplained variation at each level. The total unexplained variation is the sum of these two terms.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total unexplained variation</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.78</code></pre>
</div>
</div>
<p>We can compute the proportion of unexplained variation at each level by dividing the appropriate variance estimate by this total.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of unexplained variation that is between-subjects</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fl">2.96</span> <span class="sc">/</span> (<span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6192469</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of unexplained variation that is within-subjects</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.82</span> <span class="sc">/</span> (<span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3807531</code></pre>
</div>
</div>
<p>Interpreting these values:</p>
<ul>
<li>Roughly 62% of the unexplained variation in vocabulary scores is between-student variation.</li>
<li>Roughly 38% of the unexplained variation in vocabulary scores is within-student variation.</li>
</ul>
<p>Based on this partitioning from the unconditional random intercepts model we have evidence that it may be fortuitous to include both between-student and within-student predictors; there is unaccounted for variation at both levels. To explain the unaccounted for between-student variation, include between-student-level predictors (e.g., <code>female</code>) in the model. To explain the unaccounted for within-student variation, include within-student predictors (e.g., <code>grade</code>) in the model.</p>
<p>Since the larger proportion of unexplained variation is between-student variation, we might ultimately focus on between-student predictors more than within-student predictors. However, because this is a longitudinal analysis, our primary focus is on the <code>grade</code> predictor, which is a within-subjects predictor. It is here that we turn next.</p>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>This partitioning of variation should be done in every analysis, and ALWAYS is done using the unconditional random intercepts model. The unconditional random intercepts model will serve as our <em>baseline</em> model. As we add predictors, we can compare the unexplained variation at each level in the predictor models to the baseline unaccounted for variation in the unconditional means model. This is one way of measuring how effective predictors are at further explaining variation in the model.</p>
</div>
<p><br></p>
</section>
</section>
<section id="modeling-unconditional-growth-model" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="modeling-unconditional-growth-model"><span class="header-section-number">17.4</span> Modeling: Unconditional Growth Model</h2>
<p>To model change in the outcome over time, we include time as a fixed-effect in the LMER model. In this data set, the time predictor is <code>grade</code>, which is a categorical predictor. We could create dummy variables, or simply add <code>grade</code> into the model and let R choose the reference group alphabetically (<code>vocab_08</code> in this example). The statistical model in this example can be expressed as:</p>
<p><span class="math display">\[
\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \beta_1(\mathrm{Vocab\_09}_{ij}) + \beta_2(\mathrm{Vocab\_10}_{ij}) + \beta_3(\mathrm{Vocab\_11}_{ij}) + \epsilon_{ij}
\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(\mathrm{Vocabulary~Score}_{ij}\)</span> is the vocabulary score at time point <span class="math inline">\(i\)</span> for student <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\beta_0\)</span> is the fixed-effect of intercept;</li>
<li><span class="math inline">\(b_{0j}\)</span> is the random-effect of intercept for student <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\mathrm{Vocab\_09}_{ij}\)</span>, <span class="math inline">\(\mathrm{Vocab\_10}_{ij}\)</span>, and <span class="math inline">\(\mathrm{Vocab\_11}_{ij}\)</span> are dummy coded variable indicating grade-level,</li>
<li><span class="math inline">\(\beta_1\)</span> is the effect of 9th-grade (i.e., mean vocabulary score difference between 8th- and 9th-grade),</li>
<li><span class="math inline">\(\beta_2\)</span> is the effect of 10th-grade (i.e., mean vocabulary score difference between 8th- and 10th-grade),</li>
<li><span class="math inline">\(\beta_3\)</span> is the effect of 11th-grade (i.e., mean vocabulary score difference between 8th- and 11th-grade), and</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> is the error at time point <span class="math inline">\(i\)</span> for student <span class="math inline">\(j\)</span>.</li>
</ul>
<p>Fitting the model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> grade <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.1</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  effect term          estimate std.error statistic
  &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  (Intercept)       1.13     0.250      4.52
2 fixed  gradevocab_09     1.41     0.159      8.87
3 fixed  gradevocab_10     1.86     0.159     11.7 
4 fixed  gradevocab_11     2.34     0.159     14.7 </code></pre>
</div>
</div>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.13 + 1.41(\mathrm{Vocab\_09}_{ij}) + 1.86(\mathrm{Vocab\_10}_{ij}) + 2.34(\mathrm{Vocab\_11}_{ij})
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The predicted average vocabulary score for 8th-grade students (intercept) is 1.13.</li>
<li>On average, 9th-grade students have a vocabulary score that is 1.41-points higher than 8th-grade students.</li>
<li>On average, 10th-grade students have a vocabulary score that is 1.86-points higher than 8th-grade students.</li>
<li>On average, 11th-grade students have a vocabulary score that is 2.34-points higher than 8th-grade students.</li>
</ul>
<p>Looking at the variance components we find:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SD estimates</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.1</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  effect   group    term            estimate
  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
1 ran_pars id       sd__(Intercept)    1.79 
2 ran_pars Residual sd__Observation    0.899</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance estimates</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.791</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.207681</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.899</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-Student variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.808201</code></pre>
</div>
</div>
<p>Comparing the variances to those from the unconditional random intercepts model:</p>
<p><strong>Within-Student Variance (<span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>)</strong></p>
<p>The unexplained variance that is within-students has decreased from 1.82 to 0.81. Including grade-level in the model has explained 55.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</p>
<p><strong>Between-Student Variance (<span class="math inline">\(\hat\sigma^2_{0}\)</span>)</strong></p>
<p>The unexplained variance that is between-students has increased from 2.96 to 3.21. This means that by including grade in the model we have increased the amount of unexplained variation that is between students! (The model explained <span class="math inline">\(-8.7\)</span>% of the between-student variance.) This is a mathematical artifact of the estimation process.</p>
<p><br></p>
<section id="repeated-measures-anova-rm-anova" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="repeated-measures-anova-rm-anova"><span class="header-section-number">17.4.1</span> Repeated-Measures ANOVA (RM-ANOVA)</h3>
<p>One historic method of analyzing longitudinal data is Repeated Measures Analysis of Variance (RM-ANOVA).<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The linear mixed-effects model that includes time as one or more categorical predictors and a random-effect of intercept produces the same results as the RM-ANOVA.</p>
<div class="fyi">
<p><strong>WARNING</strong></p>
<p>You should not use RM-ANOVA to analyze longitudinal data. It requires a condition called <em>sphericity</em> that makes some stringent assumptions about the variances and correlations between repeated measures. One requirement of sphericity is that the correlation between any two time points are exactly the same. Consider the correlations of our data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlations between repeated measures</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vocab_08<span class="sc">:</span>vocab_11) <span class="sc">|&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term     vocab_08 vocab_09 vocab_10 vocab_11
  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 vocab_08   NA        0.810    0.866    0.782
2 vocab_09    0.810   NA        0.785    0.757
3 vocab_10    0.866    0.785   NA        0.811
4 vocab_11    0.782    0.757    0.811   NA    </code></pre>
</div>
</div>
<p>The correlations are not equal, and are likely not to be equal in the population! In repeated measures data, observations that are more closely spaced in time tend to be more correlated. This violates the sphericity assumption needed for RM-ANOVA. It is rare that sphericity is ever tenablein practice with longitudinal data. Because of this it is preferable to use LMER to carry out these analyses.</p>
</div>
<p><br></p>
</section>
<section id="quantitative-time-predictor-a-more-flexible-model-for-repeated-measures-data" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="quantitative-time-predictor-a-more-flexible-model-for-repeated-measures-data"><span class="header-section-number">17.4.2</span> Quantitative Time Predictor: A More Flexible Model for Repeated Measures Data</h3>
<p>One advantage to using the linear mixed-effects model to analyze repeated measures data over traditional methods (e.g., RM-ANOVA or MANOVA) is that the regression model allows for both categorical and quantitative variables. For example, rather than code our grade-levels categorically (as <code>vocab_08</code>, <code>vocab_09</code>, <code>vocab_10</code> and <code>vocab_11</code>), which was a necessity in days of yore, we could have simply coded them as 8, 9, 10, and 11. Then we could have fitted the LMER model using this quantitative predictor. The statistical model when time is quantitative would be:</p>
<p><span class="math display">\[
\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \beta_1(\mathrm{Grade}_{ij}) + \epsilon_{ij}
\]</span></p>
<p>where,</p>
<ul>
<li><span class="math inline">\(\mathrm{Vocabulary~Score}_{ij}\)</span> is the vocabulary score at time point <span class="math inline">\(i\)</span> for student <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\beta_0\)</span> is the fixed-effect of intercept;</li>
<li><span class="math inline">\(b_{0j}\)</span> is the random-effect of intercept for student <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\mathrm{Grade}_{ij}\)</span> is a quantitative variable indicating grade-level,</li>
<li><span class="math inline">\(\beta_1\)</span> is the effect of a one-unit change in grade, and</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> is the error at time point <span class="math inline">\(i\)</span> for student <span class="math inline">\(j\)</span>.</li>
</ul>
<p>This is still referred to as the <em>unconditional growth model</em> since the only predictor is a fixed-effect of time.</p>
<p><br></p>
</section>
<section id="lookup-table-mapping-categories-to-quantities" class="level3" data-number="17.4.3">
<h3 data-number="17.4.3" class="anchored" data-anchor-id="lookup-table-mapping-categories-to-quantities"><span class="header-section-number">17.4.3</span> Lookup Table: Mapping Categories to Quantities</h3>
<p>One method to convert <code>grade</code> to a quantitative variable is to create a <strong>lookup table</strong>. A lookup table maps the levels of the categorical time predictor to the values we want to use in our new quantitative predictor. Below I create a lookup table to map the categorical time predictor to the relevant grade-level (<code>grade_quant</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create lookup table</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>lookup_table <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">grade =</span> <span class="fu">c</span>(<span class="st">"vocab_08"</span>, <span class="st">"vocab_09"</span>, <span class="st">"vocab_10"</span>, <span class="st">"vocab_11"</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">grade_quant =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View lookup table</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>lookup_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     grade grade_quant
1 vocab_08           8
2 vocab_09           9
3 vocab_10          10
4 vocab_11          11</code></pre>
</div>
</div>
<p>Then, we join (or merge) the tidy/long data with the lookup table. This adds the quantitative variables (with the correct mapping) to our tidy data. There are, of course, other ways to accomplish the same thing. For example a <code>mutate()</code> using the <code>case_when()</code> function could also be used to create this mapping.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the data with the lookup table</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>vocabulary_long <span class="ot">=</span> vocabulary_long <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lookup_table, <span class="at">by =</span> <span class="st">"grade"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>vocabulary_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 256 × 5
      id female grade    vocab_score grade_quant
   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;
 1     1      1 vocab_08        1.75           8
 2     1      1 vocab_09        2.6            9
 3     1      1 vocab_10        3.76          10
 4     1      1 vocab_11        3.68          11
 5     2      0 vocab_08        0.9            8
 6     2      0 vocab_09        2.47           9
 7     2      0 vocab_10        2.44          10
 8     2      0 vocab_11        3.43          11
 9     3      0 vocab_08        0.8            8
10     3      0 vocab_09        0.93           9
# ℹ 246 more rows</code></pre>
</div>
</div>
<p>In this join, we are adding records from the <code>lookup_table</code> data (right data) to the <code>vocabulary_long</code> data (left data).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> When we perform this left join, the final joined data will include all records from <code>vcabulary_long</code> (left dataset) but only those records from the <code>lookup_table</code> dataset whose key (<code>grade</code> value) is contained in the student data. For example, if the <code>lookup_table</code> data included information about a grade level that was not included in the <code>vocabulary_long</code> data, it would not appear in the joined data.</p>
<p>The <code>{tidyverse}</code> package includes six different join functions. You can read about four common join functions and see an animation illustrating them <a href="https://thomasadventure.blog/posts/r-merging-datasets/">here</a>.</p>
<p><br></p>
</section>
</section>
<section id="fitting-the-unconditional-growth-model-with-a-quantitative-time-predictor" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="fitting-the-unconditional-growth-model-with-a-quantitative-time-predictor"><span class="header-section-number">17.5</span> Fitting the Unconditional Growth Model with a Quantitative Time Predictor</h2>
<p>Below we fit the linear mixed-effects model using the <code>grade_quant</code> predictor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> grade_quant <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.2</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  effect term        estimate std.error statistic
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  (Intercept)   -4.56     0.553      -8.24
2 fixed  grade_quant    0.747    0.0529     14.1 </code></pre>
</div>
</div>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = -4.56 + 0.75(\mathrm{Grade\mbox{-}level}_{ij})
\]</span></p>
<p>The model using the quantitative predictor of grade-level is simpler than the model using the categorical version of grade-level since it has two fewer fixed-effects to estimate (fewer degrees-of-freedom = more parsimonious).</p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The predicted average vocabulary score for 0th-grade students (intercept) is <span class="math inline">\(-4.55\)</span> (extrapolation).</li>
<li>Each one-unit difference in grade-level is associated with a 0.75-point difference in vocabulary score, on average.</li>
</ul>
<p>Looking at the variance components:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.2</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  effect   group    term            estimate
  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
1 ran_pars id       sd__(Intercept)    1.78 
2 ran_pars Residual sd__Observation    0.947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.784</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.182656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.947</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-student</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.896809</code></pre>
</div>
</div>
<p>Comparing these values to the unconditional random intercepts model:</p>
<p><strong>Within-Student Variance (<span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>)</strong></p>
<p>The unexplained variance that is within-students has decreased from 1.82 to 0.90. Including grade-level in the model has explained 50.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</p>
<p><strong>Between-Student Variance (<span class="math inline">\(\hat\sigma^2_{0}\)</span>)</strong></p>
<p>The unexplained variance that is between-students has increased from 2.96 to 3.18. This means that by including grade in the model we have increased the amount of unexplained variation that is between students by 7.8%; a mathematical artifact of the estimation process.</p>
<p>These are similar to the variance components obtained from the model using the categorical predictors of grade level.</p>
<p><br></p>
</section>
<section id="centering-the-time-predictor-better-interpretations-of-the-intercept" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="centering-the-time-predictor-better-interpretations-of-the-intercept"><span class="header-section-number">17.6</span> Centering the Time Predictor: Better Interpretations of the Intercept</h2>
<p>One method of improving the interpretations of the intercept is to center the time predictor. Recall that centering a variable means to add/subtract a constant value from each case. In a longitudinal analysis, we typically center the time predictor by subtracting the value of the time predictor at baseline (i.e., the first time point). In our example:</p>
<p><span class="math display">\[
\mathrm{Centered~Grade}_{ij} = \mathrm{Grade}_{ij} - 8
\]</span></p>
<p>This essentially maps the values of {8, 9, 10, 11} in the <code>quant_grade</code> variable to {0, 1, 2, 3}. Then we include this centered predictor as fixed-effect in the model. Mathematically, the model is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = \bigg[\beta_0 + b_0\bigg]  + \beta_1(\mathrm{Grade\mbox{-}level}_{ij} - 8) + \epsilon_{ij}
\]</span></p>
<p>Fitting this model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model with centered grade</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  effect term               estimate std.error statistic
  &lt;chr&gt;  &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  (Intercept)           1.41     0.244       5.79
2 fixed  I(grade_quant - 8)    0.747    0.0529     14.1 </code></pre>
</div>
</div>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.41 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The predicted average vocabulary score for 8th-grade students is 1.41. Centering removes the problem of extrapolation in the interpretation because we have now made 0 a legitimate value in the predictor.</li>
<li>Each one-unit difference in grade-level is associated with a 0.75-point difference in vocabulary score, on average. This is identical to the previous model since we have not changed what a one-unit difference in the predictor represents.</li>
</ul>
<p>We can see why the intercepts are different and the slopes are the same by comparing the plots of the individual growth profiles and the fitted fixed-effects models for the uncentered and centered predictors.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade_quant, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="fl">4.56</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">4.56</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Vocabulary score"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.41</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.41</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Centered grade-level (0 = 8th grade)"</span>,</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Vocabulary score"</span>,</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fitted-lmer" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot showing the change in vocabulary score over time for 64 students. The average growth profile is also displayed. This is shown for the non-centered (left) and 8th-grade centered (right) grade-level. A large blue point is shown at the intercept value in both plots." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fitted-lmer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-fitted-lmer-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Plot showing the change in vocabulary score over time for 64 students. The average growth profile is also displayed. This is shown for the non-centered (left) and 8th-grade centered (right) grade-level. A large blue point is shown at the intercept value in both plots.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fitted-lmer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.4: Plot showing the change in vocabulary score over time for 64 students. The average growth profile is also displayed. This is shown for the non-centered (left) and 8th-grade centered (right) grade-level. A large blue point is shown at the intercept value in both plots.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking at the variance components:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  effect   group    term            estimate
  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
1 ran_pars id       sd__(Intercept)    1.78 
2 ran_pars Residual sd__Observation    0.947</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.784</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-students</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.182656</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.947</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-students</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.896809</code></pre>
</div>
</div>
<p>Comparing them to the unconditional random intercepts model:</p>
<p><strong>Within-Student Variance (<span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>)</strong></p>
<p>The unexplained variance that is within-students has decreased from 1.82 to 0.90. Including grade-level in the model has explained 50.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</p>
<p><strong>Between-Student Variance (<span class="math inline">\(\hat\sigma^2_{0}\)</span>)</strong></p>
<p>The unexplained variance that is between-students has increased from 2.96 to 3.18. This means that by including grade in the model we have increased the amount of unexplained variation that is between students by 7.8%; a mathematical artifact of the estimation process.</p>
<p>These values are <strong>identical</strong> to the variance components obtained from the previous model. That is because the model we fitted is mostly identical to the uncentered quantitative model. The only difference is in the intercept value, which now is interpretable since a grade of 0 on the centered scale corresponds to the initial time point in the data; it is no longer extrapolation.</p>
<p><br></p>
<section id="student-specific-profiles" class="level3" data-number="17.6.1">
<h3 data-number="17.6.1" class="anchored" data-anchor-id="student-specific-profiles"><span class="header-section-number">17.6.1</span> Student-Specific Profiles</h3>
<p>Obtaining the coefficients for the student specific growth curves we get:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get student estimated parameters</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(level))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 128 × 5
   effect    group level term               estimate
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt;
 1 ran_coefs id    1     (Intercept)          1.80  
 2 ran_coefs id    1     I(grade_quant - 8)   0.747 
 3 ran_coefs id    2     (Intercept)          1.20  
 4 ran_coefs id    2     I(grade_quant - 8)   0.747 
 5 ran_coefs id    3     (Intercept)          0.0743
 6 ran_coefs id    3     I(grade_quant - 8)   0.747 
 7 ran_coefs id    4     (Intercept)          2.63  
 8 ran_coefs id    4     I(grade_quant - 8)   0.747 
 9 ran_coefs id    5     (Intercept)         -2.24  
10 ran_coefs id    5     I(grade_quant - 8)   0.747 
# ℹ 118 more rows</code></pre>
</div>
</div>
<p>The fitted equations for the student-specific growth curves for Student 1 and Student 2 are:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Student~1:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.80 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)\\[1ex]
\mathbf{Student~2:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.20 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)
\end{split}
\]</span></p>
<p>The student-specific growth rates are identical for all students (i.e., the slope value is the same in all the equations), and also is the same as the average global growth rate. Including a random-effect of intercept, although accounting for the within-student correlation among vocabulary scores, does not allow students to have different rates-of-growth. The difference is in the intercept values, which indicates where students start (i.e., students’ initial vocabulary score in the 8th grade).</p>
<p>We can see these same things by plotting these student specific growth curves along with the global average growth curve.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.41</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>     <span class="co"># Average growth curve</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.80</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span>   <span class="co"># Student 1</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.20</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span>   <span class="co"># Student 2</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lmer-students" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Predicted change in vocabulary score over time based on the linear (centered) unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lmer-students-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-lmer-students-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Predicted change in vocabulary score over time based on the linear (centered) unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmer-students-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.5: Predicted change in vocabulary score over time based on the linear (centered) unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The parallel lines suggest the same rate-of-growth across students.</p>
<p><br></p>
</section>
<section id="comparing-the-unconditional-growth-models" class="level3" data-number="17.6.2">
<h3 data-number="17.6.2" class="anchored" data-anchor-id="comparing-the-unconditional-growth-models"><span class="header-section-number">17.6.2</span> Comparing the Unconditional Growth Models</h3>
<p>The unconditional growth model was fitted using three different methods.</p>
<ul>
<li>The first model treated time (grade) as categorical.</li>
<li>The second two models treated time as a continuous variable.</li>
</ul>
<p>Treating time continuously rather than as a categorical predictor has many advantages:</p>
<ul>
<li>In the real-world time is continuous.</li>
<li>The model is simpler. In the model where time was treated categorically, we had to estimate four regression coefficients and two variance components. In the continuous models, we only had to estimate two regression coefficients and two variance components. If there were additional time points, we would still only need to estimate four parameters for the continuous model, but the number of estimates would increase for the categorical model.</li>
<li>It allows us to include participants being measured at different times.</li>
<li>It allows us to model nonlinear relationships more easily.</li>
</ul>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>In general, <strong>you should always treat time continuously when you have a longitudinal study!</strong> This guidance also implies that you should use linear mixed-effects models rather than RM-ANOVA for the analysis of longitudinal data.</p>
<p>Moreover, because of the interpretive value of the intercept when we center the grade-level predictor at the first time point, it is often a good idea to center your time predictor.</p>
</div>
<p><br></p>
</section>
</section>
<section id="re-visiting-the-functional-form-of-the-growth-model" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="re-visiting-the-functional-form-of-the-growth-model"><span class="header-section-number">17.7</span> Re-Visiting the Functional Form of the Growth Model</h2>
<p>As in any regression analysis, we need to specify the functional form of the growth model. Since the spaghetti plot suggested that the relationship between grade-level and vocabulary score may be nonlinear, below we consider three potential functional forms for our growth model (using centered grade level):</p>
<ol type="1">
<li>A linear relationship (already fitted: <code>lmer.3</code>);</li>
<li>A quadratic relationship; and</li>
<li>A log-linear relationship (based on log-transforming grade-level).</li>
</ol>
<p><em>Note:</em> Since the centered grade predictor includes values of zero, we need to add one to each value prior to log-transforming this predictor</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic model</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.4</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>) <span class="sc">+</span> <span class="fu">I</span>((grade_quant<span class="dv">-8</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-linear model</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.5</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>((grade_quant<span class="dv">-8</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="evaluating-the-three-functional-forms" class="level3" data-number="17.7.1">
<h3 data-number="17.7.1" class="anchored" data-anchor-id="evaluating-the-three-functional-forms"><span class="header-section-number">17.7.1</span> Evaluating the Three Functional Forms</h3>
<p>As with any model, we want to examine the evidence to determine the correct functional form. In practice, you would also want to evaluate the residuals to see which of the potential candidate models meets the assumptions. (We will look at residuals in an upcoming set of notes.) Suffice it to say, the residual plots look similar across all three models indicating that all the models seem to meet the assumptions equally well. Since we are using the same outcome and data in all three models, we can also evaluate the models using information criteria and their related metrics.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-evidence</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lmer<span class="fl">.0</span>, lmer<span class="fl">.3</span>, lmer<span class="fl">.4</span>, lmer<span class="fl">.5</span>),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"No change"</span>, <span class="st">"Linear growth"</span>, <span class="st">"Quadratic growth"</span>, <span class="st">"Log-linear growth"</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                  K    AICc Delta_AICc AICcWt Cum.Wt      LL
Log-linear growth 4  864.30       0.00   0.79   0.79 -428.07
Quadratic growth  5  866.96       2.67   0.21   1.00 -428.36
Linear growth     4  880.86      16.57   0.00   1.00 -436.35
No change         3 1015.35     151.06   0.00   1.00 -504.63</code></pre>
</div>
</div>
<p>Given the data and candidate models, the evidence primarily supports the log-linear model. There is also some evidence for the quadratic model and almost no evidence for the linear model. This is consistent with the nonlinearity we observed in the mean profile in the spaghetti plot. Given this, the higher evidence for the log-linear model, and the simplicity of the log-linear model relative to the quadratic model, we will adopt the log-linear functional form for our unconditional growth model.</p>
<p><br></p>
</section>
<section id="examining-the-output-for-the-adopted-log-linear-fitted-model" class="level3" data-number="17.7.2">
<h3 data-number="17.7.2" class="anchored" data-anchor-id="examining-the-output-for-the-adopted-log-linear-fitted-model"><span class="header-section-number">17.7.2</span> Examining the Output for the Adopted Log-Linear Fitted Model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  effect term                       estimate std.error statistic
  &lt;chr&gt;  &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 fixed  (Intercept)                    1.21     0.246      4.91
2 fixed  log((grade_quant - 8) + 1)     1.67     0.109     15.3 </code></pre>
</div>
</div>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.21 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>The predicted average vocabulary score for 8th-grade students is 1.21. Remember that the centered value for 8th-grade is 0, which results in <span class="math inline">\(1.21 + 1.67\bigg[\ln(1)\bigg] = 1.21 + 1.67(0) = 1.21\)</span>.</li>
<li>Since we used the natural log, we can interpret the change in <em>X</em> as a percent change and the change in <em>Y</em> as <span class="math inline">\(\hat{\beta_1}/100\)</span>; Each one-percent difference in grade-level is associated with a 0.0166-point difference in vocabulary score, on average.</li>
</ul>
<p>Looking at the variance components:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  effect   group    term            estimate
  &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;
1 ran_pars id       sd__(Intercept)    1.79 
2 ran_pars Residual sd__Observation    0.907</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fl">1.790</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.2041</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.907</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-student</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.822649</code></pre>
</div>
</div>
<p>Comparing them to the unconditional random intercepts model:</p>
<p><strong>Within-Student Variance (<span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>)</strong></p>
<p>The unexplained variance that is within-students has decreased from 1.82 to 0.82, a 54.9% explanation of the within-student variation.</p>
<p><strong>Between-Student Variance (<span class="math inline">\(\hat\sigma^2_{0}\)</span>)</strong></p>
<p>The unexplained variance that is between-students has increased from 2.96 to 3.20, an increase of 8.1% in the unexplained between-students variation.</p>
<p>These values are quite similar to the variance components obtained from the other unconditional growth models since time (grade level) is the only effect included in the model.</p>
<p><br></p>
</section>
<section id="plot-of-the-unconditional-growth-model" class="level3" data-number="17.7.3">
<h3 data-number="17.7.3" class="anchored" data-anchor-id="plot-of-the-unconditional-growth-model"><span class="header-section-number">17.7.3</span> Plot of the Unconditional Growth Model</h3>
<p>To better understand the relationship between grade-level and vocabulary score represented in the adopted unconditional growth model, we can plot the predicted mean profile based on the model’s fixed-effects.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.21</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lmer-log" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Predicted change in vocabulary score as a function of grade-level." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lmer-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-lmer-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Predicted change in vocabulary score as a function of grade-level.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmer-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.6: Predicted change in vocabulary score as a function of grade-level.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="student-specific-profiles-1" class="level3" data-number="17.7.4">
<h3 data-number="17.7.4" class="anchored" data-anchor-id="student-specific-profiles-1"><span class="header-section-number">17.7.4</span> Student-Specific Profiles</h3>
<p>Obtaining the coefficients for the student specific growth curves we get:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get student estimated parameters</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(level))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 128 × 5
   effect    group level term                       estimate
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                         &lt;dbl&gt;
 1 ran_coefs id    1     (Intercept)                   1.60 
 2 ran_coefs id    1     log((grade_quant - 8) + 1)    1.67 
 3 ran_coefs id    2     (Intercept)                   1.00 
 4 ran_coefs id    2     log((grade_quant - 8) + 1)    1.67 
 5 ran_coefs id    3     (Intercept)                  -0.137
 6 ran_coefs id    3     log((grade_quant - 8) + 1)    1.67 
 7 ran_coefs id    4     (Intercept)                   2.43 
 8 ran_coefs id    4     log((grade_quant - 8) + 1)    1.67 
 9 ran_coefs id    5     (Intercept)                  -2.46 
10 ran_coefs id    5     log((grade_quant - 8) + 1)    1.67 
# ℹ 118 more rows</code></pre>
</div>
</div>
<p>The fitted equations for the student-specific growth curves for Student 1 and Student 2 are:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Student~1:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.60 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]\\[1ex]
\mathbf{Student~2:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.00 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]
\end{split}
\]</span></p>
<p>Again, because we only included a random-effect of intercept the student-specific growth rates are identical for all students (i.e., the slope value is the same in all the equations), and also is the same as the average global growth rate. The random-effect of intercept does allow students to have different intercept values (i.e., students’ initial vocabulary score in the 8th grade can differ).</p>
<p>We can see these same things by plotting these student specific growth curves along with the global average growth curve.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average growth curve</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.21</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Student 1</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.60</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#0072B2"</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Student 2</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.00</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#E69F00"</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lmer-log-students" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Predicted change in vocabulary score over time based on the log-linear unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lmer-log-students-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="05-02-lmer-average-change-over-time_files/figure-html/fig-lmer-log-students-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Predicted change in vocabulary score over time based on the log-linear unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lmer-log-students-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.7: Predicted change in vocabulary score over time based on the log-linear unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line).
</figcaption>
</figure>
</div>
</div>
</div>
<p>The parallel curves suggest the same rate-of-growth across students.</p>
<p><br></p>
</section>
</section>
<section id="answering-the-research-question" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="answering-the-research-question"><span class="header-section-number">17.8</span> Answering the Research Question</h2>
<p>Here we present the rersults of our analysis in prose. We also presented a table of results from the fitted candidate models. For mixed-effects models, it is important to present coefficients and standard errors, estimated variance components, and any model-level summaries.</p>
<div class="fyi">
<p><strong>INTERPRETATION</strong></p>
<p>We set out to answer the following research question: What is the growth pattern in the average vocabulary score over time? We fitted four potential models corresponding to different growth patterns: no change over time, linear growth, quadratic growth, and log-linear growth. These models were evaluated using the AICc.</p>
<p>The evidence indicated that there was no empirical support for either the no change over time model. This indicates that students’ vocabulary scores are changing over time, on average. There was also no empirical support for the linear growth model indicating that the change over time is non-linear in nature. The log-linear growth model had the most empirical support, although there was also some support for the quadratic growth model. These models both suggest that students’ vocabulary scores, on average, are growing over time, but that growth diminishes over time.</p>
</div>
<p>We can also provide a table of the fitted model results. This table is similar to the table we create for fixed-effects regression models. However, we now need to include multiple variance components.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">l =</span> <span class="fu">list</span>(lmer<span class="fl">.0</span>, lmer<span class="fl">.3</span>, lmer<span class="fl">.4</span>, lmer<span class="fl">.5</span>),</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),    <span class="co">#No p-value stars</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">padding =</span> <span class="dv">20</span>,          <span class="co">#Add space around columns (you may need to adjust this via trial-and-error)</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Grade"</span>, <span class="st">"Grade$^2$"</span>, <span class="st">"ln(Grade)"</span>),</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.coef =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span>), <span class="co">#Put intercept at bottom of table</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,   <span class="co">#Omit log-likelihood</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit AIC</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.bic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit BIC</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.nobs =</span> <span class="cn">FALSE</span>,  <span class="co">#Omit sample size</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.groups =</span> <span class="cn">FALSE</span>, <span class="co">#Omit group size</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.names =</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">hat</span><span class="sc">\\</span><span class="st">sigma^2_{0}$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">hat</span><span class="sc">\\</span><span class="st">sigma^2_{</span><span class="sc">\\</span><span class="st">epsilon}$"</span>), <span class="co"># Rename variance component rows</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">AICc =</span> <span class="fu">c</span>(<span class="fu">AICc</span>(lmer<span class="fl">.0</span>), <span class="fu">AICc</span>(lmer<span class="fl">.3</span>), <span class="fu">AICc</span>(lmer<span class="fl">.4</span>), <span class="fu">AICc</span>(lmer<span class="fl">.5</span>))  <span class="co"># Add AICc values</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#R2 = (2722.5 - c(NA, 2662.09, 2605.00, 2540.35, 2536.67)) /  2722.5</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="cn">NULL</span>,</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="co">#Move caption above table</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">inner.rules =</span> <span class="dv">1</span>, <span class="co">#Include line rule before model-level output</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">outer.rules =</span> <span class="dv">1</span> , <span class="co">#Include line rules around table</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.note =</span> <span class="st">"The grade predictor was centered at 8th-grade for Models 2 and 3. In Model 4, it was centered at 7th grade to ensure all values were greater than 0."</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-models" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17.1: Four candidate models predicting longitudinal variation in students’ vocabulary scores.
</figcaption>
<div aria-describedby="tbl-models-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 1px solid #000000;">
<thead>
<tr>
<th style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 1
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 2
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 3
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 4
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
Grade
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.75
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.44
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.05)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.18)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Grade<span class="math inline">\(^2\)</span>
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.23
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.06)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
ln(Grade)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.67
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.11)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Intercept
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2.53
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.41
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.18
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.21
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.23)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.24)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.25)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.25)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
<span class="math inline">\(\hat\sigma^2_{0}\)</span>
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2.95
</td>
<td style="padding-left: 20px;padding-right: 20px;">
3.18
</td>
<td style="padding-left: 20px;padding-right: 20px;">
3.20
</td>
<td style="padding-left: 20px;padding-right: 20px;">
3.20
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
<span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.83
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.90
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.82
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.82
</td>
</tr>
<tr style="border-bottom: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
AICc
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1015.35
</td>
<td style="padding-left: 20px;padding-right: 20px;">
880.86
</td>
<td style="padding-left: 20px;padding-right: 20px;">
866.96
</td>
<td style="padding-left: 20px;padding-right: 20px;">
864.30
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
The grade predictor was centered at 8th-grade for Models 2 and 3. In Model 4, it was centered at 7th grade to ensure all values were greater than 0.
</td>
</tr>
</tfoot>
</table>
</div>
</figure>
</div>
<p><br></p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Wickham:2014" class="csl-entry" role="listitem">
Wickham, H. (2014). Tidy data. <em>The Journal of Statistical Software</em>, <em>59</em>(10). <a href="http://www.jstatsoft.org/v59/i10/">http://www.jstatsoft.org/v59/i10/</a>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Unfortunately RM-ANOVA is still used, despite many known methodological limitations of the methodology, and the availability of better analytic options (e.g., LMER).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>They are referred to as ‘left’ and ‘right’ because of where they appear in the syntax. If we wrote the syntax without the pipe it would be <code>left_join(vocabulary_long, lookup_table, by = "grade")</code>. In the syntax, <code>vocabulary_long</code> is to the left of <code>lookup_table</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05-01-introduction-to-mixed-effects-models.html" class="pagination-link" aria-label="Introduction to Mixed-Effects Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to Mixed-Effects Models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-03-lmer-other-random-effects-and-covariates.html" class="pagination-link" aria-label="LMER: Other Random-Effects and Covariates">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">LMER: Other Random-Effects and Covariates</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb73" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># LMER: Average Change Over Time</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"scripts/_common.R"</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>In this set of notes, you will learn how to use the linear mixed-effects model to examine the mean change over time in a set of longitudinal/repeated measurements. To do this, we will use data from the file <span class="co">[</span><span class="ot">*vocabulary.csv*</span><span class="co">](https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/vocabulary.csv)</span> (see <span class="co">[</span><span class="ot">data codebook</span><span class="co">](http://zief0002.github.io/fluffy-ants/codebooks/vocabulary.html)</span>).</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>These data include repeated measurements of scaled vocabulary scores for $n=64$ students.</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co">#for tidy, glance, and augment functions for lme4 models</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co">#for fitting mixed-effects models</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/vocabulary.csv"</span>)</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>vocabulary</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>We will use these data to explore the change in vocabulary over time (longitudinal variation in the vocabulary scores). In most longitudinal analyses, the primary goal is to examine the mean change of some outcome over time. To do this we will focus on the following research question: (1) What is the growth pattern in the average vocabulary score over time? </span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Structure: Tidy/Long Data vs. Wide Data</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>Before doing any analysis of the data, it is worth understanding the structure of the data. There are two common structures for repeated measures data: *tidy/long structured data* and *wide structured data*.</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In **tidy/long** structured data, there is a single column per variable. For example, the outcome variable (vocabulary scores) would be organized into a single column. Similarly, the predictor that designates time (grade-level in our example) would also be organized into a single column.</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In **wide** structured data, the outcome variable (or predictor variables) is typically spread out over multiple columns. Often there are not columns that include data on the time predictor; instead this information is typically embedded in the column name.</span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>The vocabulary data is currently structured as wide data; the vocabulary scores are organized into four separate columns and the information about grade-level (the time predictor) is embedded in the variable names (e.g., <span class="in">`vocab_08`</span> indicates 8th-grade). The same data are presented below in the tidy/long structure.</span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="sc">|&gt;</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> vocab_08<span class="sc">:</span>vocab_11, <span class="at">names_to =</span> <span class="st">"grade"</span>, <span class="at">values_to =</span> <span class="st">"vocab_score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, grade)</span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>Notice that in the tidy/long structured data that the vocabulary scores (outcome) are now organized into a single column. Grade-level (the time predictor) is also now explicitly included in the data and is also organized as a single column in the data. Note that in the long structure, each row now represents a particular student at a particular grade-level, and that each student's data now encompasses several rows.</span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>There are advantages to each of the structures. For example the wide structure has the advantage of being a better structure for data entry. Since each row corresponds to a different student, there are fewer rows and therefore less redundancy in the data entry process. Compare this to the tidy/long data where each student's data encompasses four rows. If you were doing data entry in this structure you would need to record the student's sex four times rather than once in the wide structure.</span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>The tidy/long structure is the structure that is needed for modeling. Thus, if one of the analytic goals is to fit a linear mixed-effects model to explain variation or examine predictor effects, the tidy/long data structure is key. Note that the wide structured data is also used in some analyses (e.g., computing correlations).</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a><span class="fu">### Switching between the Two Data Structures</span></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a>The library <span class="in">`{tidyr}`</span> (loaded as part of the <span class="in">`{tidyverse}`</span> metapackage) has two functions that convert data between these two structures:</span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pivot_longer()`</span> (wide $\rightarrow$ tidy/long), and </span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pivot_wider()`</span> (tidy/long $\rightarrow$ wide).  </span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a>Below, I show the code for going from the wide structured data (<span class="in">`vocabulary`</span>) to the tidy/long structure.</span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert from wide to long structured data</span></span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a>vocabulary_long <span class="ot">=</span> vocabulary <span class="sc">|&gt;</span></span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> vocab_08<span class="sc">:</span>vocab_11, <span class="at">names_to =</span> <span class="st">"grade"</span>, <span class="at">values_to =</span> <span class="st">"vocab_score"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id, grade)</span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a>vocabulary_long</span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a>Here is an animated tutorial for understanding this syntax.</span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;iframe height="750" src="https://haswal.github.io/pivot/" onload='javascript:(function(o){o.style.height=o.contentWindow.document.body.scrollHeight+"px";}(this));' style="height:750px;width:100%;border:none;overflow:hidden;"&gt;&lt;/iframe&gt;</span></span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a>For more information about using these functions, Google "tidyr pivot" and read through any number of great tutorials or vignettes; for example <span class="co">[</span><span class="ot">here</span><span class="co">](https://tidyr.tidyverse.org/articles/pivot.html)</span>. You can also read Hadley Wickham's <span class="co">[</span><span class="ot">-@Wickham:2014</span><span class="co">]</span> original paper on tidy data.</span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploration: Plot of the Mean and Individual Profiles</span></span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a>There are two plots that are particularly useful in exploring longitudinal data. The first is a plot of the mean value of the outcome at each time point (*mean profile plot*). This shows the average growth profile and is useful for determining the functional form of the fixed-effects part of the model; is the mean change over time linear? Quadratic? Log-linear? </span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a>Another plot that is often examined is a plot of the individual patterns or profiles, referred to as a *spaghetti plot*. A spaghetti plot is useful for determining whether there is variation from the average profile. This helps us to consider the set of random-effects to include in the model. Below we examine both the mean profile and individual profiles simultaneously.</span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ind-profiles</span></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot showing the change in vocabulary score over time for 64 students. The average growth profile is displayed as a thicker line."</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot showing the change in vocabulary score over time for 64 students. The average growth profile is displayed as a thicker line."</span></span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>                      <span class="co">#Add individual profiles</span></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">group =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co">#Add mean profile line</span></span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>           <span class="co">#Add mean profile points</span></span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"8th-grade"</span>, <span class="st">"9th-grade"</span>, <span class="st">"10th-grade"</span>, <span class="st">"11th-grade"</span>)</span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a>Because our research question is focused on examining the average change of vocabulary scores over time, we will focus on the mean profile. Based on this plot:</span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The average profile displays change over time that is positive (growth) and linear (or perhaps log-linear).</span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unconditional Random Intercepts Model</span></span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a>As in a conventional fixed-effects regression analysis we begin a mixed-effects analysis by fitting the intercept-only model. This model is referred to as the *unconditional random intercepts model* or the *unconditional means model*. The model posits that there is *no change over time* in the average vocabulary score.</span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a>This model includes a fixed-effect of intercept and a random-effect of intercept, and no other predictors. This is the simplest model we can fit while still accounting for the dependence in the data (e.g., including a random-effect). The statistical model in this example can be expressed as:</span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a>\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \epsilon_{ij}</span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Vocabulary~Score}_{ij}$ is the vocabulary score for Student $j$ at time point $i$;</span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_0$ is the fixed-effect of intercept;</span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$b_{0j}$ is the random-effect of intercept for Student $j$; and</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\epsilon_{ij}$ is the error for Student $j$ at time point $i$.</span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-157"><a href="#cb73-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting and Interpreting the Model</span></span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a>We fit the  model and display the output below. We include the argument <span class="in">`REML=FALSE`</span> to force the <span class="in">`lmer()`</span> function to produce maximum likelihood estimates (rather than restricted maximum likelihood estimates). In practice, we will generally want to fit these models using ML estimation.</span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-166"><a href="#cb73-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-167"><a href="#cb73-167" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a>Recall that there are two types of fitted equations we can produce from this model: (1) the global fitted equation, and (2) student-specific fitted equation. The global fitted equation is based on only the fixed effects. We obtain the fixed-effects estimates using the <span class="in">`tidy()`</span> function from the <span class="in">`{broom.mixed}`</span> package with the argument <span class="in">`effects="fixed"`</span>.</span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-174"><a href="#cb73-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.0</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-181"><a href="#cb73-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-182"><a href="#cb73-182" aria-hidden="true" tabindex="-1"></a>Using the fixed-effects estimates, the global fitted equation based on the fixed-effects model is:</span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = 2.53</span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a>We interpret coefficients from the fixed-effects model the same way we interpret coefficients produced from the <span class="in">`lm()`</span> output. For example,</span>
<span id="cb73-189"><a href="#cb73-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-190"><a href="#cb73-190" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary language score for all students at all time points is 2.53.</span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-192"><a href="#cb73-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-193"><a href="#cb73-193" aria-hidden="true" tabindex="-1"></a>We can also write the student specific fitted equations. Each student specific fitted equation is based on the fixed-effects AND the student-specific random-effect. To obtain the student-specific random-effects we use the <span class="in">`tidy()`</span> function from the <span class="in">`{broom.mixed}`</span> package with the argument <span class="in">`effects="ran_vals"`</span>.</span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-197"><a href="#cb73-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-198"><a href="#cb73-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain random effects</span></span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_vals"</span>)</span>
<span id="cb73-200"><a href="#cb73-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-201"><a href="#cb73-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a>For example, Student 1's fitted equation is:</span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-204"><a href="#cb73-204" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-205"><a href="#cb73-205" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-206"><a href="#cb73-206" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{i1}} &amp;= 2.53 + 0.359 \\[1ex]\hat{\mathrm{Vocabulary~Score}_{i1}} &amp;= 2.53 + 0.359 <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a>&amp;= 2.89</span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-209"><a href="#cb73-209" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-210"><a href="#cb73-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary language score for Student 1 at all time points is 2.889.</span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-213"><a href="#cb73-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-214"><a href="#cb73-214" aria-hidden="true" tabindex="-1"></a>The argument <span class="in">`effects="ran_coefs"`</span> in the <span class="in">`tidy()`</span> function gives the student-specific intercepts directly.</span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain student-specific coefficients</span></span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>)</span>
<span id="cb73-221"><a href="#cb73-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-222"><a href="#cb73-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a>From here, we see that Student 2's fitted equation is:</span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{i2}} = 2.34</span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a>The predicted average vocabulary language score for Student 2 (at all time points) is 2.34. From the two students' fitted equations we see that Student 1's "growth" curve is higher than the average "growth" curve and Student 2's "growth" curve is lower than the average "growth" curve. Here is a plot of those three "growth" curves.</span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-233"><a href="#cb73-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fitted-1</span></span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.53</span>) <span class="sc">+</span> <span class="co">#Global 'growth' curve</span></span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.89</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span> <span class="co">#Student 1 'growth' curve</span></span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">2.34</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span> <span class="co">#Student 1 'growth' curve</span></span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"8th-grade"</span>, <span class="st">"9th-grade"</span>, <span class="st">"10th-grade"</span>, <span class="st">"11th-grade"</span>)</span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-248"><a href="#cb73-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>) <span class="sc">+</span></span>
<span id="cb73-249"><a href="#cb73-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb73-250"><a href="#cb73-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Partitioning Unexplained Variation</span></span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-257"><a href="#cb73-257" aria-hidden="true" tabindex="-1"></a>This model is not very informative for applied researchers in terms of characterizing change over time, but it is essential to decompose the variation into within- and between-subjects variation. In our model, there are two sources of variation. The first source of variation measures the between-student variation (how different are students' individual "growth" curves). The second source of variation measures the within-student variation (how different are an individual's outcome values from their individual "growth" curve).</span>
<span id="cb73-258"><a href="#cb73-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a>To see this graphically, we show Student 1's data along with the global "growth" curve and Student 1's specific "growth" curves. The between-student variation is akin to the average of the squared deviations between each student-specific "growth" curve and the global "growth" curve. The left-hand plot below shows these residuals for Student 1, referred to as *Level-2 residuals*. The within-student variation is akin to the average of the squared deviations between each student's outcome (vocabulary scores) and that student's specific "growth" curve. The right-hand plot below shows these residuals for Student 1, referred to as *Level-1 residuals*.</span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-263"><a href="#cb73-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-264"><a href="#cb73-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-between-and-within-variation</span></span>
<span id="cb73-265"><a href="#cb73-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Student 1's vocabulary scores at each time point along with the predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line) and Student 1 (blue, dashed line). The between-student variation (LEFT) and within-student variation (RIGHT) based on the residuals for Student 1 are also displayed."</span></span>
<span id="cb73-266"><a href="#cb73-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Student 1's vocabulary scores at each time point along with the predicted change in vocabulary score over time based on the unconditional random intercepts model for all students (solid, black line) and Student 1 (blue, dashed line). The between-student variation (LEFT) and within-student variation (RIGHT) based on the residuals for Student 1 are also displayed."</span></span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a><span class="co"># vocabulary_long |&gt;</span></span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(id == 1) |&gt;</span></span>
<span id="cb73-271"><a href="#cb73-271" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = grade, y = vocab_score)) +</span></span>
<span id="cb73-272"><a href="#cb73-272" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 2.53) + #Global 'growth' curve</span></span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(shape = 21, color = "black", fill = "#0072B2", size = 5) +</span></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 2.89, linetype = "dashed", color = "#0072B2") + #Student 1 'growth' curve</span></span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_light() +</span></span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a><span class="co">#   scale_x_discrete(</span></span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a><span class="co">#     name = "Grade-level",</span></span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a><span class="co">#     labels = c("8th-grade", "9th-grade", "10th-grade", "11th-grade")</span></span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a><span class="co">#     ) +</span></span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab("Vocabulary score") +</span></span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylim(0, 4) +</span></span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(</span></span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a><span class="co">#     text = element_text(size = 20)</span></span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="st">"figs/lmer-sources-of-variation.png"</span>)</span>
<span id="cb73-287"><a href="#cb73-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-288"><a href="#cb73-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a>We quantify the amount of between- and within-student variation using an estimate of variance. The between-student variance estimate is denoted $\sigma^2_{b_0}$ (or simply $\sigma^20$), and the within-student variance estimate is denoted $\sigma^2_{\epsilon}$. We can access these paramater estimates using the argument <span class="in">`effects="ran_pars"`</span> in the <span class="in">`tidy()`</span> function.</span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain variance estimates</span></span>
<span id="cb73-295"><a href="#cb73-295" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.0</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span>
<span id="cb73-296"><a href="#cb73-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-297"><a href="#cb73-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-298"><a href="#cb73-298" aria-hidden="true" tabindex="-1"></a>Note that the output is in the standard deviation metric. We need to square these values to get the actual variance estimates.</span>
<span id="cb73-299"><a href="#cb73-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-300"><a href="#cb73-300" aria-hidden="true" tabindex="-1"></a>**Between-Student Variance:**</span>
<span id="cb73-301"><a href="#cb73-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-302"><a href="#cb73-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-303"><a href="#cb73-303" aria-hidden="true" tabindex="-1"></a>\hat\sigma^2_0 = 1.72^2 = 2.96</span>
<span id="cb73-304"><a href="#cb73-304" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-305"><a href="#cb73-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-306"><a href="#cb73-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-307"><a href="#cb73-307" aria-hidden="true" tabindex="-1"></a>**Within-Student Variance:** </span>
<span id="cb73-308"><a href="#cb73-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-309"><a href="#cb73-309" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-310"><a href="#cb73-310" aria-hidden="true" tabindex="-1"></a>\hat\sigma^2_{\epsilon} = 1.35^2 = 1.82</span>
<span id="cb73-311"><a href="#cb73-311" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-312"><a href="#cb73-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-313"><a href="#cb73-313" aria-hidden="true" tabindex="-1"></a>These values represent the unexplained variation at each level. The total unexplained variation is the sum of these two terms.</span>
<span id="cb73-314"><a href="#cb73-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-317"><a href="#cb73-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-318"><a href="#cb73-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Total unexplained variation</span></span>
<span id="cb73-319"><a href="#cb73-319" aria-hidden="true" tabindex="-1"></a><span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span></span>
<span id="cb73-320"><a href="#cb73-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-321"><a href="#cb73-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-322"><a href="#cb73-322" aria-hidden="true" tabindex="-1"></a>We can compute the proportion of unexplained variation at each level by dividing the appropriate variance estimate by this total.</span>
<span id="cb73-323"><a href="#cb73-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-326"><a href="#cb73-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-327"><a href="#cb73-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of unexplained variation that is between-subjects</span></span>
<span id="cb73-328"><a href="#cb73-328" aria-hidden="true" tabindex="-1"></a><span class="fl">2.96</span> <span class="sc">/</span> (<span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span>)</span>
<span id="cb73-329"><a href="#cb73-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-330"><a href="#cb73-330" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of unexplained variation that is within-subjects</span></span>
<span id="cb73-331"><a href="#cb73-331" aria-hidden="true" tabindex="-1"></a><span class="fl">1.82</span> <span class="sc">/</span> (<span class="fl">2.96</span> <span class="sc">+</span> <span class="fl">1.82</span>)</span>
<span id="cb73-332"><a href="#cb73-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-333"><a href="#cb73-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-334"><a href="#cb73-334" aria-hidden="true" tabindex="-1"></a>Interpreting these values:</span>
<span id="cb73-335"><a href="#cb73-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-336"><a href="#cb73-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Roughly 62% of the unexplained variation in vocabulary scores is between-student variation.</span>
<span id="cb73-337"><a href="#cb73-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Roughly 38% of the unexplained variation in vocabulary scores is within-student variation.</span>
<span id="cb73-338"><a href="#cb73-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-339"><a href="#cb73-339" aria-hidden="true" tabindex="-1"></a>Based on this partitioning from the unconditional random intercepts model we have evidence that it may be fortuitous to include both between-student and within-student predictors; there is unaccounted for variation at both levels. To explain the unaccounted for between-student variation, include between-student-level predictors (e.g., <span class="in">`female`</span>) in the model. To explain the unaccounted for within-student variation, include within-student predictors (e.g., <span class="in">`grade`</span>) in the model.</span>
<span id="cb73-340"><a href="#cb73-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-341"><a href="#cb73-341" aria-hidden="true" tabindex="-1"></a>Since the larger proportion of unexplained variation is between-student variation, we might ultimately focus on between-student predictors more than within-student predictors. However, because this is a longitudinal analysis, our primary focus is on the <span class="in">`grade`</span> predictor, which is a within-subjects predictor. It is here that we turn next.</span>
<span id="cb73-342"><a href="#cb73-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-343"><a href="#cb73-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-344"><a href="#cb73-344" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-345"><a href="#cb73-345" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb73-346"><a href="#cb73-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-347"><a href="#cb73-347" aria-hidden="true" tabindex="-1"></a>This partitioning of variation should be done in every analysis, and ALWAYS is done using the unconditional random intercepts model. The unconditional random intercepts model will serve as our *baseline* model. As we add predictors, we can compare the unexplained variation at each level in the predictor models to the baseline unaccounted for variation in the unconditional means model. This is one way of measuring how effective predictors are at further explaining variation in the model.</span>
<span id="cb73-348"><a href="#cb73-348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-349"><a href="#cb73-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-350"><a href="#cb73-350" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-351"><a href="#cb73-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-352"><a href="#cb73-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-353"><a href="#cb73-353" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modeling: Unconditional Growth Model</span></span>
<span id="cb73-354"><a href="#cb73-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-355"><a href="#cb73-355" aria-hidden="true" tabindex="-1"></a>To model change in the outcome over time, we include time as a fixed-effect in the LMER model. In this data set, the time predictor is <span class="in">`grade`</span>, which is a categorical predictor. We could create dummy variables, or simply add <span class="in">`grade`</span> into the model and let R choose the reference group alphabetically (<span class="in">`vocab_08`</span> in this example). The statistical model in this example can be expressed as:</span>
<span id="cb73-356"><a href="#cb73-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-357"><a href="#cb73-357" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-358"><a href="#cb73-358" aria-hidden="true" tabindex="-1"></a>\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \beta_1(\mathrm{Vocab\_09}_{ij}) + \beta_2(\mathrm{Vocab\_10}_{ij}) + \beta_3(\mathrm{Vocab\_11}_{ij}) + \epsilon_{ij}</span>
<span id="cb73-359"><a href="#cb73-359" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-360"><a href="#cb73-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-361"><a href="#cb73-361" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb73-362"><a href="#cb73-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-363"><a href="#cb73-363" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Vocabulary~Score}_{ij}$ is the vocabulary score at time point $i$ for student $j$;</span>
<span id="cb73-364"><a href="#cb73-364" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_0$ is the fixed-effect of intercept;</span>
<span id="cb73-365"><a href="#cb73-365" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$b_{0j}$ is the random-effect of intercept for student $j$;</span>
<span id="cb73-366"><a href="#cb73-366" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Vocab<span class="sc">\_</span>09}_{ij}$, $\mathrm{Vocab\_10}_{ij}$, and $\mathrm{Vocab\_11}_{ij}$ are dummy coded variable indicating grade-level,</span>
<span id="cb73-367"><a href="#cb73-367" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_1$ is the effect of 9th-grade (i.e., mean vocabulary score difference between 8th- and 9th-grade),</span>
<span id="cb73-368"><a href="#cb73-368" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_2$ is the effect of 10th-grade (i.e., mean vocabulary score difference between 8th- and 10th-grade),</span>
<span id="cb73-369"><a href="#cb73-369" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_3$ is the effect of 11th-grade (i.e., mean vocabulary score difference between 8th- and 11th-grade), and</span>
<span id="cb73-370"><a href="#cb73-370" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\epsilon_{ij}$ is the error at time point $i$ for student $j$.</span>
<span id="cb73-371"><a href="#cb73-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-372"><a href="#cb73-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-373"><a href="#cb73-373" aria-hidden="true" tabindex="-1"></a>Fitting the model:</span>
<span id="cb73-374"><a href="#cb73-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-377"><a href="#cb73-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-378"><a href="#cb73-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model</span></span>
<span id="cb73-379"><a href="#cb73-379" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> grade <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-380"><a href="#cb73-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-381"><a href="#cb73-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb73-382"><a href="#cb73-382" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.1</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb73-383"><a href="#cb73-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-384"><a href="#cb73-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-385"><a href="#cb73-385" aria-hidden="true" tabindex="-1"></a>The fitted equation is:</span>
<span id="cb73-386"><a href="#cb73-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-387"><a href="#cb73-387" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-388"><a href="#cb73-388" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.13 + 1.41(\mathrm{Vocab\_09}_{ij}) + 1.86(\mathrm{Vocab\_10}_{ij}) + 2.34(\mathrm{Vocab\_11}_{ij})</span>
<span id="cb73-389"><a href="#cb73-389" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-390"><a href="#cb73-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-391"><a href="#cb73-391" aria-hidden="true" tabindex="-1"></a>Interpreting the coefficients,</span>
<span id="cb73-392"><a href="#cb73-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-393"><a href="#cb73-393" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary score for 8th-grade students (intercept) is 1.13.</span>
<span id="cb73-394"><a href="#cb73-394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>On average, 9th-grade students have a vocabulary score that is 1.41-points higher than 8th-grade students.</span>
<span id="cb73-395"><a href="#cb73-395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>On average, 10th-grade students have a vocabulary score that is 1.86-points higher than 8th-grade students.</span>
<span id="cb73-396"><a href="#cb73-396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>On average, 11th-grade students have a vocabulary score that is 2.34-points higher than 8th-grade students.</span>
<span id="cb73-397"><a href="#cb73-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-398"><a href="#cb73-398" aria-hidden="true" tabindex="-1"></a>Looking at the variance components we find:</span>
<span id="cb73-399"><a href="#cb73-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-402"><a href="#cb73-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-403"><a href="#cb73-403" aria-hidden="true" tabindex="-1"></a><span class="co"># SD estimates</span></span>
<span id="cb73-404"><a href="#cb73-404" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.1</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span>
<span id="cb73-405"><a href="#cb73-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-406"><a href="#cb73-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance estimates</span></span>
<span id="cb73-407"><a href="#cb73-407" aria-hidden="true" tabindex="-1"></a><span class="fl">1.791</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student variance</span></span>
<span id="cb73-408"><a href="#cb73-408" aria-hidden="true" tabindex="-1"></a><span class="fl">0.899</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-Student variance</span></span>
<span id="cb73-409"><a href="#cb73-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-410"><a href="#cb73-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-411"><a href="#cb73-411" aria-hidden="true" tabindex="-1"></a>Comparing the variances to those from the unconditional random intercepts model:</span>
<span id="cb73-412"><a href="#cb73-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-413"><a href="#cb73-413" aria-hidden="true" tabindex="-1"></a>**Within-Student Variance ($\hat\sigma^2_{\epsilon}$)** </span>
<span id="cb73-414"><a href="#cb73-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-415"><a href="#cb73-415" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is within-students has decreased from 1.82 to 0.81. Including grade-level in the model has explained 55.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</span>
<span id="cb73-416"><a href="#cb73-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-417"><a href="#cb73-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-418"><a href="#cb73-418" aria-hidden="true" tabindex="-1"></a>**Between-Student Variance ($\hat\sigma^2_{0}$)** </span>
<span id="cb73-419"><a href="#cb73-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-420"><a href="#cb73-420" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is between-students has increased from 2.96 to 3.21. This means that by including grade in the model we have increased the amount of unexplained variation that is between students! (The model explained $-8.7$% of the between-student variance.) This is a mathematical artifact of the estimation process.</span>
<span id="cb73-421"><a href="#cb73-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-422"><a href="#cb73-422" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-423"><a href="#cb73-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-424"><a href="#cb73-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-425"><a href="#cb73-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Repeated-Measures ANOVA (RM-ANOVA)</span></span>
<span id="cb73-426"><a href="#cb73-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-427"><a href="#cb73-427" aria-hidden="true" tabindex="-1"></a>One historic method of analyzing longitudinal data is Repeated Measures Analysis of Variance (RM-ANOVA).^<span class="co">[</span><span class="ot">Unfortunately RM-ANOVA is still used, despite many known methodological limitations of the methodology, and the availability of better analytic options (e.g., LMER).</span><span class="co">]</span>  The linear mixed-effects model that includes time as one or more categorical predictors and a random-effect of intercept produces the same results as the RM-ANOVA.</span>
<span id="cb73-428"><a href="#cb73-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-429"><a href="#cb73-429" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-430"><a href="#cb73-430" aria-hidden="true" tabindex="-1"></a>**WARNING**</span>
<span id="cb73-431"><a href="#cb73-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-432"><a href="#cb73-432" aria-hidden="true" tabindex="-1"></a>You should not use RM-ANOVA to analyze longitudinal data. It requires a condition called *sphericity* that makes some stringent assumptions about the variances and correlations between repeated measures. One requirement of sphericity is that the correlation between any two time points are exactly the same. Consider the correlations of our data:</span>
<span id="cb73-433"><a href="#cb73-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-436"><a href="#cb73-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-437"><a href="#cb73-437" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlations between repeated measures</span></span>
<span id="cb73-438"><a href="#cb73-438" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="sc">|&gt;</span></span>
<span id="cb73-439"><a href="#cb73-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vocab_08<span class="sc">:</span>vocab_11) <span class="sc">|&gt;</span></span>
<span id="cb73-440"><a href="#cb73-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlate</span>()</span>
<span id="cb73-441"><a href="#cb73-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-442"><a href="#cb73-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-443"><a href="#cb73-443" aria-hidden="true" tabindex="-1"></a>The correlations are not equal, and are likely not to be equal in the population! In repeated measures data, observations that are more closely spaced in time tend to be more correlated. This violates the sphericity assumption needed for RM-ANOVA. It is rare that sphericity is ever tenablein practice with longitudinal data. Because of this it is preferable to use LMER to carry out these analyses.</span>
<span id="cb73-444"><a href="#cb73-444" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-445"><a href="#cb73-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-446"><a href="#cb73-446" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-447"><a href="#cb73-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-448"><a href="#cb73-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-449"><a href="#cb73-449" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quantitative Time Predictor: A More Flexible Model for Repeated Measures Data</span></span>
<span id="cb73-450"><a href="#cb73-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-451"><a href="#cb73-451" aria-hidden="true" tabindex="-1"></a>One advantage to using the linear mixed-effects model to analyze repeated measures data over traditional methods (e.g., RM-ANOVA or MANOVA) is that the regression model allows for both categorical and quantitative variables. For example, rather than code our grade-levels categorically (as <span class="in">`vocab_08`</span>, <span class="in">`vocab_09`</span>, <span class="in">`vocab_10`</span> and <span class="in">`vocab_11`</span>), which was a necessity in days of yore, we could have simply coded them as 8, 9, 10, and 11. Then we could have fitted the LMER model using this quantitative predictor. The statistical model when time is quantitative would be:</span>
<span id="cb73-452"><a href="#cb73-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-453"><a href="#cb73-453" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-454"><a href="#cb73-454" aria-hidden="true" tabindex="-1"></a>\mathrm{Vocabulary~Score}_{ij} = \big[\beta_0 + b_{0j}\big] + \beta_1(\mathrm{Grade}_{ij}) + \epsilon_{ij}</span>
<span id="cb73-455"><a href="#cb73-455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-456"><a href="#cb73-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-457"><a href="#cb73-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-458"><a href="#cb73-458" aria-hidden="true" tabindex="-1"></a>where,</span>
<span id="cb73-459"><a href="#cb73-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-460"><a href="#cb73-460" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Vocabulary~Score}_{ij}$ is the vocabulary score at time point $i$ for student $j$;</span>
<span id="cb73-461"><a href="#cb73-461" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_0$ is the fixed-effect of intercept;</span>
<span id="cb73-462"><a href="#cb73-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$b_{0j}$ is the random-effect of intercept for student $j$;</span>
<span id="cb73-463"><a href="#cb73-463" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Grade}_{ij}$ is a quantitative variable indicating grade-level,</span>
<span id="cb73-464"><a href="#cb73-464" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta_1$ is the effect of a one-unit change in grade, and</span>
<span id="cb73-465"><a href="#cb73-465" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\epsilon_{ij}$ is the error at time point $i$ for student $j$.</span>
<span id="cb73-466"><a href="#cb73-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-467"><a href="#cb73-467" aria-hidden="true" tabindex="-1"></a>This is still referred to as the *unconditional growth model* since the only predictor is a fixed-effect of time.</span>
<span id="cb73-468"><a href="#cb73-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-469"><a href="#cb73-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-470"><a href="#cb73-470" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-471"><a href="#cb73-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-472"><a href="#cb73-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-473"><a href="#cb73-473" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lookup Table: Mapping Categories to Quantities</span></span>
<span id="cb73-474"><a href="#cb73-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-475"><a href="#cb73-475" aria-hidden="true" tabindex="-1"></a>One method to convert <span class="in">`grade`</span> to a quantitative variable is to create a **lookup table**. A lookup table maps the levels of the categorical time predictor to the values we want to use in our new quantitative predictor. Below I create a lookup table to map the categorical time predictor to the relevant grade-level (<span class="in">`grade_quant`</span>).</span>
<span id="cb73-476"><a href="#cb73-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-477"><a href="#cb73-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-478"><a href="#cb73-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb73-479"><a href="#cb73-479" aria-hidden="true" tabindex="-1"></a><span class="in"># Create lookup table</span></span>
<span id="cb73-480"><a href="#cb73-480" aria-hidden="true" tabindex="-1"></a><span class="in">lookup_table = data.frame(</span></span>
<span id="cb73-481"><a href="#cb73-481" aria-hidden="true" tabindex="-1"></a><span class="in">  grade = c("vocab_08", "vocab_09", "vocab_10", "vocab_11"),</span></span>
<span id="cb73-482"><a href="#cb73-482" aria-hidden="true" tabindex="-1"></a><span class="in">  grade_quant = c(8, 9, 10, 11)</span></span>
<span id="cb73-483"><a href="#cb73-483" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb73-484"><a href="#cb73-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-485"><a href="#cb73-485" aria-hidden="true" tabindex="-1"></a><span class="in"># View lookup table</span></span>
<span id="cb73-486"><a href="#cb73-486" aria-hidden="true" tabindex="-1"></a><span class="in">lookup_table</span></span>
<span id="cb73-487"><a href="#cb73-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-488"><a href="#cb73-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-489"><a href="#cb73-489" aria-hidden="true" tabindex="-1"></a>Then, we join (or merge) the tidy/long data with the lookup table. This adds the quantitative variables (with the correct mapping) to our tidy data. There are, of course, other ways to accomplish the same thing. For example a <span class="in">`mutate()`</span> using the <span class="in">`case_when()`</span> function could also be used to create this mapping.</span>
<span id="cb73-490"><a href="#cb73-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-491"><a href="#cb73-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-492"><a href="#cb73-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r message=FALSE, warning=FALSE}</span></span>
<span id="cb73-493"><a href="#cb73-493" aria-hidden="true" tabindex="-1"></a><span class="in"># Join the data with the lookup table</span></span>
<span id="cb73-494"><a href="#cb73-494" aria-hidden="true" tabindex="-1"></a><span class="in">vocabulary_long = vocabulary_long |&gt;</span></span>
<span id="cb73-495"><a href="#cb73-495" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(lookup_table, by = "grade")</span></span>
<span id="cb73-496"><a href="#cb73-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-497"><a href="#cb73-497" aria-hidden="true" tabindex="-1"></a><span class="in"># View data</span></span>
<span id="cb73-498"><a href="#cb73-498" aria-hidden="true" tabindex="-1"></a><span class="in">vocabulary_long</span></span>
<span id="cb73-499"><a href="#cb73-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-500"><a href="#cb73-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-501"><a href="#cb73-501" aria-hidden="true" tabindex="-1"></a>In this join, we are adding records from the <span class="in">`lookup_table`</span> data (right data) to the <span class="in">`vocabulary_long`</span> data (left data).^<span class="co">[</span><span class="ot">They are referred to as 'left' and 'right' because of where they appear in the syntax. If we wrote the syntax without the pipe it would be `left_join(vocabulary_long, lookup_table, by = "grade")`. In the syntax, `vocabulary_long` is to the left of `lookup_table`.</span><span class="co">]</span> When we perform this left join, the final joined data will include all records from <span class="in">`vcabulary_long`</span> (left dataset) but only those records from the <span class="in">`lookup_table`</span> dataset whose key (<span class="in">`grade`</span> value) is contained in the student data. For example, if the <span class="in">`lookup_table`</span> data included information about a grade level that was not included in the <span class="in">`vocabulary_long`</span> data, it would not appear in the joined data.</span>
<span id="cb73-502"><a href="#cb73-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-503"><a href="#cb73-503" aria-hidden="true" tabindex="-1"></a>The <span class="in">`{tidyverse}`</span> package includes six different join functions. You can read about four common join functions and see an animation illustrating them <span class="co">[</span><span class="ot">here</span><span class="co">](https://thomasadventure.blog/posts/r-merging-datasets/)</span>.</span>
<span id="cb73-504"><a href="#cb73-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-505"><a href="#cb73-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-506"><a href="#cb73-506" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-507"><a href="#cb73-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-508"><a href="#cb73-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-509"><a href="#cb73-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting the Unconditional Growth Model with a Quantitative Time Predictor</span></span>
<span id="cb73-510"><a href="#cb73-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-511"><a href="#cb73-511" aria-hidden="true" tabindex="-1"></a>Below we fit the linear mixed-effects model using the <span class="in">`grade_quant`</span> predictor.</span>
<span id="cb73-512"><a href="#cb73-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-515"><a href="#cb73-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-516"><a href="#cb73-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model</span></span>
<span id="cb73-517"><a href="#cb73-517" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> grade_quant <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-518"><a href="#cb73-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-519"><a href="#cb73-519" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb73-520"><a href="#cb73-520" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.2</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb73-521"><a href="#cb73-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-522"><a href="#cb73-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-523"><a href="#cb73-523" aria-hidden="true" tabindex="-1"></a>The fitted equation is:</span>
<span id="cb73-524"><a href="#cb73-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-525"><a href="#cb73-525" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-526"><a href="#cb73-526" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = -4.56 + 0.75(\mathrm{Grade\mbox{-}level}_{ij})</span>
<span id="cb73-527"><a href="#cb73-527" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-528"><a href="#cb73-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-529"><a href="#cb73-529" aria-hidden="true" tabindex="-1"></a>The model using the quantitative predictor of grade-level is simpler than the model using the categorical version of grade-level since it has two fewer fixed-effects to estimate (fewer degrees-of-freedom = more parsimonious).</span>
<span id="cb73-530"><a href="#cb73-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-531"><a href="#cb73-531" aria-hidden="true" tabindex="-1"></a>Interpreting the coefficients,</span>
<span id="cb73-532"><a href="#cb73-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-533"><a href="#cb73-533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary score for 0th-grade students (intercept) is $-4.55$ (extrapolation).</span>
<span id="cb73-534"><a href="#cb73-534" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each one-unit difference in grade-level is associated with a 0.75-point difference in vocabulary score, on average.</span>
<span id="cb73-535"><a href="#cb73-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-536"><a href="#cb73-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-537"><a href="#cb73-537" aria-hidden="true" tabindex="-1"></a>Looking at the variance components:</span>
<span id="cb73-538"><a href="#cb73-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-541"><a href="#cb73-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-542"><a href="#cb73-542" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb73-543"><a href="#cb73-543" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.2</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span>
<span id="cb73-544"><a href="#cb73-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-545"><a href="#cb73-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb73-546"><a href="#cb73-546" aria-hidden="true" tabindex="-1"></a><span class="fl">1.784</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student</span></span>
<span id="cb73-547"><a href="#cb73-547" aria-hidden="true" tabindex="-1"></a><span class="fl">0.947</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-student</span></span>
<span id="cb73-548"><a href="#cb73-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-549"><a href="#cb73-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-550"><a href="#cb73-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-551"><a href="#cb73-551" aria-hidden="true" tabindex="-1"></a>Comparing these values to the unconditional random intercepts model:</span>
<span id="cb73-552"><a href="#cb73-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-553"><a href="#cb73-553" aria-hidden="true" tabindex="-1"></a>**Within-Student Variance ($\hat\sigma^2_{\epsilon}$)** </span>
<span id="cb73-554"><a href="#cb73-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-555"><a href="#cb73-555" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is within-students has decreased from 1.82 to 0.90. Including grade-level in the model has explained 50.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</span>
<span id="cb73-556"><a href="#cb73-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-557"><a href="#cb73-557" aria-hidden="true" tabindex="-1"></a>**Between-Student Variance ($\hat\sigma^2_{0}$)**</span>
<span id="cb73-558"><a href="#cb73-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-559"><a href="#cb73-559" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is between-students has increased from 2.96 to 3.18. This means that by including grade in the model we have increased the amount of unexplained variation that is between students by 7.8%; a mathematical artifact of the estimation process.</span>
<span id="cb73-560"><a href="#cb73-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-561"><a href="#cb73-561" aria-hidden="true" tabindex="-1"></a>These are similar to the variance components obtained from the model using the categorical predictors of grade level.</span>
<span id="cb73-562"><a href="#cb73-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-563"><a href="#cb73-563" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-564"><a href="#cb73-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-565"><a href="#cb73-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-566"><a href="#cb73-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Centering the Time Predictor: Better Interpretations of the Intercept</span></span>
<span id="cb73-567"><a href="#cb73-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-568"><a href="#cb73-568" aria-hidden="true" tabindex="-1"></a>One method of improving the interpretations of the intercept is to center the time predictor. Recall that centering a variable means to add/subtract a constant value from each case. In a longitudinal analysis, we typically center the time predictor by subtracting the value of the time predictor at baseline (i.e., the first time point). In our example:</span>
<span id="cb73-569"><a href="#cb73-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-570"><a href="#cb73-570" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-571"><a href="#cb73-571" aria-hidden="true" tabindex="-1"></a>\mathrm{Centered~Grade}_{ij} = \mathrm{Grade}_{ij} - 8</span>
<span id="cb73-572"><a href="#cb73-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-573"><a href="#cb73-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-574"><a href="#cb73-574" aria-hidden="true" tabindex="-1"></a>This essentially maps the values of {8, 9, 10, 11} in the <span class="in">`quant_grade`</span> variable to {0, 1, 2, 3}. Then we include this centered predictor as fixed-effect in the model. Mathematically, the model is:</span>
<span id="cb73-575"><a href="#cb73-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-576"><a href="#cb73-576" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-577"><a href="#cb73-577" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = \bigg[\beta_0 + b_0\bigg]  + \beta_1(\mathrm{Grade\mbox{-}level}_{ij} - 8) + \epsilon_{ij}</span>
<span id="cb73-578"><a href="#cb73-578" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-579"><a href="#cb73-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-580"><a href="#cb73-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-581"><a href="#cb73-581" aria-hidden="true" tabindex="-1"></a>Fitting this model:</span>
<span id="cb73-582"><a href="#cb73-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-585"><a href="#cb73-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-586"><a href="#cb73-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit unconditional growth model with centered grade</span></span>
<span id="cb73-587"><a href="#cb73-587" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id), <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-588"><a href="#cb73-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-589"><a href="#cb73-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb73-590"><a href="#cb73-590" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb73-591"><a href="#cb73-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-592"><a href="#cb73-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-593"><a href="#cb73-593" aria-hidden="true" tabindex="-1"></a>The fitted equation is:</span>
<span id="cb73-594"><a href="#cb73-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-595"><a href="#cb73-595" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-596"><a href="#cb73-596" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.41 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)</span>
<span id="cb73-597"><a href="#cb73-597" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-598"><a href="#cb73-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-599"><a href="#cb73-599" aria-hidden="true" tabindex="-1"></a>Interpreting the coefficients,</span>
<span id="cb73-600"><a href="#cb73-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-601"><a href="#cb73-601" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary score for 8th-grade students is 1.41. Centering removes the problem of extrapolation in the interpretation because we have now made 0 a legitimate value in the predictor.</span>
<span id="cb73-602"><a href="#cb73-602" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each one-unit difference in grade-level is associated with a 0.75-point difference in vocabulary score, on average. This is identical to the previous model since we have not changed what a one-unit difference in the predictor represents.</span>
<span id="cb73-603"><a href="#cb73-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-604"><a href="#cb73-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-605"><a href="#cb73-605" aria-hidden="true" tabindex="-1"></a>We can see why the intercepts are different and the slopes are the same by comparing the plots of the individual growth profiles and the fitted fixed-effects models for the uncentered and centered predictors.</span>
<span id="cb73-606"><a href="#cb73-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-609"><a href="#cb73-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-610"><a href="#cb73-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fitted-lmer</span></span>
<span id="cb73-611"><a href="#cb73-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot showing the change in vocabulary score over time for 64 students. The average growth profile is also displayed. This is shown for the non-centered (left) and 8th-grade centered (right) grade-level. A large blue point is shown at the intercept value in both plots."</span></span>
<span id="cb73-612"><a href="#cb73-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot showing the change in vocabulary score over time for 64 students. The average growth profile is also displayed. This is shown for the non-centered (left) and 8th-grade centered (right) grade-level. A large blue point is shown at the intercept value in both plots."</span></span>
<span id="cb73-613"><a href="#cb73-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-614"><a href="#cb73-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-615"><a href="#cb73-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb73-616"><a href="#cb73-616" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-617"><a href="#cb73-617" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> grade_quant, <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-618"><a href="#cb73-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb73-619"><a href="#cb73-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="fl">4.56</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb73-620"><a href="#cb73-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">4.56</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb73-621"><a href="#cb73-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-622"><a href="#cb73-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb73-623"><a href="#cb73-623" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-624"><a href="#cb73-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb73-625"><a href="#cb73-625" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb73-626"><a href="#cb73-626" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-627"><a href="#cb73-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb73-628"><a href="#cb73-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Vocabulary score"</span>,</span>
<span id="cb73-629"><a href="#cb73-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb73-630"><a href="#cb73-630" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-631"><a href="#cb73-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-632"><a href="#cb73-632" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-633"><a href="#cb73-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb73-634"><a href="#cb73-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.41</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb73-635"><a href="#cb73-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.41</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb73-636"><a href="#cb73-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-637"><a href="#cb73-637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb73-638"><a href="#cb73-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Centered grade-level (0 = 8th grade)"</span>,</span>
<span id="cb73-639"><a href="#cb73-639" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb73-640"><a href="#cb73-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb73-641"><a href="#cb73-641" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-642"><a href="#cb73-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb73-643"><a href="#cb73-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Vocabulary score"</span>,</span>
<span id="cb73-644"><a href="#cb73-644" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb73-645"><a href="#cb73-645" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-646"><a href="#cb73-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-647"><a href="#cb73-647" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb73-648"><a href="#cb73-648" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb73-649"><a href="#cb73-649" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-650"><a href="#cb73-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-651"><a href="#cb73-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-652"><a href="#cb73-652" aria-hidden="true" tabindex="-1"></a>Looking at the variance components:</span>
<span id="cb73-653"><a href="#cb73-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-656"><a href="#cb73-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-657"><a href="#cb73-657" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb73-658"><a href="#cb73-658" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span>
<span id="cb73-659"><a href="#cb73-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-660"><a href="#cb73-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb73-661"><a href="#cb73-661" aria-hidden="true" tabindex="-1"></a><span class="fl">1.784</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-students</span></span>
<span id="cb73-662"><a href="#cb73-662" aria-hidden="true" tabindex="-1"></a><span class="fl">0.947</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-students</span></span>
<span id="cb73-663"><a href="#cb73-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-664"><a href="#cb73-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-665"><a href="#cb73-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-666"><a href="#cb73-666" aria-hidden="true" tabindex="-1"></a>Comparing them to the unconditional random intercepts model:</span>
<span id="cb73-667"><a href="#cb73-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-668"><a href="#cb73-668" aria-hidden="true" tabindex="-1"></a>**Within-Student Variance ($\hat\sigma^2_{\epsilon}$)** </span>
<span id="cb73-669"><a href="#cb73-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-670"><a href="#cb73-670" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is within-students has decreased from 1.82 to 0.90. Including grade-level in the model has explained 50.8% of the within-student variation. This is because grade is a within-student predictor (it has values that vary within each student).</span>
<span id="cb73-671"><a href="#cb73-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-672"><a href="#cb73-672" aria-hidden="true" tabindex="-1"></a>**Between-Student Variance ($\hat\sigma^2_{0}$)** </span>
<span id="cb73-673"><a href="#cb73-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-674"><a href="#cb73-674" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is between-students has increased from 2.96 to 3.18. This means that by including grade in the model we have increased the amount of unexplained variation that is between students by 7.8%; a mathematical artifact of the estimation process.</span>
<span id="cb73-675"><a href="#cb73-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-676"><a href="#cb73-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-677"><a href="#cb73-677" aria-hidden="true" tabindex="-1"></a>These values are **identical** to the variance components obtained from the previous model. That is because the model we fitted is mostly identical to the uncentered quantitative model. The only difference is in the intercept value, which now is interpretable since a grade of 0 on the centered scale corresponds to the initial time point in the data; it is no longer extrapolation.</span>
<span id="cb73-678"><a href="#cb73-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-679"><a href="#cb73-679" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-680"><a href="#cb73-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-681"><a href="#cb73-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-682"><a href="#cb73-682" aria-hidden="true" tabindex="-1"></a><span class="fu">### Student-Specific Profiles</span></span>
<span id="cb73-683"><a href="#cb73-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-684"><a href="#cb73-684" aria-hidden="true" tabindex="-1"></a>Obtaining the coefficients for the student specific growth curves we get:</span>
<span id="cb73-685"><a href="#cb73-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-688"><a href="#cb73-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-689"><a href="#cb73-689" aria-hidden="true" tabindex="-1"></a><span class="co"># Get student estimated parameters</span></span>
<span id="cb73-690"><a href="#cb73-690" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.3</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-691"><a href="#cb73-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(level))</span>
<span id="cb73-692"><a href="#cb73-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-693"><a href="#cb73-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-694"><a href="#cb73-694" aria-hidden="true" tabindex="-1"></a>The fitted equations for the student-specific growth curves for Student 1 and Student 2 are:</span>
<span id="cb73-695"><a href="#cb73-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-696"><a href="#cb73-696" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-697"><a href="#cb73-697" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-698"><a href="#cb73-698" aria-hidden="true" tabindex="-1"></a>\mathbf{Student~1:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.80 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb73-699"><a href="#cb73-699" aria-hidden="true" tabindex="-1"></a>\mathbf{Student~2:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.20 + 0.75(\mathrm{Grade\mbox{-}level}_{ij}-8)</span>
<span id="cb73-700"><a href="#cb73-700" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-701"><a href="#cb73-701" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-702"><a href="#cb73-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-703"><a href="#cb73-703" aria-hidden="true" tabindex="-1"></a>The student-specific growth rates are identical for all students (i.e., the slope value is the same in all the equations), and also is the same as the average global growth rate. Including a random-effect of intercept, although accounting for the within-student correlation among vocabulary scores, does not allow students to have different rates-of-growth. The difference is in the intercept values, which indicates where students start (i.e., students' initial vocabulary score in the 8th grade).</span>
<span id="cb73-704"><a href="#cb73-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-705"><a href="#cb73-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-706"><a href="#cb73-706" aria-hidden="true" tabindex="-1"></a>We can see these same things by plotting these student specific growth curves along with the global average growth curve.</span>
<span id="cb73-707"><a href="#cb73-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-710"><a href="#cb73-710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-711"><a href="#cb73-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lmer-students</span></span>
<span id="cb73-712"><a href="#cb73-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Predicted change in vocabulary score over time based on the linear (centered) unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-713"><a href="#cb73-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Predicted change in vocabulary score over time based on the linear (centered) unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-714"><a href="#cb73-714" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb73-715"><a href="#cb73-715" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-716"><a href="#cb73-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-717"><a href="#cb73-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.41</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>     <span class="co"># Average growth curve</span></span>
<span id="cb73-718"><a href="#cb73-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.80</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span>   <span class="co"># Student 1</span></span>
<span id="cb73-719"><a href="#cb73-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fl">1.20</span>, <span class="at">slope =</span> <span class="fl">0.75</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span>   <span class="co"># Student 2</span></span>
<span id="cb73-720"><a href="#cb73-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-721"><a href="#cb73-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb73-722"><a href="#cb73-722" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-723"><a href="#cb73-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb73-724"><a href="#cb73-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb73-725"><a href="#cb73-725" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-726"><a href="#cb73-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span>
<span id="cb73-727"><a href="#cb73-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-728"><a href="#cb73-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-729"><a href="#cb73-729" aria-hidden="true" tabindex="-1"></a>The parallel lines suggest the same rate-of-growth across students.</span>
<span id="cb73-730"><a href="#cb73-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-731"><a href="#cb73-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-732"><a href="#cb73-732" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-733"><a href="#cb73-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-734"><a href="#cb73-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-735"><a href="#cb73-735" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing the Unconditional Growth Models</span></span>
<span id="cb73-736"><a href="#cb73-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-737"><a href="#cb73-737" aria-hidden="true" tabindex="-1"></a>The unconditional growth model was fitted using three different methods.</span>
<span id="cb73-738"><a href="#cb73-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-739"><a href="#cb73-739" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The first model treated time (grade) as categorical.</span>
<span id="cb73-740"><a href="#cb73-740" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The second two models treated time as a continuous variable.</span>
<span id="cb73-741"><a href="#cb73-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-742"><a href="#cb73-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-743"><a href="#cb73-743" aria-hidden="true" tabindex="-1"></a>Treating time continuously rather than as a categorical predictor has many advantages:</span>
<span id="cb73-744"><a href="#cb73-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-745"><a href="#cb73-745" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In the real-world time is continuous.</span>
<span id="cb73-746"><a href="#cb73-746" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The model is simpler. In the model where time was treated categorically, we had to estimate four regression coefficients and two variance components. In the continuous models, we only had to estimate two regression coefficients and two variance components. If there were additional time points, we would still only need to estimate four parameters for the continuous model, but the number of estimates would increase for the categorical model.</span>
<span id="cb73-747"><a href="#cb73-747" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It allows us to include participants being measured at different times.</span>
<span id="cb73-748"><a href="#cb73-748" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It allows us to model nonlinear relationships more easily.</span>
<span id="cb73-749"><a href="#cb73-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-750"><a href="#cb73-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-751"><a href="#cb73-751" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-752"><a href="#cb73-752" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb73-753"><a href="#cb73-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-754"><a href="#cb73-754" aria-hidden="true" tabindex="-1"></a>In general, **you should always treat time continuously when you have a longitudinal study!** This guidance also implies that you should use linear mixed-effects models rather than RM-ANOVA for the analysis of longitudinal data.</span>
<span id="cb73-755"><a href="#cb73-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-756"><a href="#cb73-756" aria-hidden="true" tabindex="-1"></a>Moreover, because of the interpretive value of the intercept when we center the grade-level predictor at the first time point, it is often a good idea to center your time predictor.</span>
<span id="cb73-757"><a href="#cb73-757" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-758"><a href="#cb73-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-759"><a href="#cb73-759" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-760"><a href="#cb73-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-761"><a href="#cb73-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-762"><a href="#cb73-762" aria-hidden="true" tabindex="-1"></a><span class="fu">## Re-Visiting the Functional Form of the Growth Model</span></span>
<span id="cb73-763"><a href="#cb73-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-764"><a href="#cb73-764" aria-hidden="true" tabindex="-1"></a>As in any regression analysis, we need to specify the functional form of the growth model. Since the spaghetti plot suggested that the relationship between grade-level and vocabulary score may be nonlinear, below we consider three potential functional forms for our growth model (using centered grade level):</span>
<span id="cb73-765"><a href="#cb73-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-766"><a href="#cb73-766" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A linear relationship (already fitted: <span class="in">`lmer.3`</span>);</span>
<span id="cb73-767"><a href="#cb73-767" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>A quadratic relationship; and</span>
<span id="cb73-768"><a href="#cb73-768" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>A log-linear relationship (based on log-transforming grade-level).</span>
<span id="cb73-769"><a href="#cb73-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-770"><a href="#cb73-770" aria-hidden="true" tabindex="-1"></a>*Note:* Since the centered grade predictor includes values of zero, we need to add one to each value prior to log-transforming this predictor</span>
<span id="cb73-771"><a href="#cb73-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-772"><a href="#cb73-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-775"><a href="#cb73-775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-776"><a href="#cb73-776" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic model</span></span>
<span id="cb73-777"><a href="#cb73-777" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.4</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>) <span class="sc">+</span> <span class="fu">I</span>((grade_quant<span class="dv">-8</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb73-778"><a href="#cb73-778" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-779"><a href="#cb73-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-780"><a href="#cb73-780" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-linear model</span></span>
<span id="cb73-781"><a href="#cb73-781" aria-hidden="true" tabindex="-1"></a>lmer<span class="fl">.5</span> <span class="ot">=</span> <span class="fu">lmer</span>(vocab_score <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>((grade_quant<span class="dv">-8</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id),</span>
<span id="cb73-782"><a href="#cb73-782" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> vocabulary_long, <span class="at">REML =</span> <span class="cn">FALSE</span>)</span>
<span id="cb73-783"><a href="#cb73-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-784"><a href="#cb73-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-785"><a href="#cb73-785" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-786"><a href="#cb73-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-787"><a href="#cb73-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-788"><a href="#cb73-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Evaluating the Three Functional Forms</span></span>
<span id="cb73-789"><a href="#cb73-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-790"><a href="#cb73-790" aria-hidden="true" tabindex="-1"></a>As with any model, we want to examine the evidence to determine the correct functional form. In practice, you would also want to evaluate the residuals to see which of the potential candidate models meets the assumptions. (We will look at residuals in an upcoming set of notes.) Suffice it to say, the residual plots look similar across all three models indicating that all the models seem to meet the assumptions equally well. Since we are using the same outcome and data in all three models, we can also evaluate the models using information criteria and their related metrics.</span>
<span id="cb73-791"><a href="#cb73-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-794"><a href="#cb73-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-795"><a href="#cb73-795" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-evidence</span></span>
<span id="cb73-796"><a href="#cb73-796" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb73-797"><a href="#cb73-797" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lmer<span class="fl">.0</span>, lmer<span class="fl">.3</span>, lmer<span class="fl">.4</span>, lmer<span class="fl">.5</span>),</span>
<span id="cb73-798"><a href="#cb73-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"No change"</span>, <span class="st">"Linear growth"</span>, <span class="st">"Quadratic growth"</span>, <span class="st">"Log-linear growth"</span>)</span>
<span id="cb73-799"><a href="#cb73-799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-800"><a href="#cb73-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-801"><a href="#cb73-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-802"><a href="#cb73-802" aria-hidden="true" tabindex="-1"></a>Given the data and candidate models, the evidence primarily supports the log-linear model. There is also some evidence for the quadratic model and almost no evidence for the linear model. This is consistent with the nonlinearity we observed in the mean profile in the spaghetti plot. Given this, the higher evidence for the log-linear model, and the simplicity of the log-linear model relative to the quadratic model, we will adopt the log-linear functional form for our unconditional growth model.</span>
<span id="cb73-803"><a href="#cb73-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-804"><a href="#cb73-804" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-805"><a href="#cb73-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-806"><a href="#cb73-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-807"><a href="#cb73-807" aria-hidden="true" tabindex="-1"></a><span class="fu">### Examining the Output for the Adopted Log-Linear Fitted Model</span></span>
<span id="cb73-808"><a href="#cb73-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-809"><a href="#cb73-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-812"><a href="#cb73-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-813"><a href="#cb73-813" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb73-814"><a href="#cb73-814" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"fixed"</span>)</span>
<span id="cb73-815"><a href="#cb73-815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-816"><a href="#cb73-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-817"><a href="#cb73-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-818"><a href="#cb73-818" aria-hidden="true" tabindex="-1"></a>The fitted equation is:</span>
<span id="cb73-819"><a href="#cb73-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-820"><a href="#cb73-820" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-821"><a href="#cb73-821" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Vocabulary~Score}_{ij}} = 1.21 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]</span>
<span id="cb73-822"><a href="#cb73-822" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-823"><a href="#cb73-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-824"><a href="#cb73-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-825"><a href="#cb73-825" aria-hidden="true" tabindex="-1"></a>Interpreting the coefficients,</span>
<span id="cb73-826"><a href="#cb73-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-827"><a href="#cb73-827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average vocabulary score for 8th-grade students is 1.21. Remember that the centered value for 8th-grade is 0, which results in $1.21 + 1.67\bigg<span class="co">[</span><span class="ot">\ln(1)\bigg</span><span class="co">]</span> = 1.21 + 1.67(0) = 1.21$.</span>
<span id="cb73-828"><a href="#cb73-828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Since we used the natural log, we can interpret the change in *X* as a percent change and the change in *Y* as $\hat{\beta_1}/100$; Each one-percent difference in grade-level is associated with a 0.0166-point difference in vocabulary score, on average.</span>
<span id="cb73-829"><a href="#cb73-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-830"><a href="#cb73-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-831"><a href="#cb73-831" aria-hidden="true" tabindex="-1"></a>Looking at the variance components:</span>
<span id="cb73-832"><a href="#cb73-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-835"><a href="#cb73-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-836"><a href="#cb73-836" aria-hidden="true" tabindex="-1"></a><span class="co"># SD</span></span>
<span id="cb73-837"><a href="#cb73-837" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"ran_pars"</span>)</span>
<span id="cb73-838"><a href="#cb73-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-839"><a href="#cb73-839" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute variance components</span></span>
<span id="cb73-840"><a href="#cb73-840" aria-hidden="true" tabindex="-1"></a><span class="fl">1.790</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Between-student</span></span>
<span id="cb73-841"><a href="#cb73-841" aria-hidden="true" tabindex="-1"></a><span class="fl">0.907</span> <span class="sc">^</span> <span class="dv">2</span> <span class="co">#Within-student</span></span>
<span id="cb73-842"><a href="#cb73-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-843"><a href="#cb73-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-844"><a href="#cb73-844" aria-hidden="true" tabindex="-1"></a>Comparing them to the unconditional random intercepts model:</span>
<span id="cb73-845"><a href="#cb73-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-846"><a href="#cb73-846" aria-hidden="true" tabindex="-1"></a>**Within-Student Variance ($\hat\sigma^2_{\epsilon}$)** </span>
<span id="cb73-847"><a href="#cb73-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-848"><a href="#cb73-848" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is within-students has decreased from 1.82 to 0.82, a 54.9% explanation of the within-student variation.</span>
<span id="cb73-849"><a href="#cb73-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-850"><a href="#cb73-850" aria-hidden="true" tabindex="-1"></a>**Between-Student Variance ($\hat\sigma^2_{0}$)** </span>
<span id="cb73-851"><a href="#cb73-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-852"><a href="#cb73-852" aria-hidden="true" tabindex="-1"></a>The unexplained variance that is between-students has increased from 2.96 to 3.20, an increase of 8.1% in the unexplained between-students variation.</span>
<span id="cb73-853"><a href="#cb73-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-854"><a href="#cb73-854" aria-hidden="true" tabindex="-1"></a>These values are quite similar to the variance components obtained from the other unconditional growth models since time (grade level) is the only effect included in the model.</span>
<span id="cb73-855"><a href="#cb73-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-856"><a href="#cb73-856" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-857"><a href="#cb73-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-858"><a href="#cb73-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-859"><a href="#cb73-859" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot of the Unconditional Growth Model</span></span>
<span id="cb73-860"><a href="#cb73-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-861"><a href="#cb73-861" aria-hidden="true" tabindex="-1"></a>To better understand the relationship between grade-level and vocabulary score represented in the adopted unconditional growth model, we can plot the predicted mean profile based on the model's fixed-effects.</span>
<span id="cb73-862"><a href="#cb73-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-865"><a href="#cb73-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-866"><a href="#cb73-866" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lmer-log</span></span>
<span id="cb73-867"><a href="#cb73-867" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Predicted change in vocabulary score as a function of grade-level."</span></span>
<span id="cb73-868"><a href="#cb73-868" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Predicted change in vocabulary score as a function of grade-level."</span></span>
<span id="cb73-869"><a href="#cb73-869" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb73-870"><a href="#cb73-870" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-871"><a href="#cb73-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-872"><a href="#cb73-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb73-873"><a href="#cb73-873" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.21</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb73-874"><a href="#cb73-874" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb73-875"><a href="#cb73-875" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-876"><a href="#cb73-876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-877"><a href="#cb73-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb73-878"><a href="#cb73-878" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-879"><a href="#cb73-879" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb73-880"><a href="#cb73-880" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb73-881"><a href="#cb73-881" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-882"><a href="#cb73-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span>
<span id="cb73-883"><a href="#cb73-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-884"><a href="#cb73-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-885"><a href="#cb73-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-886"><a href="#cb73-886" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-887"><a href="#cb73-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-888"><a href="#cb73-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-889"><a href="#cb73-889" aria-hidden="true" tabindex="-1"></a><span class="fu">### Student-Specific Profiles</span></span>
<span id="cb73-890"><a href="#cb73-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-891"><a href="#cb73-891" aria-hidden="true" tabindex="-1"></a>Obtaining the coefficients for the student specific growth curves we get:</span>
<span id="cb73-892"><a href="#cb73-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-895"><a href="#cb73-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-896"><a href="#cb73-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Get student estimated parameters</span></span>
<span id="cb73-897"><a href="#cb73-897" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lmer<span class="fl">.5</span>, <span class="at">effects =</span> <span class="st">"ran_coefs"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-898"><a href="#cb73-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">as.numeric</span>(level))</span>
<span id="cb73-899"><a href="#cb73-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-900"><a href="#cb73-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-901"><a href="#cb73-901" aria-hidden="true" tabindex="-1"></a>The fitted equations for the student-specific growth curves for Student 1 and Student 2 are:</span>
<span id="cb73-902"><a href="#cb73-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-903"><a href="#cb73-903" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-904"><a href="#cb73-904" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-905"><a href="#cb73-905" aria-hidden="true" tabindex="-1"></a>\mathbf{Student~1:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.60 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb73-906"><a href="#cb73-906" aria-hidden="true" tabindex="-1"></a>\mathbf{Student~2:~} \hat{\mathrm{Vocabulary~Score}_{ij}} &amp;= 1.00 + 1.67\bigg[\ln(\mathrm{Grade\mbox{-}level}_{ij}-7)\bigg]</span>
<span id="cb73-907"><a href="#cb73-907" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-908"><a href="#cb73-908" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-909"><a href="#cb73-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-910"><a href="#cb73-910" aria-hidden="true" tabindex="-1"></a>Again, because we only included a random-effect of intercept the student-specific growth rates are identical for all students (i.e., the slope value is the same in all the equations), and also is the same as the average global growth rate. The random-effect of intercept does allow students to have different intercept values (i.e., students' initial vocabulary score in the 8th grade can differ).</span>
<span id="cb73-911"><a href="#cb73-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-912"><a href="#cb73-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-913"><a href="#cb73-913" aria-hidden="true" tabindex="-1"></a>We can see these same things by plotting these student specific growth curves along with the global average growth curve.</span>
<span id="cb73-914"><a href="#cb73-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-917"><a href="#cb73-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-918"><a href="#cb73-918" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-lmer-log-students</span></span>
<span id="cb73-919"><a href="#cb73-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Predicted change in vocabulary score over time based on the log-linear unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-920"><a href="#cb73-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Predicted change in vocabulary score over time based on the log-linear unconditional growth model for all students (solid, black line), Student 1 (blue, dashed line), and Student 2 (orange, dashed line)."</span></span>
<span id="cb73-921"><a href="#cb73-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb73-922"><a href="#cb73-922" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vocabulary_long, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">I</span>(grade_quant<span class="dv">-8</span>), <span class="at">y =</span> vocab_score)) <span class="sc">+</span></span>
<span id="cb73-923"><a href="#cb73-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-924"><a href="#cb73-924" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average growth curve</span></span>
<span id="cb73-925"><a href="#cb73-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb73-926"><a href="#cb73-926" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.21</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb73-927"><a href="#cb73-927" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb73-928"><a href="#cb73-928" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-929"><a href="#cb73-929" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Student 1</span></span>
<span id="cb73-930"><a href="#cb73-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb73-931"><a href="#cb73-931" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.60</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb73-932"><a href="#cb73-932" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#0072B2"</span></span>
<span id="cb73-933"><a href="#cb73-933" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-934"><a href="#cb73-934" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Student 2</span></span>
<span id="cb73-935"><a href="#cb73-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb73-936"><a href="#cb73-936" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fl">1.00</span> <span class="sc">+</span> <span class="fl">1.67</span> <span class="sc">*</span> <span class="fu">log</span>(x <span class="sc">+</span> <span class="dv">1</span>)},</span>
<span id="cb73-937"><a href="#cb73-937" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#E69F00"</span></span>
<span id="cb73-938"><a href="#cb73-938" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-939"><a href="#cb73-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-940"><a href="#cb73-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb73-941"><a href="#cb73-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Grade-level"</span>,</span>
<span id="cb73-942"><a href="#cb73-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb73-943"><a href="#cb73-943" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0</span><span class="sc">\n</span><span class="st">(8th)"</span>, <span class="st">"1</span><span class="sc">\n</span><span class="st">(9th)"</span>, <span class="st">"2</span><span class="sc">\n</span><span class="st">(10th)"</span>, <span class="st">"3</span><span class="sc">\n</span><span class="st">(11th)"</span>)</span>
<span id="cb73-944"><a href="#cb73-944" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-945"><a href="#cb73-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Vocabulary score"</span>)</span>
<span id="cb73-946"><a href="#cb73-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-947"><a href="#cb73-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-948"><a href="#cb73-948" aria-hidden="true" tabindex="-1"></a>The parallel curves suggest the same rate-of-growth across students.</span>
<span id="cb73-949"><a href="#cb73-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-950"><a href="#cb73-950" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-951"><a href="#cb73-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-952"><a href="#cb73-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-953"><a href="#cb73-953" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answering the Research Question</span></span>
<span id="cb73-954"><a href="#cb73-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-955"><a href="#cb73-955" aria-hidden="true" tabindex="-1"></a>Here we present the rersults of our analysis in prose. We also presented a table of results from the fitted candidate models. For mixed-effects models, it is important to present coefficients and standard errors, estimated variance components, and any model-level summaries.</span>
<span id="cb73-956"><a href="#cb73-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-957"><a href="#cb73-957" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-958"><a href="#cb73-958" aria-hidden="true" tabindex="-1"></a>**INTERPRETATION**</span>
<span id="cb73-959"><a href="#cb73-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-960"><a href="#cb73-960" aria-hidden="true" tabindex="-1"></a>We set out to answer the following research question: What is the growth pattern in the average vocabulary score over time? We fitted four potential models corresponding to different growth patterns: no change over time, linear growth, quadratic growth, and log-linear growth. These models were evaluated using the AICc.</span>
<span id="cb73-961"><a href="#cb73-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-962"><a href="#cb73-962" aria-hidden="true" tabindex="-1"></a>The evidence indicated that there was no empirical support for either the no change over time model. This indicates that students' vocabulary scores are changing over time, on average. There was also no empirical support for the linear growth model indicating that the change over time is non-linear in nature. The log-linear growth model had the most empirical support, although there was also some support for the quadratic growth model. These models both suggest that students' vocabulary scores, on average, are growing over time, but that growth diminishes over time.</span>
<span id="cb73-963"><a href="#cb73-963" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-964"><a href="#cb73-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-965"><a href="#cb73-965" aria-hidden="true" tabindex="-1"></a>We can also provide a table of the fitted model results. This table is similar to the table we create for fixed-effects regression models. However, we now need to include multiple variance components.</span>
<span id="cb73-966"><a href="#cb73-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-969"><a href="#cb73-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-970"><a href="#cb73-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-models</span></span>
<span id="cb73-971"><a href="#cb73-971" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Four candidate models predicting longitudinal variation in students' vocabulary scores."</span></span>
<span id="cb73-972"><a href="#cb73-972" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-973"><a href="#cb73-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb73-974"><a href="#cb73-974" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(</span>
<span id="cb73-975"><a href="#cb73-975" aria-hidden="true" tabindex="-1"></a>  <span class="at">l =</span> <span class="fu">list</span>(lmer<span class="fl">.0</span>, lmer<span class="fl">.3</span>, lmer<span class="fl">.4</span>, lmer<span class="fl">.5</span>),</span>
<span id="cb73-976"><a href="#cb73-976" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),    <span class="co">#No p-value stars</span></span>
<span id="cb73-977"><a href="#cb73-977" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb73-978"><a href="#cb73-978" aria-hidden="true" tabindex="-1"></a>  <span class="at">padding =</span> <span class="dv">20</span>,          <span class="co">#Add space around columns (you may need to adjust this via trial-and-error)</span></span>
<span id="cb73-979"><a href="#cb73-979" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span>),</span>
<span id="cb73-980"><a href="#cb73-980" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Grade"</span>, <span class="st">"Grade$^2$"</span>, <span class="st">"ln(Grade)"</span>),</span>
<span id="cb73-981"><a href="#cb73-981" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.coef =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span>), <span class="co">#Put intercept at bottom of table</span></span>
<span id="cb73-982"><a href="#cb73-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,   <span class="co">#Omit log-likelihood</span></span>
<span id="cb73-983"><a href="#cb73-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit AIC</span></span>
<span id="cb73-984"><a href="#cb73-984" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.bic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit BIC</span></span>
<span id="cb73-985"><a href="#cb73-985" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.nobs =</span> <span class="cn">FALSE</span>,  <span class="co">#Omit sample size</span></span>
<span id="cb73-986"><a href="#cb73-986" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.groups =</span> <span class="cn">FALSE</span>, <span class="co">#Omit group size</span></span>
<span id="cb73-987"><a href="#cb73-987" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.names =</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">hat</span><span class="sc">\\</span><span class="st">sigma^2_{0}$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">hat</span><span class="sc">\\</span><span class="st">sigma^2_{</span><span class="sc">\\</span><span class="st">epsilon}$"</span>), <span class="co"># Rename variance component rows</span></span>
<span id="cb73-988"><a href="#cb73-988" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(</span>
<span id="cb73-989"><a href="#cb73-989" aria-hidden="true" tabindex="-1"></a>    <span class="at">AICc =</span> <span class="fu">c</span>(<span class="fu">AICc</span>(lmer<span class="fl">.0</span>), <span class="fu">AICc</span>(lmer<span class="fl">.3</span>), <span class="fu">AICc</span>(lmer<span class="fl">.4</span>), <span class="fu">AICc</span>(lmer<span class="fl">.5</span>))  <span class="co"># Add AICc values</span></span>
<span id="cb73-990"><a href="#cb73-990" aria-hidden="true" tabindex="-1"></a>    <span class="co">#R2 = (2722.5 - c(NA, 2662.09, 2605.00, 2540.35, 2536.67)) /  2722.5</span></span>
<span id="cb73-991"><a href="#cb73-991" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb73-992"><a href="#cb73-992" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb73-993"><a href="#cb73-993" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="cn">NULL</span>,</span>
<span id="cb73-994"><a href="#cb73-994" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="co">#Move caption above table</span></span>
<span id="cb73-995"><a href="#cb73-995" aria-hidden="true" tabindex="-1"></a>  <span class="at">inner.rules =</span> <span class="dv">1</span>, <span class="co">#Include line rule before model-level output</span></span>
<span id="cb73-996"><a href="#cb73-996" aria-hidden="true" tabindex="-1"></a>  <span class="at">outer.rules =</span> <span class="dv">1</span> , <span class="co">#Include line rules around table</span></span>
<span id="cb73-997"><a href="#cb73-997" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.note =</span> <span class="st">"The grade predictor was centered at 8th-grade for Models 2 and 3. In Model 4, it was centered at 7th grade to ensure all values were greater than 0."</span></span>
<span id="cb73-998"><a href="#cb73-998" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-999"><a href="#cb73-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1000"><a href="#cb73-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1001"><a href="#cb73-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1002"><a href="#cb73-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1003"><a href="#cb73-1003" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>