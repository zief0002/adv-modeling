<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Log-Transforming the Predictor – Advanced Modeling and Reproducibility for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-04-logarithmic-transformations-outcome.html" rel="next">
<link href="./03-02-information-criteria-and-model-selection.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed04999718f06b735b1f8009dce43b94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7c121de436c7c20b050f1da4c0bef0bb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-modeling-nonlinearity.html">Modeling Nonlinearity</a></li><li class="breadcrumb-item"><a href="./03-03-logarithmic-transformations-predictor.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Modeling and Reproducibility for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-introduction-to-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-more-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-creating-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Tables with gt</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-mathematical-foundations-probability-density.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-likelihood-framework-for-evidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-likelihood-framework-for-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-modeling-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonlinearity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-polynomial-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Polynomial Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-information-criteria-and-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Information Criteria and Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-03-logarithmic-transformations-predictor.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-04-logarithmic-transformations-outcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-05-rule-of-the-bulge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Rule of the Bulge—An Example”</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-00-modeling-dichotomous-outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Dichotomous Outcomes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-01-linear-probability-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-02-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-03-more-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">More Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-00-modeling-nonindependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonindependence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-01-introduction-to-mixed-effects-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to Mixed-Effects Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-02-lmer-average-change-over-time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-03-lmer-other-random-effects-and-covariates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">LMER: Other Random-Effects and Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-04-lmer-alt-representations-and-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">LMER: Alternative Representations and Assumptions</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-modeling-nonlinearity.html">Modeling Nonlinearity</a></li><li class="breadcrumb-item"><a href="./03-03-logarithmic-transformations-predictor.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Quarto Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, you will learn another method of dealing with nonlinearity. Specifically, we will look at log-transforming the predictor in a linear model. To do so, we will use the <a href="https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/mn-schools.csv"><em>mn-schools.csv</em></a> dataset. See <a href="http://zief0002.github.io/fluffy-ants/codebooks/mn-schools.html">data codbook</a> for additional information.</p>
<p>Our goal will be to re-visit if (and how) academic “quality” of the student-body (measured by SAT score) is related to institutional graduation rate. Within this work, we will use information theoretic approcaches (namely the AICc and related measures) to evaluate any fitted models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/mn-schools.csv"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>mn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 6
      id name                               grad public   sat tuition
   &lt;dbl&gt; &lt;chr&gt;                             &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1     1 Augsburg College                   65.2      0  10.3    39.3
 2     3 Bethany Lutheran College           52.6      0  10.6    30.5
 3     4 Bethel University, Saint Paul, MN  73.3      0  11.4    39.4
 4     5 Carleton College                   92.6      0  14      54.3
 5     6 College of Saint Benedict          81.1      0  11.8    43.2
 6     7 Concordia College at Moorhead      69.4      0  11.4    36.6
 7     8 Concordia University-Saint Paul    47.9      0   9.9    37.8
 8     9 Crossroads College                 26.9      0   9.7    25.3
 9    10 Crown College                      51.3      0  10.3    33.2
10    11 Gustavus Adolphus College          81.7      0  12.2    43.8
# ℹ 23 more rows</code></pre>
</div>
</div>
<p><br></p>
<section id="relationship-between-graduation-rate-and-sat-scores" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="relationship-between-graduation-rate-and-sat-scores"><span class="header-section-number">10.1</span> Relationship between Graduation Rate and SAT Scores</h2>
<p>In a previous set of notes, we determined that the relationship between SAT scores and graduation rates was curvilinear. We initially saw evidence of this curvilinearity in the scatterplot of graduation rates versus median SAT scores. After fitting a model assuming a linear relationship (syntax not shown), the plot of the standardized residuals versus the fitted values also suggests that the linearity assumption is not tenable.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat, <span class="at">data =</span> mn)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check linearity assumptions</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm<span class="fl">.1</span>, <span class="at">type =</span> <span class="st">"s"</span>) </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout plot</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-scatterplot" class="quarto-float quarto-figure quarto-figure-center anchored" alt="LEFT: Six-year graduation rate as a function of median SAT score. The loess smoother (blue line) is also displayed. RIGHT: Scatterplot of the standardized residuals versus the fitted values for a model using median SAT scores to predict variation in six-year graduation rates. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-scatterplot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="LEFT: Six-year graduation rate as a function of median SAT score. The loess smoother (blue line) is also displayed. RIGHT: Scatterplot of the standardized residuals versus the fitted values for a model using median SAT scores to predict variation in six-year graduation rates. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: LEFT: Six-year graduation rate as a function of median SAT score. The loess smoother (blue line) is also displayed. RIGHT: Scatterplot of the standardized residuals versus the fitted values for a model using median SAT scores to predict variation in six-year graduation rates. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="logarithmic-function-yet-another-non-linear-function" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="logarithmic-function-yet-another-non-linear-function"><span class="header-section-number">10.1.1</span> Logarithmic Function: Yet Another Non-Linear Function</h3>
<p>One way to model this non-linearity is to fit a model that included a quadratic polynomial effect. Remember that the quadratic function is ‘U’-shaped. In our example, the quadratic term was negative, which creates an upside-down ‘U’-shape. This negative quadratic function is shown in the left-had side of the figure below.</p>
<p>We do not have to use a quadratic function to model curvilinear relationships. We can use any mathematical function that mimics the curvilinear pattern observed in the data.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> One mathematical function that is useful for modeling curvilinearity is the logarithmic function. The logarithmic function is shown in the right-hand side of the figure below.</p>
<div class="cell" data-layout-align="center" data-fig-at="LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*.">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fig_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_01, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quadratic Function"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="fu">log2</span>(x))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Logarithmic Function"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-quadratic-log" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quadratic-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-quadratic-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quadratic-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: LEFT: Negative quadratic function of <em>X</em>. RIGHT: Logarithmic function of <em>X</em>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>These two functions have some similarities. They both model non-linear growth (continuous and diminishing growth). However, in the quadratic function, this growth eventually peaks and then is followed by continuous and increasing loss (parabola; the function changes direction). The logarithmic function, on the other hand, does not change direction—it continues to grow, albeit ever diminishing in the amount of growth.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>As you consider different mathematical functions, it is important to consider the substantive knowledge in an area. For example, while empirically both the quadratic polynomial model and the logarithmic model might both suggest reasonable fit to the data, in this context, the logarithmic model might be a more substantively sound model than the quadratic polynomial model. We would probably expect that the effect of SAT on graduation rate would diminish for schools with higher median SAT scores, but that it wouldn’t actually change direction. (This would mean that at some value, an increase in SAT would be associated with a lower graduation rate!)</p>
<p><br></p>
</section>
<section id="fitting-a-logarithmic-function-using-lm" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="fitting-a-logarithmic-function-using-lm"><span class="header-section-number">10.1.2</span> Fitting a Logarithmic Function Using <code>lm()</code></h3>
<p>The mathematical expression of the logarithmic function is:</p>
<p><span class="math display">\[
Y = \log(X)
\]</span></p>
<p>This implies that, to fit a logarithmic function we need to log-transform the predictor and use that in the <code>lm()</code> function. (Note that we do not transform the <em>Y</em>-value.) The choice of base for the logarithm is irrelevant statistically, but does impact the interpretation of the slope. To illustrate, we will examine fitting models using base-2, base-10, and base-e. Rather than mutating the log-transformed variables into the data, we will include the log-transformation directly in the <code>lm()</code> function.</p>
<p><br></p>
</section>
<section id="using-base-2-log-transformed-sat-scores-in-the-regression-model" class="level3" data-number="10.1.3">
<h3 data-number="10.1.3" class="anchored" data-anchor-id="using-base-2-log-transformed-sat-scores-in-the-regression-model"><span class="header-section-number">10.1.3</span> Using Base-2 Log-Transformed SAT Scores in the Regression Model</h3>
<p>To fit the model, we use the <code>lm()</code> function and input the log-transformed SAT scores as the predictor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>lm.log2 <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat, <span class="at">base =</span> <span class="dv">2</span>), <span class="at">data =</span> mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<p>We can now look at the regression output and interpret the results.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.811         0.805  7.39      133. 9.30e-13     1  -112.  230.  234.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>Examining the model-level output, we see that differences in <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> explain 81.13% of the variation in graduation rates. Since differences in <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> imply that there are differences in the raw SAT scores, we would typically just say that “differences in SAT scores explain 81.13% of the variation in graduation rates.”</p>
<p>Moving to the coefficient-level output,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term               estimate std.error statistic  p.value
  &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)           -307.     31.9      -9.62 7.94e-11
2 log(sat, base = 2)     106.      9.22     11.5  9.30e-13</code></pre>
</div>
</div>
<p>We can write the fitted equation as,</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 106.4\bigg[\log_2(\mathrm{SAT}_i)\bigg]
\]</span></p>
<p>We can interpret the coefficients as we always do, recognizing that these interpretation are based on the log-transformed predictor.</p>
<ul>
<li>The intercept value of <span class="math inline">\(-306.7\)</span> is the predicted average graduation rate for all colleges/universities with a <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> value of 0.</li>
<li>The slope value of 106.4 indicates that each one-unit difference in <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> is associated with a 106.4-unit difference in graduation rate, on average.</li>
</ul>
<p><br></p>
</section>
<section id="better-interpretations-back-transforming-to-the-raw-metric" class="level3" data-number="10.1.4">
<h3 data-number="10.1.4" class="anchored" data-anchor-id="better-interpretations-back-transforming-to-the-raw-metric"><span class="header-section-number">10.1.4</span> Better Interpretations: Back-transforming to the Raw Metric</h3>
<p>While these interpretations are technically correct, it is more helpful to your readers (and more conventional) to interpret any regression results in the raw metric of the variable rather than log-transformed metric. This means we have to <em>back-transform the interpretations</em>. To back-transform a logarithm, we use its inverse function; exponentiation.</p>
<p>We interpreted the intercept as, “the predicted average graduation rate for all colleges/universities with a <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> value of 0”. To interpret this using the raw metric of our SAT attribute, we have to understand what <span class="math inline">\(\log_2(\mathrm{SAT}) = 0\)</span> is equivalent to in the original SAT variable’s scale. Mathematically,</p>
<p><span class="math display">\[
\log_2 (\mathrm{SAT}) = 0 \quad \mathrm{is~equivalent~to} \quad 2^{0} = \mathrm{SAT} \\
\]</span></p>
<p>In this computation, <span class="math inline">\(\mathrm{SAT}=1\)</span>. Thus, rather than using the log-transformed interpretation, we can, instead, interpret the intercept as,</p>
<blockquote class="blockquote">
<p>The predicted average graduation rate for all colleges/universities with a median SAT value of 1 (which since this is measures in hundreds corresponds to a median SAT of 100) is <span class="math inline">\(-306.7\)</span>. Since there are no colleges/universities in our data that have a median SAT value of 1, this is extrapolation.</p>
</blockquote>
<p>What about the slope? Our interpretation was that “each one-unit difference in <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> is associated with a 106.4-unit difference in graduation rate, on average.” Working with the same idea of back-transformation, we need to understand what a one-unit difference in <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> means. Consider four values of <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> that are each one-unit apart:</p>
<p><span class="math display">\[
\begin{split}
\log_2(\mathrm{SAT}) &amp;= 1\\
\log_2(\mathrm{SAT}) &amp;= 2\\
\log_2(\mathrm{SAT}) &amp;= 3\\
\log_2(\mathrm{SAT}) &amp;= 4
\end{split}
\]</span></p>
<p>If we back-transform each of these, then we can see how the four values of the raw SAT variable would differ.</p>
<p><span class="math display">\[
\begin{split}
\mathrm{SAT} &amp;= 2^1 = 2\\
\mathrm{SAT} &amp;= 2^2 = 4\\
\mathrm{SAT} &amp;= 2^3 = 8\\
\mathrm{SAT} &amp;= 2^4 = 16
\end{split}
\]</span></p>
<p>When <span class="math inline">\(\log_2(\mathrm{SAT})\)</span> is increased by one-unit, the raw SAT value is doubled. We can use this in our interpretation of slope:</p>
<blockquote class="blockquote">
<p>A doubling of the SAT value is associated with a 106.4 percentage point difference in graduation rate, on average.</p>
</blockquote>
<p>The technical language for doubling is a “two-fold difference”. So we would conventionally interpret this as:</p>
<blockquote class="blockquote">
<p>Each two-fold difference in SAT value is associated with a 106.4 percentage point difference in graduation rate, on average.</p>
</blockquote>
<p>To understand this further, consider a specific school, say Augsburg. Their measurement on the raw SAT variable is 10.3, and their log-transformed SAT score is 3.36. Using the fitted regression equation (which employs the log-transformed SAT),</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">106.4</span> <span class="sc">*</span> <span class="fl">3.36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.804</code></pre>
</div>
</div>
<p>Augsburg’s predicted graduation rate would be 50.8. If we increase the <code>l2sat</code> score by 1 to 4.36 (which is equivalent to a raw SAT measurement of 20.6; double 10.3), their predicted graduation rate would be,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">106.4</span> <span class="sc">*</span> <span class="fl">4.36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 157.204</code></pre>
</div>
</div>
<p>This is an increase of 106.4 percentage points from the predicted value of 50.8 when the <code>l2sat</code> value was 3.36.</p>
<p><br></p>
</section>
</section>
<section id="using-base-10-log-transformed-sat-scores-in-the-regression-model" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="using-base-10-log-transformed-sat-scores-in-the-regression-model"><span class="header-section-number">10.2</span> Using Base-10 Log-Transformed SAT Scores in the Regression Model</h2>
<p>How do things change if we log-transfomr the SAT scores using base-10 rather than base-2?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lm.log10 <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat, <span class="at">base =</span> <span class="dv">10</span>), <span class="at">data =</span> mn)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.811         0.805  7.39      133. 9.30e-13     1  -112.  230.  234.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>Examining the model-level output, we see that differences in <span class="math inline">\(\log_{10}(\mathrm{SAT})\)</span> explain 81.13% of the variation in graduation rates. Or simply, that differences in SAT scores explain 81.13% of the variation in graduation rates. <strong>These model-level results are the same as when we used the base-2 logarithm.</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term                estimate std.error statistic  p.value
  &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)            -307.      31.9     -9.62 7.94e-11
2 log(sat, base = 10)     354.      30.6     11.5  9.30e-13</code></pre>
</div>
</div>
<p>The linear form of the fitted equation is,</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 353.6\bigg[\log_{10}(\mathrm{SAT}_i)\bigg]
\]</span></p>
<!-- We could also, alternatively, express the fitted equation in its nonlinear form as: -->
<!-- $$ -->
<!-- \hat{\mathrm{Graduation~Rate}_i} = \log_{10}\bigg(10^{-306.7} \times \mathrm{SAT}_i^{353.6}\bigg) -->
<!-- $$ -->
<p>We can interpret the coefficients using the base-10 logarithm of SAT scores as:</p>
<ul>
<li>The intercept value of <span class="math inline">\(-306.7\)</span> is the predicted average graduation rate for all colleges/universities with a <span class="math inline">\(\log_{10}(\mathrm{SAT})\)</span> value of 0.</li>
<li>The slope value of 353.6 indicates that each one-unit difference in <span class="math inline">\(\log_{10}(\mathrm{SAT})\)</span> is associated with a 353.6-unit difference in graduation rate, on average.</li>
</ul>
<p>Comparing these results back to the base-2 results, we see that the interpretation of the intercept is identical to that from the base-2 model. The interpretation of the slope has changed. We can understand why by <em>back-transforming the coefficient interpretations</em> so that we are using raw median SAT scores rather than <span class="math inline">\(\log_{10}(\mathrm{SAT})\)</span> scores.</p>
<ul>
<li>The predicted average graduation rate for all colleges/universities with a SAT value of 1 (median SAT score = 100) is <span class="math inline">\(-306.7\)</span>.</li>
<li>Each <em>ten-fold</em> difference in SAT is associated with a 353.6 percentage point difference in graduation rate, on average.</li>
</ul>
<p>To further think about the effect of SAT, if Augsburg improved its median SAT score ten-fold (i.e., going from a SAT value of 10.3 to a value of 103) we would predict its graduation rate to go up by 353.6 percentage points!</p>
<p>The reason the slope value is different is because in this model we are expressing the change in the graduation rate for ten-fold difference in SAT scores, whereas in the previous model the slope value expressed the change in the graduation rate for two-fold difference in SAT scores.</p>
<section id="what-about-the-residual-fit" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="what-about-the-residual-fit"><span class="header-section-number">10.2.1</span> What About the Residual Fit?</h3>
<p>While most of the results didn’t change when we used base-10 rather than base-2, you might be asking whether one of these models fits the data better than the other. To determine that, we need to compare the residuals from these models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots for base-2 model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm.log2)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots for base-10 model</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm.log10)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resid-compare" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot of the standardized residuals versus the fitted values for the model fitted using the base-2 log-transformed median SAT values (LEFT) and the base-10 log-transformed median SAT values (RIGHT). In both plots the reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-resid-compare-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Scatterplot of the standardized residuals versus the fitted values for the model fitted using the base-2 log-transformed median SAT values (LEFT) and the base-10 log-transformed median SAT values (RIGHT). In both plots the reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Scatterplot of the standardized residuals versus the fitted values for the model fitted using the base-2 log-transformed median SAT values (LEFT) and the base-10 log-transformed median SAT values (RIGHT). In both plots the reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The residuals fit EXACTLY the same. That suggests that changing the base does NOT improve the fit of the model. Why is this? Let’s again use Augsburg as an example. Using the fitted model that employed the base-2 logarithm, we found that Augsburg’s predicted graduation rate was,</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Graduation~Rate}} &amp;= -306.7 + 106.4\bigg[\log_2(10.3)\bigg] \\
&amp;= -306.7 + 106.4\bigg[3.36\bigg] \\
&amp;= 50.8
\end{split}
\]</span></p>
<p>Using the model that employed the base-10 logarithm, Augsburg’s predicted graduation rate would be</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Graduation~Rate}} &amp;= -306.7 + 353.6\bigg[\log_{10}(10.3)\bigg] \\
&amp;= -306.7 + 353.6\bigg[1.01\bigg] \\
&amp;= 50.8
\end{split}
\]</span></p>
<p>Augsburg’s predicted graduation rate is <em>exactly the same</em> in the two models. This implies that Augsburg’s residual would also be the same in the two models. This is true for every college. Because of this, increasing (or decreasing) the base used in the logarithm does not help improve the fit of the model. The fit is exactly the same no matter which base you choose.</p>
<div class="fyi">
<p><strong>PROTIP</strong></p>
<p>Regardless of base choice, the model-level results (e.g., <span class="math inline">\(R^2\)</span>, AICc) will the same. At the coefficient level, the intercept results (<em>B</em>, <em>SE</em>, <em>p</em>-value) will also be the same regardless of base. The only results that change are the results for the log-transformed effect (i.e., the estimate and SE for the slope). This reflects the change in scale and interpretation. However, the inferential results (<em>t</em>-value and <em>p</em>-value) are the same for both transformations. <strong>Because of this, the choice of base is solely based on interpretation of the slope.</strong> For example, does it make more sense to talk about a <em>two-fold</em> difference in the predictor? A <em>five-fold</em> difference in the predictor? A <em>ten-fold</em> difference in the predictor?</p>
</div>
<p><br></p>
</section>
<section id="using-base-e-log-transformed-sat-scores-in-the-regression-model" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="using-base-e-log-transformed-sat-scores-in-the-regression-model"><span class="header-section-number">10.2.2</span> Using Base-e Log-Transformed SAT Scores in the Regression Model</h3>
<p>In our example, neither of the bases we examined is satisfactory in terms of interpreting the effect of median SAT score on graduation rate. Two-fold differences in median SAT scores are very unlikely, to say anything of ten-fold differences. One base that is commonly used for log-transformations because it offers a reasonable interpretation is base-<em>e</em>. Below we regress graduation rates on the log-transformed SAT scores, using the natural logarithm.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.811         0.805  7.39      133. 9.30e-13     1  -112.  230.  234.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    -307.      31.9     -9.62 7.94e-11
2 log(sat)        154.      13.3     11.5  9.30e-13</code></pre>
</div>
</div>
<p>As with any base, using base-<em>e</em> results in the same model-level evidence (<span class="math inline">\(R^2=.811\)</span>, AIC values). The fitted equation is,</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 153.6\bigg[\ln(\mathrm{SAT}_i)\bigg]
\]</span></p>
<p>The intercept has the same coefficient (<span class="math inline">\(\hat\beta_0=-306.7\)</span>), SE, <em>t</em>-value, and <em>p</em>-value as the intercept from the models using base-2 and base-10 log-transformations of SAT. (This is, again, because <span class="math inline">\(2^0=10^0=e^0=1\)</span>.) And, although the coefficient and SE for the effect of SAT is again different (a one-unit change in the three different log-scales does not correspond to the same amount of change in raw SAT for the three models).</p>
<p>So how can we interpret the model’s coefficients?</p>
<ul>
<li>The intercept can be interpreted exactly the same as in the previous models in which we used base-2 or base-10; namely that the predicted average graduation rate for colleges/universities with a SAT value of one (median SAT score of 100) is <span class="math inline">\(-306.7\)</span>.</li>
<li>Interpreting the slope, we could say that an <em>e</em>-fold difference in SAT value is associated with a 153.6-unit difference in graduation rates, on average.</li>
</ul>
<p>We can aslo verify that this model’s residuals are identical to the other log-transformed models’ residuals.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residuals for base-2 log-transformed SAT</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residuals-ln" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the standardized residuals versus the fitted values for a model fitted using the natural log-transformed median SAT scores. The reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-ln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-residuals-ln-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Plot of the standardized residuals versus the fitted values for a model fitted using the natural log-transformed median SAT scores. The reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-ln-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.4: Plot of the standardized residuals versus the fitted values for a model fitted using the natural log-transformed median SAT scores. The reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="interpretation-using-percent-change" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="interpretation-using-percent-change"><span class="header-section-number">10.2.3</span> Interpretation Using Percent Change</h3>
<p>Consider three schools, each having a median SAT values that differs by 1%; say these schools have median SAT values of 10, 10.1, 10.201. Using the fitted equation, we can compute the predicted graduation rate for each of these hypothetical schools:</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}} = -306.7 + 153.6 \bigg[\ln (\mathrm{SAT})\bigg]
\]</span></p>
<p>The SAT values and predicted graduation rates for these schools are given below:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tab_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sat =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">10.1</span>, <span class="fl">10.201</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">grad =</span> <span class="fu">predict</span>(lm.ln, <span class="at">newdata =</span> .)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>tab_05 <span class="sc">|&gt;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(sat, grad),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sat =</span> <span class="fu">md</span>(<span class="st">"*SAT*"</span>),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">grad =</span> <span class="fu">md</span>(<span class="st">"Predicted Graduation Rate"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">40</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-pred-grad" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pred-grad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10.1: Median SAT Values and Graduation Rates for Three Hypothetical Schools that have Median SAT Values that Differ by One Percent.
</figcaption>
<div aria-describedby="tbl-pred-grad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="mzclroceug" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mzclroceug table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mzclroceug thead, #mzclroceug tbody, #mzclroceug tfoot, #mzclroceug tr, #mzclroceug td, #mzclroceug th {
  border-style: none;
}

#mzclroceug p {
  margin: 0;
  padding: 0;
}

#mzclroceug .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 40%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mzclroceug .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mzclroceug .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mzclroceug .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mzclroceug .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mzclroceug .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzclroceug .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mzclroceug .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mzclroceug .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mzclroceug .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mzclroceug .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mzclroceug .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mzclroceug .gt_spanner_row {
  border-bottom-style: hidden;
}

#mzclroceug .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mzclroceug .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mzclroceug .gt_from_md > :first-child {
  margin-top: 0;
}

#mzclroceug .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mzclroceug .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mzclroceug .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mzclroceug .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mzclroceug .gt_row_group_first td {
  border-top-width: 2px;
}

#mzclroceug .gt_row_group_first th {
  border-top-width: 2px;
}

#mzclroceug .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzclroceug .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mzclroceug .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mzclroceug .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzclroceug .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzclroceug .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mzclroceug .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mzclroceug .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mzclroceug .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mzclroceug .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mzclroceug .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzclroceug .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mzclroceug .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mzclroceug .gt_left {
  text-align: left;
}

#mzclroceug .gt_center {
  text-align: center;
}

#mzclroceug .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mzclroceug .gt_font_normal {
  font-weight: normal;
}

#mzclroceug .gt_font_bold {
  font-weight: bold;
}

#mzclroceug .gt_font_italic {
  font-style: italic;
}

#mzclroceug .gt_super {
  font-size: 65%;
}

#mzclroceug .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mzclroceug .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mzclroceug .gt_indent_1 {
  text-indent: 5px;
}

#mzclroceug .gt_indent_2 {
  text-indent: 10px;
}

#mzclroceug .gt_indent_3 {
  text-indent: 15px;
}

#mzclroceug .gt_indent_4 {
  text-indent: 20px;
}

#mzclroceug .gt_indent_5 {
  text-indent: 25px;
}

#mzclroceug .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mzclroceug div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="sat" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>SAT</em></th>
<th id="grad" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Predicted Graduation Rate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="sat">10.000</td>
<td class="gt_row gt_center" headers="grad">46.87784</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="sat">10.100</td>
<td class="gt_row gt_center" headers="grad">48.40581</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="sat">10.201</td>
<td class="gt_row gt_center" headers="grad">49.93378</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>The difference between each subsequent predicted graduation rate is 1.53.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between predicted value for 10.1 and 10</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fl">48.4058</span> <span class="sc">-</span> <span class="fl">46.8778</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.528</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between predicted value for 10.201 and 10.1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fl">49.9338</span> <span class="sc">-</span> <span class="fl">48.4058</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.528</code></pre>
</div>
</div>
<p>In other words, schools that have a SAT value that differ by 1%, have predicted graduation rates that differ by 1.53, on average.</p>
<div class="fyi">
<p><strong>WARNING</strong></p>
<p>Be very careful when you are using “percent difference” and “percentage points difference”. These are two very different things. For example, increasing a graduation rate from 50% to 60% represents a difference of 10 percentage points, but it is a 20% increase!</p>
</div>
<p><br></p>
</section>
<section id="mathematically-calculating-the-size-of-the-effect" class="level3" data-number="10.2.4">
<h3 data-number="10.2.4" class="anchored" data-anchor-id="mathematically-calculating-the-size-of-the-effect"><span class="header-section-number">10.2.4</span> Mathematically Calculating the Size of the Effect</h3>
<p>To understand how we can directly compute the effect for a 1% change in <em>X</em>, consider the predicted values for two <em>x</em>-values that differ by 1%, if we use symbolic notation:</p>
<p><span class="math display">\[
\begin{split}
\hat{y}_1 &amp;= \hat\beta_0 + \hat\beta_1\left[\ln(x)\right] \\
\hat{y}_2 &amp;= \hat\beta_0 + \hat\beta_1\left[\ln(1.01x)\right]
\end{split}
\]</span></p>
<p>The difference in their predicted values is:</p>
<p><span class="math display">\[
\begin{split}
\hat{y}_2 - \hat{y}_1 &amp;= \hat\beta_0 + \hat\beta_1\left[\ln(1.01x)\right] - \left(\hat\beta_0 + \hat\beta_1\left[\ln(x)\right]\right) \\[1ex]
&amp;=\hat\beta_0 + \hat\beta_1\left[\ln(1.01x)\right] - \hat\beta_0 - \hat\beta_1\left[\ln(x)\right] \\[1ex]
&amp;=\hat\beta_1\left[\ln(1.01x)\right] - \hat\beta_1\left[\ln(x)\right] \\[1ex]
&amp;=\hat\beta_1\left[\ln(1.01x) - \ln(x)\right]\\[1ex]
&amp;=\hat\beta_1\left[\ln(\frac{1.01x}{1x})\right]
\end{split}
\]</span></p>
<p>If we substitute in any value for <span class="math inline">\(x\)</span>, we can now directly compute this constant difference. Note that a convenient value for <em>X</em> is 1. Then this reduces to:</p>
<p><span class="math display">\[
\hat\beta_1\left[\ln(1.01)\right]
\]</span></p>
<p>So now, we can interpret this as: a 1% difference in <em>X</em> is associated with a <span class="math inline">\(\hat\beta_1\left[\ln(1.01)\right]\)</span>-unit difference in <em>Y</em>, on average.</p>
<p>In our model, we can compute this difference using the fitted coefficient <span class="math inline">\(\hat\beta_1=153.6\)</span> as</p>
<p><span class="math display">\[
153.6\left[\ln(1.01)\right] = 1.528371
\]</span></p>
<p>The same computation using R is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fl">153.6</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fl">1.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.528371</code></pre>
</div>
</div>
<p>This gives you the constant difference exactly. So you can interpret the effect of SAT as, each 1% difference in SAT score is associated with a difference in graduation rates of 1.53 percentage points, on average.</p>
<p><br></p>
</section>
<section id="approximating-the-size-of-the-effect" class="level3" data-number="10.2.5">
<h3 data-number="10.2.5" class="anchored" data-anchor-id="approximating-the-size-of-the-effect"><span class="header-section-number">10.2.5</span> Approximating the Size of the Effect</h3>
<p>We can get an approximation for the size of the effect by using the mathematical shortcut of:</p>
<p><span class="math display">\[
\mathrm{Effect} \approx \frac{\hat\beta_1}{100}
\]</span></p>
<p>Using our fitted results, we could approximate the size of the effect as,</p>
<p><span class="math display">\[
\frac{153.6}{100} = 1.536
\]</span></p>
<p>We could then interpret the effect of SAT by saying a 1% difference in median SAT score is associated with a 1.53 percentage point difference in predicted graduation rate, on average.</p>
<p><br></p>
</section>
</section>
<section id="plotting-the-fitted-curve" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="plotting-the-fitted-curve"><span class="header-section-number">10.3</span> Plotting the Fitted Curve</h2>
<p>To aid interpretation of the effect of median SAT score on graduation rate, we can plot the fitted curve. Recall that our fitted equation was:</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}} = -306.7 + 153.6 \bigg[\ln (\mathrm{SAT})\bigg]
\]</span></p>
<p>We can implement this into the <code>geom_function()</code> layer of our <code>ggplot()</code> syntax.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">153.6</span><span class="sc">*</span><span class="fu">log</span>(x)}</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plot-model-01" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the predicted graduation rate as a function of median SAT score. The non-linearity in the plot indicates that there is a diminishing positive effect of SAT on graduation rates." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-plot-model-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-plot-model-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Plot of the predicted graduation rate as a function of median SAT score. The non-linearity in the plot indicates that there is a diminishing positive effect of SAT on graduation rates.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot-model-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.5: Plot of the predicted graduation rate as a function of median SAT score. The non-linearity in the plot indicates that there is a diminishing positive effect of SAT on graduation rates.
</figcaption>
</figure>
</div>
</div>
</div>
<p><br></p>
<section id="alternative-form-of-the-fitted-equation" class="level3 mathnote" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="alternative-form-of-the-fitted-equation"><span class="header-section-number">10.3.1</span> Alternative Form of the Fitted Equation</h3>
<p>The fitted equation expresses graduation rates as a function of log-transformed median SAT scores. Using the natural logarithm, the fitted equation is:</p>
<p><span class="math display">\[
\hat{Y}_i = \hat\beta_0 + \hat\beta_1\bigg[\ln(X_i)\bigg]
\]</span></p>
<p>Now we will work through the algebra to relate <span class="math inline">\(\hat{Y}_i\)</span> to <span class="math inline">\(X_i\)</span>. Because there is a log of <em>X</em> we need to exponentiate both sides of the equation to get back to the raw X.</p>
<p><span class="math display">\[
e^{\hat{Y}_i} = e^{\hat\beta_0 + \hat\beta_1\bigg[\ln(X_i)\bigg]}
\]</span></p>
<p>Then we can use the algebraic rules of exponents and logarithms to re-express this equation.</p>
<p><span class="math display">\[
\begin{split}
e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times e^{\hat\beta_1\bigg[\ln(X_i)\bigg]} \\[1ex]
e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times \bigg[e^{\ln(X_i)}\bigg]^{\hat\beta_1} \\[1ex]
e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times X_i^{\hat\beta_1}
\end{split}
\]</span></p>
<p>Now the only problem is that the left-hand side is <span class="math inline">\(2^{\hat{Y}_i}\)</span> and not <span class="math inline">\(Y_i\)</span>. To fix this we take the natural logarithm of both sides of the equation.</p>
<p><span class="math display">\[
\ln\bigg(e^{\hat{Y}_i}\bigg) = \ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg)
\]</span></p>
<p>This gives us an expression of the curve that relates the outcome to the predictor. Namely,</p>
<p><span class="math display">\[
\hat{Y}_i = \ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg)
\]</span></p>
<p>Notice that the right-hand side of this expression is a log function; it has the general form of <span class="math inline">\(Y=\log(\)</span>🦒<span class="math inline">\()\)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> Remember that this is the continuous decay function we were interested in using to model the curvilinearity shown in the data. The important thing is that this non-linear decay function is mathematically the same as using a the log-transformed predictor to model the outcome with linear model.</p>
<p><span class="math display">\[
Y_i=\ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg) ~~\equiv~~ Y_i =\beta_0 + \beta_1\bigg[\ln(X_i)\bigg]
\]</span></p>
<p>Practically speaking, this means we can model non-linearity using a linear model. Which means we can use the <code>lm()</code> function and all the other ideas you have learned about linear models (e.g., including covariates, adding interaction effects, assumption checking).</p>
</section>
<p><br></p>
</section>
<section id="polynomial-effects-vs.-log-transformations" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="polynomial-effects-vs.-log-transformations"><span class="header-section-number">10.4</span> Polynomial Effects vs.&nbsp;Log-Transformations</h2>
<p>The inclusion of polynomial effects and the use of a log-transformation was to model the nonlinearity observed in the relationship between SAT scores and graduation rates. Both methods were successful in this endeavor. While either method could be used in practice to model nonlinearity, there are some considerations when making the choice of which may be more appropriate for a given modeling situation.</p>
<p>The first consideration is one of substantive theory. The plot below shows the mathematical function for a log-transformed <em>X</em> (solid, black line) and for a quadratic polynomial of <em>X</em> (dashed, red line).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.01</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>y <span class="ot">=</span> <span class="fu">log</span>(new<span class="sc">$</span>x)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>quad <span class="ot">=</span>  <span class="sc">-</span><span class="fl">0.21717</span> <span class="sc">+</span> <span class="fl">0.48782</span><span class="sc">*</span>new<span class="sc">$</span>x  <span class="sc">-</span> <span class="fl">0.02453</span><span class="sc">*</span>new<span class="sc">$</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> new, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"#ea5975"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(quad <span class="sc">~</span> x, <span class="at">data =</span> new, <span class="at">col =</span> <span class="st">"#6d92ee"</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-quad-02" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Comparison of the quadratic polynomial (blue, dashed line) and logarithmic (red, solid line) functions of *X*." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quad-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-quad-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Comparison of the quadratic polynomial (blue, dashed line) and logarithmic (red, solid line) functions of *X*.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quad-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.6: Comparison of the quadratic polynomial (blue, dashed line) and logarithmic (red, solid line) functions of <em>X</em>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Both functions are nonlinear, however the polynomial function changes direction. For low <em>x</em>-values, the function has a large positive effect. This effect diminishes as the values of <em>X</em> gets bigger, and around <span class="math inline">\(x=9\)</span> the effect is zero. For larger values of <em>X</em>, the effect is actually negative. For the logarithmic function, the effect is always positive, but it diminishes as <em>X</em> gets larger. (Functions that constantly increase, or constantly decrease, are referred to as <em>monotonic functions</em>.) Theoretically, these are very different ideas, and if substantive literature suggests one or the other, you should probably acknowledge that in the underlying statistical model that is fitted.</p>
<p>Empirically, the two functions are very similar especially within certain ranges of <em>X</em>. For example, although the predictions from these models would be quite different for really high values of <em>X</em>, if we only had data from the range of 2 to 8 (<span class="math inline">\(2\leq X \leq 8\)</span>) both functions would produce similar residuals. In this case, the residuals would likely not suggest better fit for either of the two models. In this case, it might be prudent to think about <a href="https://en.wikipedia.org/wiki/Occam%27s_razor">Occam’s Razor</a>—if two competing models produce similar predictions, adopt the simpler model. Between these two functions, the <strong>log-transformed model is simpler</strong>; it has one predictor compared to the two predictors in the quadratic model. The mathematical models make this clear:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Quadratic~Polynomial:~}Y_i &amp;= \beta_0 + \beta_1(X_i) + \beta_2(X_i^2) +\epsilon_i \\
\mathbf{Log\mbox{-}Transform:~}Y_i &amp;= \beta_0 + \beta_1\bigg[\ln(X_i)\bigg] + \epsilon_i
\end{split}
\]</span></p>
<p>In the polynomial model, we need to estimate four parameters: an intercept, a slope for the linear term of <em>X</em>, a slope for the quadratic term of <em>X</em>, and a residual variance term. (Remember, the quadratic polynomial model is an interaction model.) While the log model only requires us to estimate three parameters (<span class="math inline">\(\hat\beta_0\)</span>, <span class="math inline">\(\hat\beta_1\)</span>, and <span class="math inline">\(\hat\sigma^2_{\epsilon}\)</span>). If there is no theory to guide your model’s functional form, and the residuals from the polynomial and log-transformed models seem to fit equally well, then the log-transformed model saves you a degree of freedom, and better achieves the goal of parsimony.</p>
<p>From the two models, it is also possible to see that the these are not nested models; by setting one (or more) of the effects in either model to zero, we do not end up with the other model. This means we CANNOT use the likelihood ratio test to compare whether the quadratic model or the logarithmic model is more appropriate. However, we could use information criteria to choose from among these models since they are based on the same data and have the same outcome.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>lm.quad <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat <span class="sc">+</span> <span class="fu">I</span>(sat <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> mn)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>lm.log <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.quad, lm.log),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Quadratic polynomial"</span>, <span class="st">"Log-transformed SAT"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                     K   AICc Delta_AICc AICcWt Cum.Wt      LL
Quadratic polynomial 4 228.55       0.00   0.72   0.72 -109.56
Log-transformed SAT  3 230.39       1.85   0.28   1.00 -111.78</code></pre>
</div>
</div>
<p>Here the quadratic model seems more empirically supported, but there is a fair amount of support for the log-model as well. Given this evidence, we probably cannot discern which model is better. (There is a fair amount of model selection uncertainty.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>)</p>
<p>As with all decisions from statistical evidence, you must also rely on substantive knowledge and an evaluation of the residuals. Substantively, the quadratic model is less defensible, since it seems unlikely that we would see the graduation rate decreasing for institutions with high SAT scores. It is more likely that the effect of SAT score has less and less impact on graduation rates as it gets larger. In this scenario, the substantive knowledge points to the log model rather than the quadratic model.</p>
<p>We can also examine the residuals for the two models:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate residuals</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm.log)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm.quad)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resid-compare-02" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Residual plots for the log model (TOP) and quadratic model (BOTTOM)." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid-compare-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-resid-compare-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Residual plots for the log model (TOP) and quadratic model (BOTTOM).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid-compare-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.7: Residual plots for the log model (TOP) and quadratic model (BOTTOM).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Both models seem tenable based on the residual fit to the assumptions. Given this, the substantive argument, and the parsimony argument (the log model is simpler), I would likely adopt the log model over the quadratic model. You could also make this decision later, after adding other covariates and re-checking the model evidence and residuals for the updated models.</p>
<p><br></p>
</section>
<section id="including-covariates" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="including-covariates"><span class="header-section-number">10.5</span> Including Covariates</h2>
<p>Once we have settled on the functional form for the SAT predictor, we can also include covariates in the model. Below we examine the nonlinear effect of SAT on graduation controlling for differences in sector. To do this, we include a main effect of sector (<code>public</code>) in the model along with the natural log-transformed median SAT scores.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> public <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.866         0.857  6.34      96.6 8.47e-14     2  -106.  220.  226.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>The model explains 86.6% of the variation in graduation rates.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  -286.       28.0     -10.2  2.73e-11
2 public         -8.50      2.44     -3.48 1.56e- 3
3 log(sat)      146.       11.6      12.6  1.74e-13</code></pre>
</div>
</div>
<p>The linear form of the fitted equation is,</p>
<p><span class="math display">\[
\hat{\mathrm{Graduation~Rate}_i} = -286.1 - 8.5(\mathrm{Public}_i) + 146.0\bigg[\ln(\mathrm{SAT}_i)\bigg]
\]</span></p>
<p>Interpreting each of the coefficients using the raw (back-transformed) metric of median SAT value:</p>
<ul>
<li>The intercept value of <span class="math inline">\(-286.1\)</span> is the predicted average graduation rate for all <em>public</em> colleges/universities with a SAT value of 1 (extrapolation).</li>
<li>Public schools have a predicted graduation rate that is 8.5 percentage points lower, on average, than private schools controlling for differences in median SAT scores.</li>
<li>Each 1% difference in median SAT value is associated with a 1.46 percentage point difference in predicted graduation rate, on average, after controlling for differences in sector.</li>
</ul>
<p><br></p>
<section id="plot-of-the-fitted-equation" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="plot-of-the-fitted-equation"><span class="header-section-number">10.5.1</span> Plot of the Fitted Equation</h3>
<p>To further help interpret these effects, we can plot the curves resulting from this fitted equation. Now we will have two curves one for public schools and one for private schools. To determine the exact equations for these curves, we will substitute either 0 (for private schools) or 1 (for public schools) into the fitted equation for the <code>public</code> variable.</p>
<p><strong>Private</strong></p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Graduation~Rate}_i} &amp;= -286.1 - 8.5(0) + 146.0\bigg[\ln(\mathrm{SAT}_i)\bigg] \\
&amp;= -286.1 + 146.0\bigg[\ln(\mathrm{SAT}_i)\bigg] \\
\end{split}
\]</span></p>
<p><strong>Public</strong></p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Graduation~Rate}_i} &amp;= -286.1 - 8.5(1) + 146.0\bigg[\ln(\mathrm{SAT}_i)\bigg] \\
&amp;= -294.6 + 146.0\bigg[\ln(\mathrm{SAT}_i)\bigg] \\
\end{split}
\]</span></p>
<p>We can input each of these fitted equations into a <code>geom_function()</code> layer of our <code>ggplot()</code> syntax.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>( <span class="co"># Private schools</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">286.1</span> <span class="sc">+</span> <span class="fl">146.0</span><span class="sc">*</span><span class="fu">log</span>(x)},</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"#6d92ee"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>( <span class="co"># Public schools</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">294.6</span> <span class="sc">+</span> <span class="fl">146.0</span><span class="sc">*</span><span class="fu">log</span>(x)},</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#fe932d"</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model-02" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted graduation rate as a function of median SAT score for public (blue, solid line) and private (orange, dashed line) institutions." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-03-logarithmic-transformations-predictor_files/figure-html/fig-model-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Plot of predicted graduation rate as a function of median SAT score for public (blue, solid line) and private (orange, dashed line) institutions.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.8: Plot of predicted graduation rate as a function of median SAT score for public (blue, solid line) and private (orange, dashed line) institutions.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot shows the nonlinear, diminishing positive effect of median SAT score on graduation rate for both public and private schools. For schools with lower median SAT scores, there is a larger effect on graduation rates than for schools with higher median SAT scores (for both private and public schools). Note that the curves are parallel (the result of fitting a main effects model) suggesting that the effect of median SAT score on graduation rates is the same for both public and private institutions.</p>
<p>The plot also shows the controlled effect of sector. For schools with the same median SAT score, private schools have a higher predicted graduation rate than public schools, on average. This difference is the same, regardless of median SAT score; again a result of fitting the main effects model.</p>
<p><br></p>
</section>
</section>
<section id="using-information-criteria-to-adopt-a-model" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="using-information-criteria-to-adopt-a-model"><span class="header-section-number">10.6</span> Using Information Criteria to Adopt a Model</h2>
<p>We could use evidence from the information criteria to evaluate the evidence among a set of candidate models, so long as they were fitted with the same data and use the same outcome. For example, consider the following candidate models:</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Model~1:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \epsilon_i \\[2ex]
\mathbf{Model~2:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \beta_1\bigg[\ln(\mathrm{SAT}_i)\bigg] + \epsilon_i \\[2ex]
\mathbf{Model~3:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \beta_1\bigg[\ln(\mathrm{SAT}_i)\bigg] + \beta_2(\mathrm{Public}_i) + \epsilon_i
\end{split}
\]</span></p>
<p>where each model has the assumptions that <span class="math inline">\(\epsilon_i\overset{i.i.d.}{\sim}\mathcal{N}(0,\sigma^2_{\epsilon})\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models (use natural log of SAT)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mn)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat) <span class="sc">+</span> public, <span class="at">data =</span> mn)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm<span class="fl">.1</span>, lm<span class="fl">.2</span>, lm<span class="fl">.3</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Intercept-only"</span>, <span class="st">"Ln(SAT)"</span>, <span class="st">"Ln(SAT) and Sector"</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                   K   AICc Delta_AICc AICcWt Cum.Wt      LL
Ln(SAT) and Sector 4 221.81       0.00   0.99   0.99 -106.19
Ln(SAT)            3 230.39       8.58   0.01   1.00 -111.78
Intercept-only     2 283.00      61.19   0.00   1.00 -139.30</code></pre>
</div>
</div>
<p>The empirical evidence, given the models fitted and the data, overwhelmingly supports Model 3 (the model that includes the effects of median SAT and sector on graduation rates).</p>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>Note that this test can help us evaluate whether there is an effect, but CANNOT tell us whether that effect is nonlinear, nor whether a log function is appropriate to model the effect; for that you are reliant on the residuals!</p>
</div>
<p><br></p>


<!-- -->

</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>So long as we can ultimately write this function as a linear model, namely, <span class="math inline">\(Y_i=\beta_0+\beta_1(x_i) + \epsilon_i\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Mathematically, the instantaneous derivative of the logarithmic function is is always positive, but it approaches 0 for larger values of <em>x</em>, while that for the quadratic function eventually becomes negative.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Here 🦒 is simply a placeholder for the expression <span class="math inline">\(2^{\hat\beta_0} \times X_i^{\hat\beta_1}\)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>In order to determine this we would need more data at higher values of SAT to determine if the graduation rate gets lower or essentially planes off. The lack of data in this range is why we have this model selection uncertainty.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-02-information-criteria-and-model-selection.html" class="pagination-link" aria-label="Information Criteria and Model Selection">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Information Criteria and Model Selection</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-04-logarithmic-transformations-outcome.html" class="pagination-link" aria-label="Log-Transforming the Outcome">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Log-Transforming the Predictor</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"scripts/_common.R"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>In this chapter, you will learn another method of dealing with nonlinearity. Specifically, we will look at log-transforming the predictor in a linear model. To do so, we will use the <span class="co">[</span><span class="ot">*mn-schools.csv*</span><span class="co">](https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/mn-schools.csv)</span> dataset. See <span class="co">[</span><span class="ot">data codbook</span><span class="co">](http://zief0002.github.io/fluffy-ants/codebooks/mn-schools.html)</span> for additional information. </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>Our goal will be to re-visit if (and how) academic "quality" of the student-body (measured by SAT score) is related to institutional graduation rate. Within this work, we will use information theoretic approcaches (namely the AICc and related measures) to evaluate any fitted models.</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/mn-schools.csv"</span>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>mn</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relationship between Graduation Rate and SAT Scores</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>In a previous set of notes, we determined that the relationship between SAT scores and graduation rates was curvilinear. We initially saw evidence of this curvilinearity in the scatterplot of graduation rates versus median SAT scores. After fitting a model assuming a linear relationship (syntax not shown), the plot of the standardized residuals versus the fitted values also suggests that the linearity assumption is not tenable.</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatterplot</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "LEFT: Six-year graduation rate as a function of median SAT score. The loess smoother (blue line) is also displayed. RIGHT: Scatterplot of the standardized residuals versus the fitted values for a model using median SAT scores to predict variation in six-year graduation rates. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "LEFT: Six-year graduation rate as a function of median SAT score. The loess smoother (blue line) is also displayed. RIGHT: Scatterplot of the standardized residuals versus the fitted values for a model using median SAT scores to predict variation in six-year graduation rates. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat, <span class="at">data =</span> mn)</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Check linearity assumptions</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">residual_plots</span>(lm<span class="fl">.1</span>, <span class="at">type =</span> <span class="st">"s"</span>) </span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout plot</span></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a><span class="fu">### Logarithmic Function: Yet Another Non-Linear Function</span></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>One way to model this non-linearity is to fit a model that included a quadratic polynomial effect. Remember that the quadratic function is 'U'-shaped. In our example, the quadratic term was negative, which creates an upside-down 'U'-shape. This negative quadratic function is shown in the left-had side of the figure below.</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>We do not have to use a quadratic function to model curvilinear relationships. We can use any mathematical function that mimics the curvilinear pattern observed in the data.^<span class="co">[</span><span class="ot">So long as we can ultimately write this function as a linear model, namely, $Y_i=\beta_0+\beta_1(x_i) + \epsilon_i$.</span><span class="co">]</span> One mathematical function that is useful for modeling curvilinearity is the logarithmic function. The logarithmic function is shown in the right-hand side of the figure below.</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-quadratic-log</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*."</span></span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-at: "LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*."</span></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>fig_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_01, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quadratic Function"</span>)</span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="fu">log2</span>(x))</span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Logarithmic Function"</span>)</span>
<span id="cb43-115"><a href="#cb43-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-116"><a href="#cb43-116" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a>These two functions have some similarities. They both model non-linear growth (continuous and diminishing growth). However, in the quadratic function, this growth eventually peaks and then is followed by continuous and increasing loss (parabola; the function changes direction). The logarithmic function, on the other hand, does not change direction---it continues to grow, albeit ever diminishing in the amount of growth.^<span class="co">[</span><span class="ot">Mathematically, the instantaneous derivative of the logarithmic function is is always positive, but it approaches 0 for larger values of *x*, while that for the quadratic function eventually becomes negative.</span><span class="co">]</span> </span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a>As you consider different mathematical functions, it is important to consider the substantive knowledge in an area. For example, while empirically both the quadratic polynomial model and the logarithmic model might both suggest reasonable fit to the data, in this context, the logarithmic model might be a more substantively sound model than the quadratic polynomial model. We would probably expect that the effect of SAT on graduation rate would diminish for schools with higher median SAT scores, but that it wouldn't actually change direction. (This would mean that at some value, an increase in SAT would be associated with a lower graduation rate!)</span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting a Logarithmic Function Using `lm()`</span></span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a>The mathematical expression of the logarithmic function is:</span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a>Y = \log(X) </span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a>This implies that, to fit a logarithmic function we need to log-transform the predictor and use that in the <span class="in">`lm()`</span> function. (Note that we do not transform the *Y*-value.) The choice of base for the logarithm is irrelevant statistically, but does impact the interpretation of the slope. To illustrate, we will examine fitting models using base-2, base-10, and base-e. Rather than mutating the log-transformed variables into the data, we will include the log-transformation directly in the <span class="in">`lm()`</span> function.</span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using Base-2 Log-Transformed SAT Scores in the Regression Model</span></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a>To fit the model, we use the <span class="in">`lm()`</span> function and input the log-transformed SAT scores as the predictor.</span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-149"><a href="#cb43-149" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb43-150"><a href="#cb43-150" aria-hidden="true" tabindex="-1"></a>lm.log2 <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat, <span class="at">base =</span> <span class="dv">2</span>), <span class="at">data =</span> mn)</span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a>We can now look at the regression output and interpret the results.</span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log2)</span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a>Examining the model-level output, we see that differences in $\log_2(\mathrm{SAT})$ explain 81.13% of the variation in graduation rates. Since differences in $\log_2(\mathrm{SAT})$ imply that there are differences in the raw SAT scores, we would typically just say that "differences in SAT scores explain 81.13% of the variation in graduation rates."</span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a>Moving to the coefficient-level output,</span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-171"><a href="#cb43-171" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb43-172"><a href="#cb43-172" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.log2)</span>
<span id="cb43-173"><a href="#cb43-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-174"><a href="#cb43-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-175"><a href="#cb43-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-176"><a href="#cb43-176" aria-hidden="true" tabindex="-1"></a>We can write the fitted equation as,</span>
<span id="cb43-177"><a href="#cb43-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-178"><a href="#cb43-178" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-179"><a href="#cb43-179" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 106.4\bigg<span class="co">[</span><span class="ot">\log_2(\mathrm{SAT}_i)\bigg</span><span class="co">]</span></span>
<span id="cb43-180"><a href="#cb43-180" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-181"><a href="#cb43-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-182"><a href="#cb43-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-183"><a href="#cb43-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-184"><a href="#cb43-184" aria-hidden="true" tabindex="-1"></a>We can interpret the coefficients as we always do, recognizing that these interpretation are based on the log-transformed predictor.</span>
<span id="cb43-185"><a href="#cb43-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-186"><a href="#cb43-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept value of $-306.7$ is the predicted average graduation rate for all colleges/universities with a $\log_2(\mathrm{SAT})$ value of 0.</span>
<span id="cb43-187"><a href="#cb43-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The slope value of 106.4 indicates that each one-unit difference in $\log_2(\mathrm{SAT})$ is associated with a 106.4-unit difference in graduation rate, on average.</span>
<span id="cb43-188"><a href="#cb43-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-189"><a href="#cb43-189" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-190"><a href="#cb43-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-191"><a href="#cb43-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-192"><a href="#cb43-192" aria-hidden="true" tabindex="-1"></a><span class="fu">### Better Interpretations: Back-transforming to the Raw Metric</span></span>
<span id="cb43-193"><a href="#cb43-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-194"><a href="#cb43-194" aria-hidden="true" tabindex="-1"></a>While these interpretations are technically correct, it is more helpful to your readers (and more conventional) to interpret any regression results in the raw metric of the variable rather than log-transformed metric. This means we have to *back-transform the interpretations*. To back-transform a logarithm, we use its inverse function; exponentiation.</span>
<span id="cb43-195"><a href="#cb43-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-196"><a href="#cb43-196" aria-hidden="true" tabindex="-1"></a>We interpreted the intercept as, "the predicted average graduation rate for all colleges/universities with a $\log_2(\mathrm{SAT})$ value of 0". To interpret this using the raw metric of our SAT attribute, we have to understand what $\log_2(\mathrm{SAT}) = 0$ is equivalent to in the original SAT variable's scale. Mathematically,</span>
<span id="cb43-197"><a href="#cb43-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-198"><a href="#cb43-198" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-199"><a href="#cb43-199" aria-hidden="true" tabindex="-1"></a>\log_2 (\mathrm{SAT}) = 0 \quad \mathrm{is~equivalent~to} \quad 2^{0} = \mathrm{SAT} <span class="sc">\\</span></span>
<span id="cb43-200"><a href="#cb43-200" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-201"><a href="#cb43-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-202"><a href="#cb43-202" aria-hidden="true" tabindex="-1"></a>In this computation, $\mathrm{SAT}=1$. Thus, rather than using the log-transformed interpretation, we can, instead, interpret the intercept as,</span>
<span id="cb43-203"><a href="#cb43-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-204"><a href="#cb43-204" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The predicted average graduation rate for all colleges/universities with a median SAT value of 1 (which since this is measures in hundreds corresponds to a median SAT of 100) is $-306.7$. Since there are no colleges/universities in our data that have a median SAT value of 1, this is extrapolation.</span></span>
<span id="cb43-205"><a href="#cb43-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-206"><a href="#cb43-206" aria-hidden="true" tabindex="-1"></a>What about the slope? Our interpretation was that "each one-unit difference in $\log_2(\mathrm{SAT})$ is associated with a 106.4-unit difference in graduation rate, on average." Working with the same idea of back-transformation, we need to understand what a one-unit difference in $\log_2(\mathrm{SAT})$ means. Consider four values of $\log_2(\mathrm{SAT})$ that are each one-unit apart:</span>
<span id="cb43-207"><a href="#cb43-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-208"><a href="#cb43-208" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-209"><a href="#cb43-209" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-210"><a href="#cb43-210" aria-hidden="true" tabindex="-1"></a>\log_2(\mathrm{SAT}) &amp;= 1<span class="sc">\\</span></span>
<span id="cb43-211"><a href="#cb43-211" aria-hidden="true" tabindex="-1"></a>\log_2(\mathrm{SAT}) &amp;= 2<span class="sc">\\</span></span>
<span id="cb43-212"><a href="#cb43-212" aria-hidden="true" tabindex="-1"></a>\log_2(\mathrm{SAT}) &amp;= 3<span class="sc">\\</span></span>
<span id="cb43-213"><a href="#cb43-213" aria-hidden="true" tabindex="-1"></a>\log_2(\mathrm{SAT}) &amp;= 4</span>
<span id="cb43-214"><a href="#cb43-214" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-215"><a href="#cb43-215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-216"><a href="#cb43-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-217"><a href="#cb43-217" aria-hidden="true" tabindex="-1"></a>If we back-transform each of these, then we can see how the four values of the raw SAT variable would differ.</span>
<span id="cb43-218"><a href="#cb43-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-219"><a href="#cb43-219" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-220"><a href="#cb43-220" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-221"><a href="#cb43-221" aria-hidden="true" tabindex="-1"></a>\mathrm{SAT} &amp;= 2^1 = 2<span class="sc">\\</span></span>
<span id="cb43-222"><a href="#cb43-222" aria-hidden="true" tabindex="-1"></a>\mathrm{SAT} &amp;= 2^2 = 4<span class="sc">\\</span></span>
<span id="cb43-223"><a href="#cb43-223" aria-hidden="true" tabindex="-1"></a>\mathrm{SAT} &amp;= 2^3 = 8<span class="sc">\\</span></span>
<span id="cb43-224"><a href="#cb43-224" aria-hidden="true" tabindex="-1"></a>\mathrm{SAT} &amp;= 2^4 = 16</span>
<span id="cb43-225"><a href="#cb43-225" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-226"><a href="#cb43-226" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-227"><a href="#cb43-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-228"><a href="#cb43-228" aria-hidden="true" tabindex="-1"></a>When $\log_2(\mathrm{SAT})$ is increased by one-unit, the raw SAT value is doubled. We can use this in our interpretation of slope:</span>
<span id="cb43-229"><a href="#cb43-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-230"><a href="#cb43-230" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; A doubling of the SAT value is associated with a 106.4 percentage point difference in graduation rate, on average.</span></span>
<span id="cb43-231"><a href="#cb43-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-232"><a href="#cb43-232" aria-hidden="true" tabindex="-1"></a>The technical language for doubling is a "two-fold difference". So we would conventionally interpret this as:</span>
<span id="cb43-233"><a href="#cb43-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-234"><a href="#cb43-234" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Each two-fold difference in SAT value is associated with a 106.4 percentage point difference in graduation rate, on average.</span></span>
<span id="cb43-235"><a href="#cb43-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-236"><a href="#cb43-236" aria-hidden="true" tabindex="-1"></a>To understand this further, consider a specific school, say Augsburg. Their measurement on the raw SAT variable is 10.3, and their log-transformed SAT score is 3.36. Using the fitted regression equation (which employs the log-transformed SAT),</span>
<span id="cb43-237"><a href="#cb43-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-240"><a href="#cb43-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-241"><a href="#cb43-241" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">106.4</span> <span class="sc">*</span> <span class="fl">3.36</span></span>
<span id="cb43-242"><a href="#cb43-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-243"><a href="#cb43-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-244"><a href="#cb43-244" aria-hidden="true" tabindex="-1"></a>Augsburg's predicted graduation rate would be 50.8. If we increase the <span class="in">`l2sat`</span> score by 1 to 4.36 (which is equivalent to a raw SAT measurement of 20.6; double 10.3), their predicted graduation rate would be,</span>
<span id="cb43-245"><a href="#cb43-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-248"><a href="#cb43-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-249"><a href="#cb43-249" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">106.4</span> <span class="sc">*</span> <span class="fl">4.36</span></span>
<span id="cb43-250"><a href="#cb43-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-251"><a href="#cb43-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-252"><a href="#cb43-252" aria-hidden="true" tabindex="-1"></a>This is an increase of 106.4 percentage points from the predicted value of 50.8 when the <span class="in">`l2sat`</span> value was 3.36.</span>
<span id="cb43-253"><a href="#cb43-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-254"><a href="#cb43-254" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-255"><a href="#cb43-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-256"><a href="#cb43-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-257"><a href="#cb43-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using Base-10 Log-Transformed SAT Scores in the Regression Model</span></span>
<span id="cb43-258"><a href="#cb43-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-259"><a href="#cb43-259" aria-hidden="true" tabindex="-1"></a>How do things change if we log-transfomr the SAT scores using base-10 rather than base-2?</span>
<span id="cb43-260"><a href="#cb43-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-263"><a href="#cb43-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-264"><a href="#cb43-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb43-265"><a href="#cb43-265" aria-hidden="true" tabindex="-1"></a>lm.log10 <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat, <span class="at">base =</span> <span class="dv">10</span>), <span class="at">data =</span> mn)</span>
<span id="cb43-266"><a href="#cb43-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-267"><a href="#cb43-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb43-268"><a href="#cb43-268" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log10)</span>
<span id="cb43-269"><a href="#cb43-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-270"><a href="#cb43-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-271"><a href="#cb43-271" aria-hidden="true" tabindex="-1"></a>Examining the model-level output, we see that differences in $\log_{10}(\mathrm{SAT})$ explain 81.13% of the variation in graduation rates. Or simply, that differences in SAT scores explain 81.13% of the variation in graduation rates. **These model-level results are the same as when we used the base-2 logarithm.**</span>
<span id="cb43-272"><a href="#cb43-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-275"><a href="#cb43-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-276"><a href="#cb43-276" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb43-277"><a href="#cb43-277" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.log10)</span>
<span id="cb43-278"><a href="#cb43-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-279"><a href="#cb43-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-280"><a href="#cb43-280" aria-hidden="true" tabindex="-1"></a>The linear form of the fitted equation is,</span>
<span id="cb43-281"><a href="#cb43-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-282"><a href="#cb43-282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-283"><a href="#cb43-283" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 353.6\bigg[\log_{10}(\mathrm{SAT}_i)\bigg]</span>
<span id="cb43-284"><a href="#cb43-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-285"><a href="#cb43-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-286"><a href="#cb43-286" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We could also, alternatively, express the fitted equation in its nonlinear form as: --&gt;</span></span>
<span id="cb43-287"><a href="#cb43-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-288"><a href="#cb43-288" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb43-289"><a href="#cb43-289" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- \hat{\mathrm{Graduation~Rate}_i} = \log_{10}\bigg(10^{-306.7} \times \mathrm{SAT}_i^{353.6}\bigg) --&gt;</span></span>
<span id="cb43-290"><a href="#cb43-290" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- $$ --&gt;</span></span>
<span id="cb43-291"><a href="#cb43-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-292"><a href="#cb43-292" aria-hidden="true" tabindex="-1"></a>We can interpret the coefficients using the base-10 logarithm of SAT scores as:</span>
<span id="cb43-293"><a href="#cb43-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-294"><a href="#cb43-294" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept value of $-306.7$ is the predicted average graduation rate for all colleges/universities with a $\log_{10}(\mathrm{SAT})$ value of 0.</span>
<span id="cb43-295"><a href="#cb43-295" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The slope value of 353.6 indicates that each one-unit difference in $\log_{10}(\mathrm{SAT})$ is associated with a 353.6-unit difference in graduation rate, on average.</span>
<span id="cb43-296"><a href="#cb43-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-297"><a href="#cb43-297" aria-hidden="true" tabindex="-1"></a>Comparing these results back to the base-2 results, we see that the interpretation of the intercept is identical to that from the base-2 model. The interpretation of the slope has changed. We can understand why by *back-transforming the coefficient interpretations* so that we are using raw median SAT scores rather than $\log_{10}(\mathrm{SAT})$ scores.</span>
<span id="cb43-298"><a href="#cb43-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-299"><a href="#cb43-299" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predicted average graduation rate for all colleges/universities with a SAT value of 1 (median SAT score = 100) is $-306.7$.</span>
<span id="cb43-300"><a href="#cb43-300" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each *ten-fold* difference in SAT is associated with a 353.6 percentage point difference in graduation rate, on average.</span>
<span id="cb43-301"><a href="#cb43-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-302"><a href="#cb43-302" aria-hidden="true" tabindex="-1"></a>To further think about the effect of SAT, if Augsburg improved its median SAT score ten-fold (i.e., going from a SAT value of 10.3 to a value of 103) we would predict its graduation rate to go up by 353.6 percentage points!</span>
<span id="cb43-303"><a href="#cb43-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-304"><a href="#cb43-304" aria-hidden="true" tabindex="-1"></a>The reason the slope value is different is because in this model we are expressing the change in the graduation rate for ten-fold difference in SAT scores, whereas in the previous model the slope value expressed the change in the graduation rate for two-fold difference in SAT scores. </span>
<span id="cb43-305"><a href="#cb43-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-306"><a href="#cb43-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-307"><a href="#cb43-307" aria-hidden="true" tabindex="-1"></a><span class="fu">### What About the Residual Fit?</span></span>
<span id="cb43-308"><a href="#cb43-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-309"><a href="#cb43-309" aria-hidden="true" tabindex="-1"></a>While most of the results didn't change when we used base-10 rather than base-2, you might be asking whether one of these models fits the data better than the other. To determine that, we need to compare the residuals from these models.</span>
<span id="cb43-310"><a href="#cb43-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-311"><a href="#cb43-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.width=8, fig.height=4, out.width='80%', fig.cap=, class.source = 'fold-hide'}</span></span>
<span id="cb43-312"><a href="#cb43-312" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-resid-compare</span></span>
<span id="cb43-313"><a href="#cb43-313" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Scatterplot of the standardized residuals versus the fitted values for the model fitted using the base-2 log-transformed median SAT values (LEFT) and the base-10 log-transformed median SAT values (RIGHT). In both plots the reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed."</span></span>
<span id="cb43-314"><a href="#cb43-314" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: "Scatterplot of the standardized residuals versus the fitted values for the model fitted using the base-2 log-transformed median SAT values (LEFT) and the base-10 log-transformed median SAT values (RIGHT). In both plots the reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed."</span></span>
<span id="cb43-315"><a href="#cb43-315" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "90%"</span></span>
<span id="cb43-316"><a href="#cb43-316" aria-hidden="true" tabindex="-1"></a><span class="in"># Residual plots for base-2 model</span></span>
<span id="cb43-317"><a href="#cb43-317" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = residual_plots(lm.log2)</span></span>
<span id="cb43-318"><a href="#cb43-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-319"><a href="#cb43-319" aria-hidden="true" tabindex="-1"></a><span class="in"># Residual plots for base-10 model</span></span>
<span id="cb43-320"><a href="#cb43-320" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = residual_plots(lm.log10)</span></span>
<span id="cb43-321"><a href="#cb43-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-322"><a href="#cb43-322" aria-hidden="true" tabindex="-1"></a><span class="in"># Layout</span></span>
<span id="cb43-323"><a href="#cb43-323" aria-hidden="true" tabindex="-1"></a><span class="in">p1 / p2</span></span>
<span id="cb43-324"><a href="#cb43-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-325"><a href="#cb43-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-326"><a href="#cb43-326" aria-hidden="true" tabindex="-1"></a>The residuals fit EXACTLY the same. That suggests that changing the base does NOT improve the fit of the model. Why is this? Let's again use Augsburg as an example. Using the fitted model that employed the base-2 logarithm, we found that Augsburg's predicted graduation rate was,</span>
<span id="cb43-327"><a href="#cb43-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-328"><a href="#cb43-328" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-329"><a href="#cb43-329" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-330"><a href="#cb43-330" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}} &amp;= -306.7 + 106.4\bigg<span class="co">[</span><span class="ot">\log_2(10.3)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-331"><a href="#cb43-331" aria-hidden="true" tabindex="-1"></a>&amp;= -306.7 + 106.4\bigg<span class="co">[</span><span class="ot">3.36\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-332"><a href="#cb43-332" aria-hidden="true" tabindex="-1"></a>&amp;= 50.8</span>
<span id="cb43-333"><a href="#cb43-333" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-334"><a href="#cb43-334" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-335"><a href="#cb43-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-336"><a href="#cb43-336" aria-hidden="true" tabindex="-1"></a>Using the model that employed the base-10 logarithm, Augsburg's predicted graduation rate would be</span>
<span id="cb43-337"><a href="#cb43-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-338"><a href="#cb43-338" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-339"><a href="#cb43-339" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-340"><a href="#cb43-340" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}} &amp;= -306.7 + 353.6\bigg<span class="co">[</span><span class="ot">\log_{10}(10.3)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-341"><a href="#cb43-341" aria-hidden="true" tabindex="-1"></a>&amp;= -306.7 + 353.6\bigg<span class="co">[</span><span class="ot">1.01\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-342"><a href="#cb43-342" aria-hidden="true" tabindex="-1"></a>&amp;= 50.8</span>
<span id="cb43-343"><a href="#cb43-343" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-344"><a href="#cb43-344" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-345"><a href="#cb43-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-346"><a href="#cb43-346" aria-hidden="true" tabindex="-1"></a>Augsburg's predicted graduation rate is *exactly the same* in the two models. This implies that Augsburg's residual would also be the same in the two models. This is true for every college. Because of this, increasing (or decreasing) the base used in the logarithm does not help improve the fit of the model. The fit is exactly the same no matter which base you choose.</span>
<span id="cb43-347"><a href="#cb43-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-348"><a href="#cb43-348" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb43-349"><a href="#cb43-349" aria-hidden="true" tabindex="-1"></a>**PROTIP**</span>
<span id="cb43-350"><a href="#cb43-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-351"><a href="#cb43-351" aria-hidden="true" tabindex="-1"></a>Regardless of base choice, the model-level results (e.g., $R^2$, AICc) will the same. At the coefficient level, the intercept results (*B*, *SE*, *p*-value) will also be the same regardless of base. The only results that change are the results for the log-transformed effect (i.e., the estimate and SE for the slope). This reflects the change in scale and interpretation. However, the inferential results (*t*-value and *p*-value) are the same for both transformations. **Because of this, the choice of base is solely based on interpretation of the slope.** For example, does it make more sense to talk about a *two-fold* difference in the predictor? A *five-fold* difference in the predictor? A *ten-fold* difference in the predictor?</span>
<span id="cb43-352"><a href="#cb43-352" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-353"><a href="#cb43-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-354"><a href="#cb43-354" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-355"><a href="#cb43-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-356"><a href="#cb43-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-357"><a href="#cb43-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Using Base-e Log-Transformed SAT Scores in the Regression Model</span></span>
<span id="cb43-358"><a href="#cb43-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-359"><a href="#cb43-359" aria-hidden="true" tabindex="-1"></a>In our example, neither of the bases we examined is satisfactory in terms of interpreting the effect of median SAT score on graduation rate. Two-fold differences in median SAT scores are very unlikely, to say anything of ten-fold differences. One base that is commonly used for log-transformations because it offers a reasonable interpretation is base-*e*. Below we regress graduation rates on the log-transformed SAT scores, using the natural logarithm.</span>
<span id="cb43-360"><a href="#cb43-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-363"><a href="#cb43-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-364"><a href="#cb43-364" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb43-365"><a href="#cb43-365" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb43-366"><a href="#cb43-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-367"><a href="#cb43-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb43-368"><a href="#cb43-368" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.ln)</span>
<span id="cb43-369"><a href="#cb43-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-370"><a href="#cb43-370" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb43-371"><a href="#cb43-371" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm.ln)</span>
<span id="cb43-372"><a href="#cb43-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-373"><a href="#cb43-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-374"><a href="#cb43-374" aria-hidden="true" tabindex="-1"></a>As with any base, using base-*e* results in the same model-level evidence ($R^2=.811$, AIC values). The fitted equation is,</span>
<span id="cb43-375"><a href="#cb43-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-376"><a href="#cb43-376" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-377"><a href="#cb43-377" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} = -306.7 + 153.6\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span></span>
<span id="cb43-378"><a href="#cb43-378" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-379"><a href="#cb43-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-380"><a href="#cb43-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-381"><a href="#cb43-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-382"><a href="#cb43-382" aria-hidden="true" tabindex="-1"></a>The intercept has the same coefficient ($\hat\beta_0=-306.7$), SE, *t*-value, and *p*-value as the intercept from the models using base-2 and base-10 log-transformations of SAT. (This is, again, because $2^0=10^0=e^0=1$.) And, although the coefficient and SE for the effect of SAT is again different (a one-unit change in the three different log-scales does not correspond to the same amount of change in raw SAT for the three models).</span>
<span id="cb43-383"><a href="#cb43-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-384"><a href="#cb43-384" aria-hidden="true" tabindex="-1"></a>So how can we interpret the model's coefficients?</span>
<span id="cb43-385"><a href="#cb43-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-386"><a href="#cb43-386" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept can be interpreted exactly the same as in the previous models in which we used base-2 or base-10; namely that the predicted average graduation rate for colleges/universities with a SAT value of one (median SAT score of 100) is $-306.7$.</span>
<span id="cb43-387"><a href="#cb43-387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpreting the slope, we could say that an *e*-fold difference in SAT value is associated with a 153.6-unit difference in graduation rates, on average.</span>
<span id="cb43-388"><a href="#cb43-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-389"><a href="#cb43-389" aria-hidden="true" tabindex="-1"></a>We can aslo verify that this model's residuals are identical to the other log-transformed models' residuals.</span>
<span id="cb43-390"><a href="#cb43-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-393"><a href="#cb43-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-394"><a href="#cb43-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-residuals-ln</span></span>
<span id="cb43-395"><a href="#cb43-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the standardized residuals versus the fitted values for a model fitted using the natural log-transformed median SAT scores. The reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed."</span></span>
<span id="cb43-396"><a href="#cb43-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the standardized residuals versus the fitted values for a model fitted using the natural log-transformed median SAT scores. The reference line of Y=0 is displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) showing the empirical relationship is also displayed."</span></span>
<span id="cb43-397"><a href="#cb43-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb43-398"><a href="#cb43-398" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb43-399"><a href="#cb43-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb43-400"><a href="#cb43-400" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residuals for base-2 log-transformed SAT</span></span>
<span id="cb43-401"><a href="#cb43-401" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.ln)</span>
<span id="cb43-402"><a href="#cb43-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-403"><a href="#cb43-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-404"><a href="#cb43-404" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-405"><a href="#cb43-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-406"><a href="#cb43-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-407"><a href="#cb43-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation Using Percent Change</span></span>
<span id="cb43-408"><a href="#cb43-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-409"><a href="#cb43-409" aria-hidden="true" tabindex="-1"></a>Consider three schools, each having a median SAT values that differs by 1%; say these schools have median SAT values of 10, 10.1, 10.201. Using the fitted equation, we can compute the predicted graduation rate for each of these hypothetical schools:</span>
<span id="cb43-410"><a href="#cb43-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-411"><a href="#cb43-411" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-412"><a href="#cb43-412" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}} = -306.7 + 153.6 \bigg<span class="co">[</span><span class="ot">\ln (\mathrm{SAT})\bigg</span><span class="co">]</span></span>
<span id="cb43-413"><a href="#cb43-413" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-414"><a href="#cb43-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-415"><a href="#cb43-415" aria-hidden="true" tabindex="-1"></a>The SAT values and predicted graduation rates for these schools are given below:</span>
<span id="cb43-416"><a href="#cb43-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-419"><a href="#cb43-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-420"><a href="#cb43-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb43-421"><a href="#cb43-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-pred-grad</span></span>
<span id="cb43-422"><a href="#cb43-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Median SAT Values and Graduation Rates for Three Hypothetical Schools that have Median SAT Values that Differ by One Percent."</span></span>
<span id="cb43-423"><a href="#cb43-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb43-424"><a href="#cb43-424" aria-hidden="true" tabindex="-1"></a>tab_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-425"><a href="#cb43-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">sat =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">10.1</span>, <span class="fl">10.201</span>)</span>
<span id="cb43-426"><a href="#cb43-426" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-427"><a href="#cb43-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-428"><a href="#cb43-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">grad =</span> <span class="fu">predict</span>(lm.ln, <span class="at">newdata =</span> .)</span>
<span id="cb43-429"><a href="#cb43-429" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-430"><a href="#cb43-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-431"><a href="#cb43-431" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb43-432"><a href="#cb43-432" aria-hidden="true" tabindex="-1"></a>tab_05 <span class="sc">|&gt;</span></span>
<span id="cb43-433"><a href="#cb43-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb43-434"><a href="#cb43-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb43-435"><a href="#cb43-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(sat, grad),</span>
<span id="cb43-436"><a href="#cb43-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb43-437"><a href="#cb43-437" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-438"><a href="#cb43-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb43-439"><a href="#cb43-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">sat =</span> <span class="fu">md</span>(<span class="st">"*SAT*"</span>),</span>
<span id="cb43-440"><a href="#cb43-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">grad =</span> <span class="fu">md</span>(<span class="st">"Predicted Graduation Rate"</span>)</span>
<span id="cb43-441"><a href="#cb43-441" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb43-442"><a href="#cb43-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb43-443"><a href="#cb43-443" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">40</span>)</span>
<span id="cb43-444"><a href="#cb43-444" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-445"><a href="#cb43-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-446"><a href="#cb43-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-447"><a href="#cb43-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-448"><a href="#cb43-448" aria-hidden="true" tabindex="-1"></a>The difference between each subsequent predicted graduation rate is 1.53.</span>
<span id="cb43-449"><a href="#cb43-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-452"><a href="#cb43-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-453"><a href="#cb43-453" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between predicted value for 10.1 and 10</span></span>
<span id="cb43-454"><a href="#cb43-454" aria-hidden="true" tabindex="-1"></a><span class="fl">48.4058</span> <span class="sc">-</span> <span class="fl">46.8778</span></span>
<span id="cb43-455"><a href="#cb43-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-456"><a href="#cb43-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Difference between predicted value for 10.201 and 10.1</span></span>
<span id="cb43-457"><a href="#cb43-457" aria-hidden="true" tabindex="-1"></a><span class="fl">49.9338</span> <span class="sc">-</span> <span class="fl">48.4058</span></span>
<span id="cb43-458"><a href="#cb43-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-459"><a href="#cb43-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-460"><a href="#cb43-460" aria-hidden="true" tabindex="-1"></a>In other words, schools that have a SAT value that differ by 1%, have predicted graduation rates that differ by 1.53, on average.</span>
<span id="cb43-461"><a href="#cb43-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-462"><a href="#cb43-462" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb43-463"><a href="#cb43-463" aria-hidden="true" tabindex="-1"></a>**WARNING**</span>
<span id="cb43-464"><a href="#cb43-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-465"><a href="#cb43-465" aria-hidden="true" tabindex="-1"></a>Be very careful when you are using "percent difference" and "percentage points difference". These are two very different things. For example, increasing a graduation rate from 50% to 60% represents a difference of 10 percentage points, but it is a 20% increase!</span>
<span id="cb43-466"><a href="#cb43-466" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-467"><a href="#cb43-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-468"><a href="#cb43-468" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-469"><a href="#cb43-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-470"><a href="#cb43-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-471"><a href="#cb43-471" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mathematically Calculating the Size of the Effect</span></span>
<span id="cb43-472"><a href="#cb43-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-473"><a href="#cb43-473" aria-hidden="true" tabindex="-1"></a>To understand how we can directly compute the effect for a 1% change in *X*, consider the predicted values for two *x*-values that differ by 1%, if we use symbolic notation:</span>
<span id="cb43-474"><a href="#cb43-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-475"><a href="#cb43-475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-476"><a href="#cb43-476" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-477"><a href="#cb43-477" aria-hidden="true" tabindex="-1"></a>\hat{y}_1 &amp;= \hat\beta_0 + \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(x)\right</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-478"><a href="#cb43-478" aria-hidden="true" tabindex="-1"></a>\hat{y}_2 &amp;= \hat\beta_0 + \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01x)\right</span><span class="co">]</span></span>
<span id="cb43-479"><a href="#cb43-479" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-480"><a href="#cb43-480" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-481"><a href="#cb43-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-482"><a href="#cb43-482" aria-hidden="true" tabindex="-1"></a>The difference in their predicted values is:</span>
<span id="cb43-483"><a href="#cb43-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-484"><a href="#cb43-484" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-485"><a href="#cb43-485" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-486"><a href="#cb43-486" aria-hidden="true" tabindex="-1"></a>\hat{y}_2 - \hat{y}_1 &amp;= \hat\beta_0 + \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01x)\right</span><span class="co">]</span> - \left(\hat\beta_0 + \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(x)\right</span><span class="co">]</span>\right) <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-487"><a href="#cb43-487" aria-hidden="true" tabindex="-1"></a>&amp;=\hat\beta_0 + \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01x)\right</span><span class="co">]</span> - \hat\beta_0 - \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(x)\right</span><span class="co">]</span> <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-488"><a href="#cb43-488" aria-hidden="true" tabindex="-1"></a>&amp;=\hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01x)\right</span><span class="co">]</span> - \hat\beta_1\left<span class="co">[</span><span class="ot">\ln(x)\right</span><span class="co">]</span> <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-489"><a href="#cb43-489" aria-hidden="true" tabindex="-1"></a>&amp;=\hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01x) - \ln(x)\right</span><span class="co">]</span><span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-490"><a href="#cb43-490" aria-hidden="true" tabindex="-1"></a>&amp;=\hat\beta_1\left<span class="co">[</span><span class="ot">\ln(\frac{1.01x}{1x})\right</span><span class="co">]</span></span>
<span id="cb43-491"><a href="#cb43-491" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-492"><a href="#cb43-492" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-493"><a href="#cb43-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-494"><a href="#cb43-494" aria-hidden="true" tabindex="-1"></a>If we substitute in any value for $x$, we can now directly compute this constant difference. Note that a convenient value for *X* is 1. Then this reduces to:</span>
<span id="cb43-495"><a href="#cb43-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-496"><a href="#cb43-496" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-497"><a href="#cb43-497" aria-hidden="true" tabindex="-1"></a>\hat\beta_1\left<span class="co">[</span><span class="ot">\ln(1.01)\right</span><span class="co">]</span></span>
<span id="cb43-498"><a href="#cb43-498" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-499"><a href="#cb43-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-500"><a href="#cb43-500" aria-hidden="true" tabindex="-1"></a>So now, we can interpret this as: a 1% difference in *X* is associated with a $\hat\beta_1\left[\ln(1.01)\right]$-unit difference in *Y*, on average.</span>
<span id="cb43-501"><a href="#cb43-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-502"><a href="#cb43-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-503"><a href="#cb43-503" aria-hidden="true" tabindex="-1"></a>In our model, we can compute this difference using the fitted coefficient $\hat\beta_1=153.6$ as</span>
<span id="cb43-504"><a href="#cb43-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-505"><a href="#cb43-505" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-506"><a href="#cb43-506" aria-hidden="true" tabindex="-1"></a>153.6\left<span class="co">[</span><span class="ot">\ln(1.01)\right</span><span class="co">]</span> = 1.528371</span>
<span id="cb43-507"><a href="#cb43-507" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-508"><a href="#cb43-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-509"><a href="#cb43-509" aria-hidden="true" tabindex="-1"></a>The same computation using R is</span>
<span id="cb43-510"><a href="#cb43-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-513"><a href="#cb43-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-514"><a href="#cb43-514" aria-hidden="true" tabindex="-1"></a><span class="fl">153.6</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fl">1.01</span>)</span>
<span id="cb43-515"><a href="#cb43-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-516"><a href="#cb43-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-517"><a href="#cb43-517" aria-hidden="true" tabindex="-1"></a>This gives you the constant difference exactly. So you can interpret the effect of SAT as, each 1% difference in SAT score is associated with a difference in graduation rates of 1.53 percentage points, on average.</span>
<span id="cb43-518"><a href="#cb43-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-519"><a href="#cb43-519" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-520"><a href="#cb43-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-521"><a href="#cb43-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-522"><a href="#cb43-522" aria-hidden="true" tabindex="-1"></a><span class="fu">### Approximating the Size of the Effect</span></span>
<span id="cb43-523"><a href="#cb43-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-524"><a href="#cb43-524" aria-hidden="true" tabindex="-1"></a>We can get an approximation for the size of the effect by using the mathematical shortcut of:</span>
<span id="cb43-525"><a href="#cb43-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-526"><a href="#cb43-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-527"><a href="#cb43-527" aria-hidden="true" tabindex="-1"></a>\mathrm{Effect} \approx \frac{\hat\beta_1}{100}</span>
<span id="cb43-528"><a href="#cb43-528" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-529"><a href="#cb43-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-530"><a href="#cb43-530" aria-hidden="true" tabindex="-1"></a>Using our fitted results, we could approximate the size of the effect as,</span>
<span id="cb43-531"><a href="#cb43-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-532"><a href="#cb43-532" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-533"><a href="#cb43-533" aria-hidden="true" tabindex="-1"></a>\frac{153.6}{100} = 1.536</span>
<span id="cb43-534"><a href="#cb43-534" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-535"><a href="#cb43-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-536"><a href="#cb43-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-537"><a href="#cb43-537" aria-hidden="true" tabindex="-1"></a>We could then interpret the effect of SAT by saying a 1% difference in median SAT score is associated with a 1.53 percentage point difference in predicted graduation rate, on average.</span>
<span id="cb43-538"><a href="#cb43-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-539"><a href="#cb43-539" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-540"><a href="#cb43-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-541"><a href="#cb43-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-542"><a href="#cb43-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-543"><a href="#cb43-543" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting the Fitted Curve</span></span>
<span id="cb43-544"><a href="#cb43-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-545"><a href="#cb43-545" aria-hidden="true" tabindex="-1"></a>To aid interpretation of the effect of median SAT score on graduation rate, we can plot the fitted curve. Recall that our fitted equation was:</span>
<span id="cb43-546"><a href="#cb43-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-547"><a href="#cb43-547" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-548"><a href="#cb43-548" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}} = -306.7 + 153.6 \bigg<span class="co">[</span><span class="ot">\ln (\mathrm{SAT})\bigg</span><span class="co">]</span></span>
<span id="cb43-549"><a href="#cb43-549" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-550"><a href="#cb43-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-551"><a href="#cb43-551" aria-hidden="true" tabindex="-1"></a>We can implement this into the <span class="in">`geom_function()`</span> layer of our <span class="in">`ggplot()`</span> syntax.</span>
<span id="cb43-552"><a href="#cb43-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-553"><a href="#cb43-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-556"><a href="#cb43-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-557"><a href="#cb43-557" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-model-01</span></span>
<span id="cb43-558"><a href="#cb43-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the predicted graduation rate as a function of median SAT score. The non-linearity in the plot indicates that there is a diminishing positive effect of SAT on graduation rates."</span></span>
<span id="cb43-559"><a href="#cb43-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the predicted graduation rate as a function of median SAT score. The non-linearity in the plot indicates that there is a diminishing positive effect of SAT on graduation rates."</span></span>
<span id="cb43-560"><a href="#cb43-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb43-561"><a href="#cb43-561" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb43-562"><a href="#cb43-562" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb43-563"><a href="#cb43-563" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb43-564"><a href="#cb43-564" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb43-565"><a href="#cb43-565" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">306.7</span> <span class="sc">+</span> <span class="fl">153.6</span><span class="sc">*</span><span class="fu">log</span>(x)}</span>
<span id="cb43-566"><a href="#cb43-566" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb43-567"><a href="#cb43-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb43-568"><a href="#cb43-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb43-569"><a href="#cb43-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span>
<span id="cb43-570"><a href="#cb43-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-571"><a href="#cb43-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-572"><a href="#cb43-572" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-573"><a href="#cb43-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-574"><a href="#cb43-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-575"><a href="#cb43-575" aria-hidden="true" tabindex="-1"></a>:::mathnote</span>
<span id="cb43-576"><a href="#cb43-576" aria-hidden="true" tabindex="-1"></a><span class="fu">### Alternative Form of the Fitted Equation</span></span>
<span id="cb43-577"><a href="#cb43-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-578"><a href="#cb43-578" aria-hidden="true" tabindex="-1"></a>The fitted equation expresses graduation rates as a function of log-transformed median SAT scores. Using the natural logarithm, the fitted equation is:</span>
<span id="cb43-579"><a href="#cb43-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-580"><a href="#cb43-580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-581"><a href="#cb43-581" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = \hat\beta_0 + \hat\beta_1\bigg<span class="co">[</span><span class="ot">\ln(X_i)\bigg</span><span class="co">]</span></span>
<span id="cb43-582"><a href="#cb43-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-583"><a href="#cb43-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-584"><a href="#cb43-584" aria-hidden="true" tabindex="-1"></a>Now we will work through the algebra to relate $\hat{Y}_i$ to $X_i$. Because there is a log of *X* we need to exponentiate both sides of the equation to get back to the raw X.</span>
<span id="cb43-585"><a href="#cb43-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-586"><a href="#cb43-586" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-587"><a href="#cb43-587" aria-hidden="true" tabindex="-1"></a>e^{\hat{Y}_i} = e^{\hat\beta_0 + \hat\beta_1\bigg<span class="co">[</span><span class="ot">\ln(X_i)\bigg</span><span class="co">]</span>}</span>
<span id="cb43-588"><a href="#cb43-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-589"><a href="#cb43-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-590"><a href="#cb43-590" aria-hidden="true" tabindex="-1"></a>Then we can use the algebraic rules of exponents and logarithms to re-express this equation.</span>
<span id="cb43-591"><a href="#cb43-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-592"><a href="#cb43-592" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-593"><a href="#cb43-593" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-594"><a href="#cb43-594" aria-hidden="true" tabindex="-1"></a>e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times e^{\hat\beta_1\bigg<span class="co">[</span><span class="ot">\ln(X_i)\bigg</span><span class="co">]</span>} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-595"><a href="#cb43-595" aria-hidden="true" tabindex="-1"></a>e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times \bigg<span class="co">[</span><span class="ot">e^{\ln(X_i)}\bigg</span><span class="co">]</span>^{\hat\beta_1} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb43-596"><a href="#cb43-596" aria-hidden="true" tabindex="-1"></a>e^{\hat{Y}_i} &amp;= e^{\hat\beta_0} \times X_i^{\hat\beta_1}</span>
<span id="cb43-597"><a href="#cb43-597" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-598"><a href="#cb43-598" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-599"><a href="#cb43-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-600"><a href="#cb43-600" aria-hidden="true" tabindex="-1"></a>Now the only problem is that the left-hand side is $2^{\hat{Y}_i}$ and not $Y_i$. To fix this we take the natural logarithm of both sides of the equation.</span>
<span id="cb43-601"><a href="#cb43-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-602"><a href="#cb43-602" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-603"><a href="#cb43-603" aria-hidden="true" tabindex="-1"></a>\ln\bigg(e^{\hat{Y}_i}\bigg) = \ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg)</span>
<span id="cb43-604"><a href="#cb43-604" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-605"><a href="#cb43-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-606"><a href="#cb43-606" aria-hidden="true" tabindex="-1"></a>This gives us an expression of the curve that relates the outcome to the predictor. Namely,</span>
<span id="cb43-607"><a href="#cb43-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-608"><a href="#cb43-608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-609"><a href="#cb43-609" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = \ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg)</span>
<span id="cb43-610"><a href="#cb43-610" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-611"><a href="#cb43-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-612"><a href="#cb43-612" aria-hidden="true" tabindex="-1"></a>Notice that the right-hand side of this expression is a log function; it has the general form of $Y=\log($<span class="in">`r emo::ji("giraffe")`</span>$)$.^<span class="co">[</span><span class="ot">Here `r emo::ji("giraffe")` is simply a placeholder for the expression $2^{\hat\beta_0} \times X_i^{\hat\beta_1}$.</span><span class="co">]</span> Remember that this is the continuous decay function we were interested in using to model the curvilinearity shown in the data. The important thing is that this non-linear decay function is mathematically the same as using a the log-transformed predictor to model the outcome with linear model.</span>
<span id="cb43-613"><a href="#cb43-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-614"><a href="#cb43-614" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-615"><a href="#cb43-615" aria-hidden="true" tabindex="-1"></a>Y_i=\ln\bigg(e^{\hat\beta_0} \times X_i^{\hat\beta_1}\bigg) ~~\equiv~~ Y_i =\beta_0 + \beta_1\bigg<span class="co">[</span><span class="ot">\ln(X_i)\bigg</span><span class="co">]</span></span>
<span id="cb43-616"><a href="#cb43-616" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-617"><a href="#cb43-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-618"><a href="#cb43-618" aria-hidden="true" tabindex="-1"></a>Practically speaking, this means we can model non-linearity using a linear model. Which means we can use the <span class="in">`lm()`</span> function and all the other ideas you have learned about linear models (e.g., including covariates, adding interaction effects, assumption checking).</span>
<span id="cb43-619"><a href="#cb43-619" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-620"><a href="#cb43-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-621"><a href="#cb43-621" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-622"><a href="#cb43-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-623"><a href="#cb43-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-624"><a href="#cb43-624" aria-hidden="true" tabindex="-1"></a><span class="fu">## Polynomial Effects vs. Log-Transformations</span></span>
<span id="cb43-625"><a href="#cb43-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-626"><a href="#cb43-626" aria-hidden="true" tabindex="-1"></a>The inclusion of polynomial effects and the use of a log-transformation was to model the nonlinearity observed in the relationship between SAT scores and graduation rates. Both methods were successful in this endeavor. While either method could be used in practice to model nonlinearity, there are some considerations when making the choice of which may be more appropriate for a given modeling situation.</span>
<span id="cb43-627"><a href="#cb43-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-628"><a href="#cb43-628" aria-hidden="true" tabindex="-1"></a>The first consideration is one of substantive theory. The plot below shows the mathematical function for a log-transformed *X* (solid, black line) and for a quadratic polynomial of *X* (dashed, red line).</span>
<span id="cb43-629"><a href="#cb43-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-632"><a href="#cb43-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-633"><a href="#cb43-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-quad-02</span></span>
<span id="cb43-634"><a href="#cb43-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparison of the quadratic polynomial (blue, dashed line) and logarithmic (red, solid line) functions of *X*."</span></span>
<span id="cb43-635"><a href="#cb43-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Comparison of the quadratic polynomial (blue, dashed line) and logarithmic (red, solid line) functions of *X*."</span></span>
<span id="cb43-636"><a href="#cb43-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb43-637"><a href="#cb43-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb43-638"><a href="#cb43-638" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.01</span>))</span>
<span id="cb43-639"><a href="#cb43-639" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>y <span class="ot">=</span> <span class="fu">log</span>(new<span class="sc">$</span>x)</span>
<span id="cb43-640"><a href="#cb43-640" aria-hidden="true" tabindex="-1"></a>new<span class="sc">$</span>quad <span class="ot">=</span>  <span class="sc">-</span><span class="fl">0.21717</span> <span class="sc">+</span> <span class="fl">0.48782</span><span class="sc">*</span>new<span class="sc">$</span>x  <span class="sc">-</span> <span class="fl">0.02453</span><span class="sc">*</span>new<span class="sc">$</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb43-641"><a href="#cb43-641" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">data =</span> new, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"#ea5975"</span>)</span>
<span id="cb43-642"><a href="#cb43-642" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(quad <span class="sc">~</span> x, <span class="at">data =</span> new, <span class="at">col =</span> <span class="st">"#6d92ee"</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb43-643"><a href="#cb43-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-644"><a href="#cb43-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-645"><a href="#cb43-645" aria-hidden="true" tabindex="-1"></a>Both functions are nonlinear, however the polynomial function changes direction. For low *x*-values, the function has a large positive effect. This effect diminishes as the values of *X* gets bigger, and around $x=9$ the effect is zero. For larger values of *X*, the effect is actually negative. For the logarithmic function, the effect is always positive, but it diminishes as *X* gets larger. (Functions that constantly increase, or constantly decrease, are referred to as *monotonic functions*.) Theoretically, these are very different ideas, and if substantive literature suggests one or the other, you should probably acknowledge that in the underlying statistical model that is fitted.</span>
<span id="cb43-646"><a href="#cb43-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-647"><a href="#cb43-647" aria-hidden="true" tabindex="-1"></a>Empirically, the two functions are very similar especially within certain ranges of *X*. For example, although the predictions from these models would be quite different for really high values of *X*, if we only had data from the range of 2 to 8 ($2\leq X \leq 8$) both functions would produce similar residuals. In this case, the residuals would likely not suggest better fit for either of the two models. In this case, it might be prudent to think about [Occam's Razor](https://en.wikipedia.org/wiki/Occam%27s_razor)---if two competing models produce similar predictions, adopt the simpler model. Between these two functions, the **log-transformed model is simpler**; it has one predictor compared to the two predictors in the quadratic model. The mathematical models make this clear:</span>
<span id="cb43-648"><a href="#cb43-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-649"><a href="#cb43-649" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-650"><a href="#cb43-650" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-651"><a href="#cb43-651" aria-hidden="true" tabindex="-1"></a>\mathbf{Quadratic~Polynomial:~}Y_i &amp;= \beta_0 + \beta_1(X_i) + \beta_2(X_i^2) +\epsilon_i <span class="sc">\\</span></span>
<span id="cb43-652"><a href="#cb43-652" aria-hidden="true" tabindex="-1"></a>\mathbf{Log\mbox{-}Transform:~}Y_i &amp;= \beta_0 + \beta_1\bigg<span class="co">[</span><span class="ot">\ln(X_i)\bigg</span><span class="co">]</span> + \epsilon_i</span>
<span id="cb43-653"><a href="#cb43-653" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-654"><a href="#cb43-654" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-655"><a href="#cb43-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-656"><a href="#cb43-656" aria-hidden="true" tabindex="-1"></a>In the polynomial model, we need to estimate four parameters: an intercept, a slope for the linear term of *X*, a slope for the quadratic term of *X*, and a residual variance term. (Remember, the quadratic polynomial model is an interaction model.) While the log model only requires us to estimate three parameters ($\hat\beta_0$, $\hat\beta_1$, and $\hat\sigma^2_{\epsilon}$). If there is no theory to guide your model's functional form, and the residuals from the polynomial and log-transformed models seem to fit equally well, then the log-transformed model saves you a degree of freedom, and better achieves the goal of parsimony.</span>
<span id="cb43-657"><a href="#cb43-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-658"><a href="#cb43-658" aria-hidden="true" tabindex="-1"></a>From the two models, it is also possible to see that the these are not nested models; by setting one (or more) of the effects in either model to zero, we do not end up with the other model. This means we CANNOT use the likelihood ratio test to compare whether the quadratic model or the logarithmic model is more appropriate. However, we could use information criteria to choose from among these models since they are based on the same data and have the same outcome.</span>
<span id="cb43-659"><a href="#cb43-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-662"><a href="#cb43-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-663"><a href="#cb43-663" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb43-664"><a href="#cb43-664" aria-hidden="true" tabindex="-1"></a>lm.quad <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> sat <span class="sc">+</span> <span class="fu">I</span>(sat <span class="sc">^</span> <span class="dv">2</span>), <span class="at">data =</span> mn)</span>
<span id="cb43-665"><a href="#cb43-665" aria-hidden="true" tabindex="-1"></a>lm.log <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb43-666"><a href="#cb43-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-667"><a href="#cb43-667" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb43-668"><a href="#cb43-668" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb43-669"><a href="#cb43-669" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.quad, lm.log),</span>
<span id="cb43-670"><a href="#cb43-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Quadratic polynomial"</span>, <span class="st">"Log-transformed SAT"</span>)</span>
<span id="cb43-671"><a href="#cb43-671" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-672"><a href="#cb43-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-673"><a href="#cb43-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-674"><a href="#cb43-674" aria-hidden="true" tabindex="-1"></a>Here the quadratic model seems more empirically supported, but there is a fair amount of support for the log-model as well. Given this evidence, we probably cannot discern which model is better. (There is a fair amount of model selection uncertainty.^<span class="co">[</span><span class="ot">In order to determine this we would need more data at higher values of SAT to determine if the graduation rate gets lower or essentially planes off. The lack of data in this range is why we have this model selection uncertainty.</span><span class="co">]</span>)</span>
<span id="cb43-675"><a href="#cb43-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-676"><a href="#cb43-676" aria-hidden="true" tabindex="-1"></a>As with all decisions from statistical evidence, you must also rely on substantive knowledge and an evaluation of the residuals. Substantively, the quadratic model is less defensible, since it seems unlikely that we would see the graduation rate decreasing for institutions with high SAT scores. It is more likely that the effect of SAT score has less and less impact on graduation rates as it gets larger. In this scenario, the substantive knowledge points to the log model rather than the quadratic model.</span>
<span id="cb43-677"><a href="#cb43-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-678"><a href="#cb43-678" aria-hidden="true" tabindex="-1"></a>We can also examine the residuals for the two models:</span>
<span id="cb43-679"><a href="#cb43-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-680"><a href="#cb43-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb43-681"><a href="#cb43-681" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-resid-compare-02</span></span>
<span id="cb43-682"><a href="#cb43-682" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Residual plots for the log model (TOP) and quadratic model (BOTTOM)."</span></span>
<span id="cb43-683"><a href="#cb43-683" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-alt: "Residual plots for the log model (TOP) and quadratic model (BOTTOM)."</span></span>
<span id="cb43-684"><a href="#cb43-684" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb43-685"><a href="#cb43-685" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 8</span></span>
<span id="cb43-686"><a href="#cb43-686" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "80%"</span></span>
<span id="cb43-687"><a href="#cb43-687" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb43-688"><a href="#cb43-688" aria-hidden="true" tabindex="-1"></a><span class="in"># Evaluate residuals</span></span>
<span id="cb43-689"><a href="#cb43-689" aria-hidden="true" tabindex="-1"></a><span class="in">p1 = residual_plots(lm.log)</span></span>
<span id="cb43-690"><a href="#cb43-690" aria-hidden="true" tabindex="-1"></a><span class="in">p2 = residual_plots(lm.quad)</span></span>
<span id="cb43-691"><a href="#cb43-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-692"><a href="#cb43-692" aria-hidden="true" tabindex="-1"></a><span class="in"># Layout</span></span>
<span id="cb43-693"><a href="#cb43-693" aria-hidden="true" tabindex="-1"></a><span class="in">p1 / p2</span></span>
<span id="cb43-694"><a href="#cb43-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-695"><a href="#cb43-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-696"><a href="#cb43-696" aria-hidden="true" tabindex="-1"></a>Both models seem tenable based on the residual fit to the assumptions. Given this, the substantive argument, and the parsimony argument (the log model is simpler), I would likely adopt the log model over the quadratic model. You could also make this decision later, after adding other covariates and re-checking the model evidence and residuals for the updated models.</span>
<span id="cb43-697"><a href="#cb43-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-698"><a href="#cb43-698" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-699"><a href="#cb43-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-700"><a href="#cb43-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-701"><a href="#cb43-701" aria-hidden="true" tabindex="-1"></a><span class="fu">## Including Covariates</span></span>
<span id="cb43-702"><a href="#cb43-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-703"><a href="#cb43-703" aria-hidden="true" tabindex="-1"></a>Once we have settled on the functional form for the SAT predictor, we can also include covariates in the model. Below we examine the nonlinear effect of SAT on graduation controlling for differences in sector. To do this, we include a main effect of sector (<span class="in">`public`</span>) in the model along with the natural log-transformed median SAT scores.</span>
<span id="cb43-704"><a href="#cb43-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-707"><a href="#cb43-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-708"><a href="#cb43-708" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb43-709"><a href="#cb43-709" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> public <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb43-710"><a href="#cb43-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-711"><a href="#cb43-711" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb43-712"><a href="#cb43-712" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.2</span>)</span>
<span id="cb43-713"><a href="#cb43-713" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-714"><a href="#cb43-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-715"><a href="#cb43-715" aria-hidden="true" tabindex="-1"></a>The model explains 86.6% of the variation in graduation rates.</span>
<span id="cb43-716"><a href="#cb43-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-719"><a href="#cb43-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-720"><a href="#cb43-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb43-721"><a href="#cb43-721" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.2</span>)</span>
<span id="cb43-722"><a href="#cb43-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-723"><a href="#cb43-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-724"><a href="#cb43-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-725"><a href="#cb43-725" aria-hidden="true" tabindex="-1"></a>The linear form of the fitted equation is,</span>
<span id="cb43-726"><a href="#cb43-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-727"><a href="#cb43-727" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-728"><a href="#cb43-728" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} = -286.1 - 8.5(\mathrm{Public}_i) + 146.0\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span></span>
<span id="cb43-729"><a href="#cb43-729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-730"><a href="#cb43-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-731"><a href="#cb43-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-732"><a href="#cb43-732" aria-hidden="true" tabindex="-1"></a>Interpreting each of the coefficients using the raw (back-transformed) metric of median SAT value:</span>
<span id="cb43-733"><a href="#cb43-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-734"><a href="#cb43-734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept value of $-286.1$ is the predicted average graduation rate for all *public* colleges/universities with a SAT value of 1 (extrapolation).</span>
<span id="cb43-735"><a href="#cb43-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Public schools have a predicted graduation rate that is 8.5 percentage points lower, on average, than private schools controlling for differences in median SAT scores.</span>
<span id="cb43-736"><a href="#cb43-736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each 1% difference in median SAT value is associated with a 1.46 percentage point difference in predicted graduation rate, on average, after controlling for differences in sector.</span>
<span id="cb43-737"><a href="#cb43-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-738"><a href="#cb43-738" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-739"><a href="#cb43-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-740"><a href="#cb43-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-741"><a href="#cb43-741" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot of the Fitted Equation</span></span>
<span id="cb43-742"><a href="#cb43-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-743"><a href="#cb43-743" aria-hidden="true" tabindex="-1"></a>To further help interpret these effects, we can plot the curves resulting from this fitted equation. Now we will have two curves one for public schools and one for private schools. To determine the exact equations for these curves, we will substitute either 0 (for private schools) or 1 (for public schools) into the fitted equation for the <span class="in">`public`</span> variable.</span>
<span id="cb43-744"><a href="#cb43-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-745"><a href="#cb43-745" aria-hidden="true" tabindex="-1"></a>**Private**</span>
<span id="cb43-746"><a href="#cb43-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-747"><a href="#cb43-747" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-748"><a href="#cb43-748" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-749"><a href="#cb43-749" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} &amp;= -286.1 - 8.5(0) + 146.0\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-750"><a href="#cb43-750" aria-hidden="true" tabindex="-1"></a>&amp;= -286.1 + 146.0\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-751"><a href="#cb43-751" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-752"><a href="#cb43-752" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-753"><a href="#cb43-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-754"><a href="#cb43-754" aria-hidden="true" tabindex="-1"></a>**Public**</span>
<span id="cb43-755"><a href="#cb43-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-756"><a href="#cb43-756" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-757"><a href="#cb43-757" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-758"><a href="#cb43-758" aria-hidden="true" tabindex="-1"></a>\hat{\mathrm{Graduation~Rate}_i} &amp;= -286.1 - 8.5(1) + 146.0\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-759"><a href="#cb43-759" aria-hidden="true" tabindex="-1"></a>&amp;= -294.6 + 146.0\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> <span class="sc">\\</span></span>
<span id="cb43-760"><a href="#cb43-760" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-761"><a href="#cb43-761" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-762"><a href="#cb43-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-763"><a href="#cb43-763" aria-hidden="true" tabindex="-1"></a>We can input each of these fitted equations into a <span class="in">`geom_function()`</span> layer of our <span class="in">`ggplot()`</span> syntax.</span>
<span id="cb43-764"><a href="#cb43-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-765"><a href="#cb43-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-768"><a href="#cb43-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-769"><a href="#cb43-769" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-02</span></span>
<span id="cb43-770"><a href="#cb43-770" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted graduation rate as a function of median SAT score for public (blue, solid line) and private (orange, dashed line) institutions."</span></span>
<span id="cb43-771"><a href="#cb43-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted graduation rate as a function of median SAT score for public (blue, solid line) and private (orange, dashed line) institutions."</span></span>
<span id="cb43-772"><a href="#cb43-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb43-773"><a href="#cb43-773" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb43-774"><a href="#cb43-774" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mn, <span class="fu">aes</span>(<span class="at">x =</span> sat, <span class="at">y =</span> grad)) <span class="sc">+</span></span>
<span id="cb43-775"><a href="#cb43-775" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-776"><a href="#cb43-776" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>( <span class="co"># Private schools</span></span>
<span id="cb43-777"><a href="#cb43-777" aria-hidden="true" tabindex="-1"></a>      <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">286.1</span> <span class="sc">+</span> <span class="fl">146.0</span><span class="sc">*</span><span class="fu">log</span>(x)},</span>
<span id="cb43-778"><a href="#cb43-778" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"#6d92ee"</span>,</span>
<span id="cb43-779"><a href="#cb43-779" aria-hidden="true" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">"solid"</span></span>
<span id="cb43-780"><a href="#cb43-780" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb43-781"><a href="#cb43-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>( <span class="co"># Public schools</span></span>
<span id="cb43-782"><a href="#cb43-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="sc">-</span><span class="fl">294.6</span> <span class="sc">+</span> <span class="fl">146.0</span><span class="sc">*</span><span class="fu">log</span>(x)},</span>
<span id="cb43-783"><a href="#cb43-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"#fe932d"</span>,</span>
<span id="cb43-784"><a href="#cb43-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span></span>
<span id="cb43-785"><a href="#cb43-785" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb43-786"><a href="#cb43-786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb43-787"><a href="#cb43-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Estimated median SAT score (in hundreds)"</span>) <span class="sc">+</span></span>
<span id="cb43-788"><a href="#cb43-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Six-year graduation rate"</span>)</span>
<span id="cb43-789"><a href="#cb43-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-790"><a href="#cb43-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-791"><a href="#cb43-791" aria-hidden="true" tabindex="-1"></a>The plot shows the nonlinear, diminishing positive effect of median SAT score on graduation rate for both public and private schools. For schools with lower median SAT scores, there is a larger effect on graduation rates than for schools with higher median SAT scores (for both private and public schools). Note that the curves are parallel (the result of fitting a main effects model) suggesting that the effect of median SAT score on graduation rates is the same for both public and private institutions.</span>
<span id="cb43-792"><a href="#cb43-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-793"><a href="#cb43-793" aria-hidden="true" tabindex="-1"></a>The plot also shows the controlled effect of sector. For schools with the same median SAT score, private schools have a higher predicted graduation rate than public schools, on average. This difference is the same, regardless of median SAT score; again a result of fitting the main effects model.</span>
<span id="cb43-794"><a href="#cb43-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-795"><a href="#cb43-795" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-796"><a href="#cb43-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-797"><a href="#cb43-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-798"><a href="#cb43-798" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using Information Criteria to Adopt a Model</span></span>
<span id="cb43-799"><a href="#cb43-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-800"><a href="#cb43-800" aria-hidden="true" tabindex="-1"></a>We could use evidence from the information criteria to evaluate the evidence among a set of candidate models, so long as they were fitted with the same data and use the same outcome. For example, consider the following candidate models:</span>
<span id="cb43-801"><a href="#cb43-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-802"><a href="#cb43-802" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-803"><a href="#cb43-803" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb43-804"><a href="#cb43-804" aria-hidden="true" tabindex="-1"></a>\mathbf{Model~1:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \epsilon_i <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb43-805"><a href="#cb43-805" aria-hidden="true" tabindex="-1"></a>\mathbf{Model~2:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \beta_1\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> + \epsilon_i <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb43-806"><a href="#cb43-806" aria-hidden="true" tabindex="-1"></a>\mathbf{Model~3:~}\mathrm{Graduation~Rate}_i &amp;= \beta_0 + \beta_1\bigg<span class="co">[</span><span class="ot">\ln(\mathrm{SAT}_i)\bigg</span><span class="co">]</span> + \beta_2(\mathrm{Public}_i) + \epsilon_i</span>
<span id="cb43-807"><a href="#cb43-807" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb43-808"><a href="#cb43-808" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb43-809"><a href="#cb43-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-810"><a href="#cb43-810" aria-hidden="true" tabindex="-1"></a>where each model has the assumptions that $\epsilon_i\overset{i.i.d.}{\sim}\mathcal{N}(0,\sigma^2_{\epsilon})$.</span>
<span id="cb43-811"><a href="#cb43-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-814"><a href="#cb43-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-815"><a href="#cb43-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models (use natural log of SAT)</span></span>
<span id="cb43-816"><a href="#cb43-816" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mn)</span>
<span id="cb43-817"><a href="#cb43-817" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat), <span class="at">data =</span> mn)</span>
<span id="cb43-818"><a href="#cb43-818" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lm</span>(grad <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(sat) <span class="sc">+</span> public, <span class="at">data =</span> mn)</span>
<span id="cb43-819"><a href="#cb43-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-820"><a href="#cb43-820" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb43-821"><a href="#cb43-821" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb43-822"><a href="#cb43-822" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm<span class="fl">.1</span>, lm<span class="fl">.2</span>, lm<span class="fl">.3</span>),</span>
<span id="cb43-823"><a href="#cb43-823" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Intercept-only"</span>, <span class="st">"Ln(SAT)"</span>, <span class="st">"Ln(SAT) and Sector"</span>)</span>
<span id="cb43-824"><a href="#cb43-824" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-825"><a href="#cb43-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-826"><a href="#cb43-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-827"><a href="#cb43-827" aria-hidden="true" tabindex="-1"></a>The empirical evidence, given the models fitted and the data, overwhelmingly supports Model 3 (the model that includes the effects of median SAT and sector on graduation rates).</span>
<span id="cb43-828"><a href="#cb43-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-829"><a href="#cb43-829" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb43-830"><a href="#cb43-830" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb43-831"><a href="#cb43-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-832"><a href="#cb43-832" aria-hidden="true" tabindex="-1"></a>Note that this test can help us evaluate whether there is an effect, but CANNOT tell us whether that effect is nonlinear, nor whether a log function is appropriate to model the effect; for that you are reliant on the residuals!</span>
<span id="cb43-833"><a href="#cb43-833" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb43-834"><a href="#cb43-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-835"><a href="#cb43-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-836"><a href="#cb43-836" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb43-837"><a href="#cb43-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-838"><a href="#cb43-838" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>