<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Mathematical Foundations: Probability Density – Advanced Modeling and Reproducibility for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-03-likelihood-framework-for-evidence.html" rel="next">
<link href="./02-00-likelihood.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d3043699f4f525e226433170f63674df.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7c121de436c7c20b050f1da4c0bef0bb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-00-likelihood.html">Likelihood</a></li><li class="breadcrumb-item"><a href="./02-01-mathematical-foundations-probability-density.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Modeling and Reproducibility for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-introduction-to-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-more-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-creating-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Tables with gt</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-mathematical-foundations-probability-density.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-likelihood-framework-for-evidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-likelihood-framework-for-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-modeling-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonlinearity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-polynomial-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Polynomial Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-information-criteria-and-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Information Criteria and Model Selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-00-likelihood.html">Likelihood</a></li><li class="breadcrumb-item"><a href="./02-01-mathematical-foundations-probability-density.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Quarto Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Understanding ideas about probability distributions (especially continuous probability distributions) is essential for understanding likelihood.</p>
<p><br></p>
<section id="terminology-and-basic-ideas-of-probability-distributions" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="terminology-and-basic-ideas-of-probability-distributions"><span class="header-section-number">5.1</span> Terminology and Basic Ideas of Probability Distributions</h2>
<p>A probability distribution is simply a mapping of every outcome in the sample space to a probability. (It is conventional to use <em>x</em> to denote the outcomes.) This mapping can take many forms such a list, a plot, or an equation. All are reasonable to define the probability distribution, although some of these are more typical for discrete variables (e.g., list, plot), while others are more typical for continuous distributions (e.g., plot, equation). Here are a couple different probability distributions:</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-01" class="quarto-float quarto-figure quarto-figure-center anchored" alt="An example of a discrete and continuous probability distribution.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/04-probability-distributions-example.png" class="img-fluid figure-img" style="width:100.0%" alt="An example of a discrete and continuous probability distribution.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: An example of a discrete and continuous probability distribution.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In general, the probability of an outcome (<em>p(x)</em>) is defined as the number of times an outcome appears in the sample space divided by the total number of outcomes. So, for example, in the probability experiment of flipping a fair coin twice, the sample space is:</p>
<p><span class="math display">\[
S = \{HH,~HT,~TH,~TT\}
\]</span></p>
<p>The probability of a head and a tail (assuming order doesn’t matter) is:</p>
<p><span class="math display">\[
p(HT~\mathrm{or}~TH) = \frac{2}{4} = 0.5
\]</span> This falls apart when we move to continuous distributions. For example, consider finding the probability of a zero occurring in the standard normal distribution given in <a href="02-03-likelihood-framework-for-evidence.html#fig-01" class="quarto-xref">Figure&nbsp;<span>6.1</span></a>. The sample space includes every outcome possible and is:</p>
<p><span class="math display">\[
S = \{-\infty, ~ +\infty\}
\]</span> so the probability of zero (which occurs once in that sample space) is:</p>
<p><span class="math display">\[
p(0) = \frac{1}{\infty} \approx 0
\]</span></p>
<p>Likewise the probability of 1 or 2 is also:</p>
<p><span class="math display">\[
\begin{split}
p(1) = \frac{1}{\infty} \approx 0 \\
p(2) = \frac{1}{\infty} \approx 0
\end{split}
\]</span></p>
<p>In fact the probability of every possible outcome is 0. The problem is that if we add all the probabilities together, we have to get 1 (Law of Probability), and in this case we don’t; the sum of <span class="math inline">\(0 + 0 + \ldots + 0 = 0\)</span>. Because of this, in continuous distributions, we typically compute the probability of a range of values. For example, in our standard normal distribution:</p>
<p><span class="math display">\[
\begin{split}
p(x \leq 0) = 0.5 \\
p(-1 \leq x \leq 1) = 0.68 \\
p(-2 \leq x \leq 2) = 0.95
\end{split}
\]</span></p>
<p><br></p>
<section id="probability-density" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="probability-density"><span class="header-section-number">5.1.1</span> Probability Density</h3>
<p>In a continuous distribution we also need to account be able to talk about the fact that some outcomes are more likely than other outcomes. For example, in our standard normal distribution outcomes near zero are more probable than outcomes near 1, which are more probable than outcomes near 2, etc. Since we can’t use probability to do this (remember the probability of each outcome is the same, namely 0), we use something called <em>probability density</em>. This is akin to a relative probability, so outcomes with a higher probability density are more likely than outcomes with a lower probability density.</p>
<p>The mapping of all the outcomes to their probability densities is called a <em>probability density function</em> (PDF). Thus the equation or “bell-shaped” curve describing the standard normal distribution in <a href="02-03-likelihood-framework-for-evidence.html#fig-01" class="quarto-xref">Figure&nbsp;<span>6.1</span></a> is technically a PDF Here are some laws governing PDFs:</p>
<ul>
<li>Probability densities are always positive.</li>
<li>The probability of an outcome <em>x</em> between <em>a</em> and <em>b</em> equals the integral (area under the curve) between <em>a</em> and <em>b</em> of the probability density function. That is:</li>
</ul>
<p><span class="math display">\[
p(a \leq x \leq b) = \int_a^b p(x) dx
\]</span></p>
<ul>
<li>The area under the curve from negative infinity to positive infinity is 1. That is:</li>
</ul>
<p><span class="math display">\[
p(-\infty \leq x \leq +\infty) = \int_{-\infty}^{+\infty} p(x) = 1
\]</span></p>
<p>Next we will look at the PDF for a normal distribution.</p>
<p><br></p>
</section>
</section>
<section id="pdf-for-a-normal-gaussian-distribution" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="pdf-for-a-normal-gaussian-distribution"><span class="header-section-number">5.2</span> PDF for a Normal (Gaussian) Distribution</h2>
<p>The probability density function (PDF) of a normal distribution is mathematically defined as:</p>
<p><span class="math display">\[
p(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left[-\frac{(x-\mu)^2}{2\sigma^2}\right]
\]</span></p>
<p>for <span class="math inline">\(-\infty \leq x \leq \infty\)</span>.</p>
<p>To calculate the probability density, we need three pieces of information: (1) the outcome (<em>x</em>-value) for which we want to determine the probability density, (2) the mean (<span class="math inline">\(\mu\)</span>) of the normal distribution <em>x</em> is a member of, and (3) the standard deviation (<span class="math inline">\(\sigma\)</span>) of the normal distribution <em>x</em> is a member of. Then, we can compute the probability density (<span class="math inline">\(p(x)\)</span>) for a particular <span class="math inline">\(x\)</span> value by using the equation.</p>
<p>As an example, consider a normal distribution with a mean of 50, and a standard deviation of 10. The probability density for <span class="math inline">\(x=65\)</span> can be found using,</p>
<p><span class="math display">\[
\begin{split}
p(65) &amp;= \frac{1}{10\sqrt{2\pi}}\exp\left[-\frac{(65-50)^2}{2\times10^2}\right] \\[1ex]
&amp;= 0.01295176
\end{split}
\]</span></p>
<p>Using R, we can carry out the computation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(50,10)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">10</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">225</span>) <span class="sc">/</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01295176</code></pre>
</div>
</div>
<p>There is also a more direct way to compute this using the <code>dnorm()</code> function. This function computes the density of <code>x</code> from a normal distribution with a specified <code>mean</code> and <code>sd</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(50,10)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01295176</code></pre>
</div>
</div>
<p>Symbolically, we might write</p>
<p><span class="math display">\[
P\bigg(x=65 \mid \mathcal{N}(50,10)\bigg) = 0.01295176
\]</span></p>
<p>which is read:</p>
<blockquote class="blockquote">
<p>The probability density of <span class="math inline">\(x=65\)</span> GIVEN the normal distribution having a mean of 50 and standard deviation of 10 is equal to 0.013.</p>
</blockquote>
<p>Note that the probability density for a value is not only a function of <em>x</em>, but also depends on the mean and standard deviation of the normal distribution. For example, the probability density of <span class="math inline">\(x=65\)</span> in the normal distribution having a mean of 30 and standard deviation of 20 is a different value than the probability density we found earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(30,20)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004313866</code></pre>
</div>
</div>
<p>Here,</p>
<p><span class="math display">\[
P\bigg(x=65 \mid \mathcal{N}(30,20)\bigg) = 0.004313866
\]</span></p>
<p>In general, when we think about the normal distribution, we are thinking about the mapping of each <em>x</em>-value from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span> to its associated probability density. Rather than list each of these mappings out, we can create a plot of these mappings. This plot gives us the familiar “bell shape”. Theoretically this plot is the graphical depiction of the PDF.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">40</span>, <span class="at">to =</span> <span class="dv">90</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y1 =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y2 =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y1)) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0085af"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#c62f4b"</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">y =</span> <span class="fl">0.01295176</span>,  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#0085af"</span>) <span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">y =</span> <span class="fl">0.004313866</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#c62f4b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-02" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for a N(50,10) distribution (blue, solid line) and for a N(30,20) distribution (red, dashed line). The probability density value for x=65 is also displayed on both PDFs.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-02-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Plot of the probability density function (PDF) for a N(50,10) distribution (blue, solid line) and for a N(30,20) distribution (red, dashed line). The probability density value for x=65 is also displayed on both PDFs.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Plot of the probability density function (PDF) for a <span class="math inline">\(\mathcal{N}(50,10)\)</span> distribution (blue, solid line) and for a <span class="math inline">\(\mathcal{N}(30,20)\)</span> distribution (red, dashed line). The probability density value for <span class="math inline">\(x=65\)</span> is also displayed on both PDFs.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Of course, the PDF is different for normal distributions with different means (<span class="math inline">\(\mu\)</span>) or standard deviations (<span class="math inline">\(\sigma\)</span>). This implies that there is not one normal distribution, but rather an infinite number of normal distributions, each with a different mean or standard deviation. (We refer to the normal distribution as a “family” of distributions.)</p>
<p>To completely define the PDF we need to specify the mean and standard deviation we are using to compute the probability densities. Specifying these values is referred to as <em>parameterizing the distribution</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p><br></p>
<section id="other-useful-r-functions-for-working-with-normal-probability-distributions" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="other-useful-r-functions-for-working-with-normal-probability-distributions"><span class="header-section-number">5.2.1</span> Other Useful R Functions for Working with Normal Probability Distributions</h3>
<p>We use <code>dnorm()</code> when we want to compute the probability density associated with a particular <em>x</em>-value in a given normal distribution. There are three other functions that are quite useful for working with the normal probability distribution:</p>
<ul>
<li><code>pnorm()</code> : To compute the probability (area under the PDF)</li>
<li><code>qnorm()</code> : To compute the <span class="math inline">\(x\)</span> value given a particular probability</li>
<li><code>rnorm()</code> : To draw a random observation from the distribution</li>
</ul>
<p>Each of these function also requires the arguments <code>mean=</code> and <code>sd=</code>. Below we will examine how to use each of these additional functions.</p>
<p><br></p>
</section>
<section id="pnorm-computing-cumulative-probability-density" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="pnorm-computing-cumulative-probability-density"><span class="header-section-number">5.2.2</span> pnorm(): Computing Cumulative Probability Density</h3>
<p>The function <code>pnorm()</code> computes the area under the PDF curve from <span class="math inline">\(-\infty\)</span> to some <em>x</em>-value. (Sometimes this is referred to as the cumulative probability density of <em>x</em>.) It is important to note that the PDF is defined such that the entire area under the curve is equal to 1. Because of this, we can also think about using area under the curve as an analog to probability in a continuous distribution.</p>
<p>For example, we might ask about the probability of observing an <em>x</em>-value that is less than or equal to 65 given it is from a <span class="math inline">\(\mathcal{N}(50,10)\)</span> distribution. Symbolically, we want to find:</p>
<p><span class="math display">\[
P\bigg(x \leq 65 \mid \mathcal{N}(50,10)\bigg)
\]</span></p>
<p>This is akin to finding the proportion of the area under the <span class="math inline">\(\mathcal{N}(50,10)\)</span> PDF that is to the left of 65. The figure below shows a graphical depiction of the cumulative probability density for <span class="math inline">\(x=65\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig_03 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">90</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out X&lt;=65</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>shaded <span class="ot">=</span> fig_03 <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&lt;=</span> <span class="dv">65</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_03, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shaded, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-03" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for a N(50,10) distribution. The area that is shaded grey (relative to the total area under the PDF) represents the cumulative probability density for x=65.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-03-1.png" class="img-fluid figure-img" style="width:60.0%" alt="Plot of the probability density function (PDF) for a N(50,10) distribution. The area that is shaded grey (relative to the total area under the PDF) represents the cumulative probability density for x=65.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Plot of the probability density function (PDF) for a N(50,10) distribution. The area that is shaded grey (relative to the total area under the PDF) represents the cumulative probability density for x=65.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can compute the cumulative probability density using the <code>pnorm()</code> function. The “p” stand for “probability”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find P(x&lt;=65 | N(50,10) )</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9331928</code></pre>
</div>
</div>
<p>We can interpret this as:</p>
<blockquote class="blockquote">
<p>The probability of observing an <em>x</em>-value that is less than or equal to 65 (if it is drawn from a normal distribution with a mean of 50 and standard deviation of 10) is 0.933.</p>
</blockquote>
<p>In mathematics, the area under a curve is called an <em>integral</em>. The grey-shaded area in the previous figure can also be expressed as an integral of the probability density function:</p>
<p><span class="math display">\[
\int_{-\infty}^{65} p(x) dx
\]</span></p>
<p>where <span class="math inline">\(p(x)\)</span> is the PDF for the normal distribution.</p>
<p>The most common application for finding the cumulative density is to compute a <em>p</em>-value. The <em>p</em>-value is just the area under the distribution (curve) that is AT LEAST as extreme as some observed value. For example, assume we computed a test statistic of <span class="math inline">\(z=2.5\)</span>, and were evaluating whether this was different from 0 (two-tailed test). Graphically, we want to determine the proportion of the area under the PDF that is shaded grey in the figure below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig_04 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for shading</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>shade_01 <span class="ot">=</span> fig_04 <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="fl">2.5</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>shade_02 <span class="ot">=</span> fig_04 <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_04, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_01, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_02, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"z"</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-04" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for the standard normal distribution (M=0, SD=1). The cumulative density representing the p-value for a two-tailed test evaluating whether mu=0 using an observed mean of 2.5 is also displayed.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-04-1.png" class="img-fluid figure-img" style="width:60.0%" alt="Plot of the probability density function (PDF) for the standard normal distribution (M=0, SD=1). The cumulative density representing the p-value for a two-tailed test evaluating whether mu=0 using an observed mean of 2.5 is also displayed.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Plot of the probability density function (PDF) for the standard normal distribution (<span class="math inline">\(M=0\)</span>, <span class="math inline">\(SD=1\)</span>). The cumulative density representing the <em>p</em>-value for a two-tailed test evaluating whether <span class="math inline">\(\mu=0\)</span> using an observed mean of 2.5 is also displayed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>If the distribution of the test statistic is normally distributed, we can use <code>pnorm()</code> to compute the <em>p</em>-value. If we assume the test statistic, <em>z</em>, has been scaled to use standardized units, the standard deviation we use in <code>pnorm()</code> will be <code>sd=1</code>. The mean is based on the value being tested in the null hypothesis. In most null hypotheses, we are testing a difference from 0 (e.g., <span class="math inline">\(H_0: \mu=0\)</span>, <span class="math inline">\(H_0: \beta=0\)</span>), so we would use <code>mean=0</code> in the <code>pnorm()</code> function.</p>
<p>Remember, <code>pnorm()</code> computes the proportion of the area under the curve TO THE LEFT of a particular value. Here we will compute the area to the left of <span class="math inline">\(-2.5\)</span> and then double it to produce the actual <em>p</em>-value. (We can double it because the normal distribution is symmetric so the area to the left of <span class="math inline">\(-2.5\)</span> is the same as the area to the right of <span class="math inline">\(+2.5\)</span>.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value based on z=2.5</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="at">q =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01241933</code></pre>
</div>
</div>
<p>We interpret this <em>p</em>-value as:</p>
<blockquote class="blockquote">
<p>The probability of observing a statistic at least as extreme as 2.5, assuming the null hypothesis is true, is 0.012. This is evidence against the null hypothesis since the data are inconsistent with the assumed hypothesis.</p>
</blockquote>
<p><br></p>
</section>
<section id="qnorm-computing-quantiles" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="qnorm-computing-quantiles"><span class="header-section-number">5.2.3</span> qnorm(): Computing Quantiles</h3>
<p>The <code>qnorm()</code> function is essentially the inverse of the <code>pnorm()</code> function. The <code>pnorm()</code> function computes the cumulative probability GIVEN a particular quantile (<em>x</em>-value). The <code>qnorm()</code> function computes the quantile GIVEN a cumulative probability. For example, in the <span class="math inline">\(\mathcal{N}(50, 10)\)</span> distribution, half of the area under the PDF is below the <em>x</em>-value (quantile) of 50.</p>
<p>To use the <code>qnorm()</code> function to give the <em>x</em>-value (quantile) that defines the lower 0.5 of the area under the <span class="math inline">\(\mathcal{N}(50, 10)\)</span> PDF, the syntax would be:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the quantile that has a cumulative density of 0.5 in the N(50, 10) distribution</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="rnorm-generating-random-observations" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="rnorm-generating-random-observations"><span class="header-section-number">5.2.4</span> rnorm(): Generating Random Observations</h3>
<p>The <code>rnorm()</code> function can be used to generate random observations drawn from a specified normal distribution. Aside from the <code>mean=</code> and <code>sd=</code> arguments, we also need to specify the number of observations to generate by including the argument <code>n=</code>. For example, to generate 15 observations drawn from a <span class="math inline">\(\mathcal{N}(50,10)\)</span> distribution we would use the following syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 15 observations from N(50,10)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 44.97808 51.31531 49.21083 58.86785 51.16971 53.18630 44.18209 57.14533
 [9] 41.74741 46.40138 50.89886 50.96274 47.98366 57.39840 51.23380</code></pre>
</div>
</div>
<p>The <code>set.seed()</code> function sets the state of the random number generator used in R so that the results are reproducible. If you don’t use <code>set.seed()</code> you will get a different set of observations each time you run <code>rnorm()</code>. Here we set the starting seed to 100, but you can set this to any integer you want.</p>
<p><br></p>
</section>
</section>
<section id="students-t-distribution" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="students-t-distribution"><span class="header-section-number">5.3</span> Student’s <em>t</em>-Distribution</h2>
<p>The PDF of Student’s <em>t</em>-distribution looks similar to the PDF for a standard normal distribution. In the figure below, Student’s <em>t</em>-distribution is depicted with a solid, black line and the standard normal distribution (<span class="math inline">\(M=0\)</span>, <span class="math inline">\(SD=1\)</span>) is depicted with a dotted, red line.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fig_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_t =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">5</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_norm =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_05, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y_t)) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y_norm), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-05" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for both the standard normal distribution (dotted, red line) and Student's t(5) distribution (solid, black line).">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-05-1.png" class="img-fluid figure-img" style="width:60.0%" alt="Plot of the probability density function (PDF) for both the standard normal distribution (dotted, red line) and Student's t(5) distribution (solid, black line).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Plot of the probability density function (PDF) for both the standard normal distribution (dotted, red line) and Student’s <span class="math inline">\(t(5)\)</span> distribution (solid, black line).
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Both the standard normal distribution and Student’s <em>t</em>-distribution are symmetric distributions.</li>
<li>Both the standard normal distribution and Student’s <em>t</em>-distribution have a mean (expected value) of 0.</li>
<li>The standard deviation for Student’s <em>t</em>-distribution is, however, larger than the standard deviation for the standard normal distribution (<span class="math inline">\(SD&gt;1\)</span>). You can see this in the distribution because the tails in Student’s <em>t</em>-distribution are fatter (more error) than the standard normal distribution.</li>
</ul>
<p>In practice, we often use Student’s <em>t</em>-distribution rather than the standard normal distribution in our evaluations of sample data. This is because the increased error (i.e., standard deviation) associated with Student’s <em>t</em>-distribution better models the additional uncertainty associated with having incomplete information (i.e., a sample rather than the entire population).</p>
<p>Student’s <em>t</em>-distribution also constitutes a family of distributions; there is not a single <em>t</em>-distribution. The specific shape (and thus probability density) is defined by a parameter called the <em>degrees of freedom</em> (<em>df</em>). The plot below shows the standard normal distribution (purple) and four <em>t</em>-distributions with varying <em>df</em>-values. The means and standard deviations for each of these distributions is also provided in a table.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(3)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_03 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">3</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"03"</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(5)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>df_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">5</span>),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"05"</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(10)</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>df_10 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">10</span>),</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"10"</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(25)</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>df_25 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">25</span>),</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"25"</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for standard normal</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"Standard normal"</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all datasets into one</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>fig_06 <span class="ot">=</span> <span class="fu">rbind</span>(df_03, df_05, df_10, df_25, z)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_06, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> df, <span class="at">linetype =</span> df)) <span class="sc">+</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-06" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of several t-Distributions with differing degrees of freedom.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-06-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Plot of several t-Distributions with differing degrees of freedom.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: Plot of several <em>t</em>-Distributions with differing degrees of freedom.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data from table</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>tab_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"z"</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">M =</span> <span class="fl">0.00</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.5</span>, <span class="fl">1.22</span>, <span class="fl">1.08</span>, <span class="fl">1.00</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>tab_01 <span class="sc">|&gt;</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="fu">md</span>(<span class="st">"*df*"</span>),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">md</span>(<span class="st">"*M*"</span>),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">md</span>(<span class="st">"*SD*"</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(df, M, SD),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Means and standard deviations for four <em>t</em>-Distributions and the standard normal distribution.
</figcaption>
<div aria-describedby="tbl-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bsddtpugyp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bsddtpugyp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bsddtpugyp thead, #bsddtpugyp tbody, #bsddtpugyp tfoot, #bsddtpugyp tr, #bsddtpugyp td, #bsddtpugyp th {
  border-style: none;
}

#bsddtpugyp p {
  margin: 0;
  padding: 0;
}

#bsddtpugyp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bsddtpugyp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bsddtpugyp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bsddtpugyp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bsddtpugyp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bsddtpugyp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bsddtpugyp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bsddtpugyp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bsddtpugyp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bsddtpugyp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bsddtpugyp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bsddtpugyp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bsddtpugyp .gt_spanner_row {
  border-bottom-style: hidden;
}

#bsddtpugyp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bsddtpugyp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bsddtpugyp .gt_from_md > :first-child {
  margin-top: 0;
}

#bsddtpugyp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bsddtpugyp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bsddtpugyp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bsddtpugyp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bsddtpugyp .gt_row_group_first td {
  border-top-width: 2px;
}

#bsddtpugyp .gt_row_group_first th {
  border-top-width: 2px;
}

#bsddtpugyp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bsddtpugyp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bsddtpugyp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bsddtpugyp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bsddtpugyp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bsddtpugyp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bsddtpugyp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bsddtpugyp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bsddtpugyp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bsddtpugyp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bsddtpugyp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bsddtpugyp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bsddtpugyp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bsddtpugyp .gt_left {
  text-align: left;
}

#bsddtpugyp .gt_center {
  text-align: center;
}

#bsddtpugyp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bsddtpugyp .gt_font_normal {
  font-weight: normal;
}

#bsddtpugyp .gt_font_bold {
  font-weight: bold;
}

#bsddtpugyp .gt_font_italic {
  font-style: italic;
}

#bsddtpugyp .gt_super {
  font-size: 65%;
}

#bsddtpugyp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bsddtpugyp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bsddtpugyp .gt_indent_1 {
  text-indent: 5px;
}

#bsddtpugyp .gt_indent_2 {
  text-indent: 10px;
}

#bsddtpugyp .gt_indent_3 {
  text-indent: 15px;
}

#bsddtpugyp .gt_indent_4 {
  text-indent: 20px;
}

#bsddtpugyp .gt_indent_5 {
  text-indent: 25px;
}

#bsddtpugyp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bsddtpugyp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="df" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>df</em></th>
<th id="M" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>M</em></th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>SD</em></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="df">3</td>
<td class="gt_row gt_center" headers="M">0</td>
<td class="gt_row gt_center" headers="SD">2.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="df">5</td>
<td class="gt_row gt_center" headers="M">0</td>
<td class="gt_row gt_center" headers="SD">1.50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="df">10</td>
<td class="gt_row gt_center" headers="M">0</td>
<td class="gt_row gt_center" headers="SD">1.22</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="df">25</td>
<td class="gt_row gt_center" headers="M">0</td>
<td class="gt_row gt_center" headers="SD">1.08</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="df">z</td>
<td class="gt_row gt_center" headers="M">0</td>
<td class="gt_row gt_center" headers="SD">1.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>If we compare the means and standard deviations for these distributions, we find that the mean for all the <em>t</em>-distributions is 0, same as the standard normal distribution. All <em>t</em>-distributions are unimodal and symmetric around zero. The standard deviation for every <em>t</em>-distribution is higher than the standard deviation for the standard normal distribution. Mathematically, the variance for the <em>t</em>-distribution is:</p>
<p><span class="math display">\[
\sigma^2(t) = \frac{\nu}{\nu-2}
\]</span></p>
<p>where <span class="math inline">\(\nu\)</span> (the Greek letter nu) is the degrees of freedom. (Note that <span class="math inline">\(\nu \geq 2\)</span>.) Examining this formula, we find that Student <em>t</em>-distributions with higher <em>df</em> values have less variation. When <span class="math inline">\(\nu=+\infty\)</span>, the variance approaches 1, which is the same as the standard normal distribution.</p>
<p>There are four primary functions for working with Student’s <em>t</em>-distribution:</p>
<ul>
<li><code>dt()</code> : To compute the probability density (point on the curve)</li>
<li><code>pt()</code> : To compute the cumulative density (area under the PDF)</li>
<li><code>qt()</code> : To compute the quantile value given a particular probability</li>
<li><code>rt()</code> : To draw a random observation from the distribution</li>
</ul>
<p>Each of these requires the argument <code>df=</code>.</p>
<p><br></p>
</section>
<section id="the-f-distribution" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="the-f-distribution"><span class="header-section-number">5.4</span> The F-distribution</h2>
<p>The <em>F</em>-distribution, like the <em>t</em>-distribution, constitutes a family of distributions. They are positively skewed and generally have a lower-limit of 0. To parameterize an <em>F</em>-distribution we need two parameters, namely <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span>. These are both degrees of freedom. The exact shape of the <em>F</em>-distribution s governed by the two degrees of freedom parameters. The figure below shows several <em>F</em>-distributions with different degrees of freedom.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(1,10)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="dv">10</span>),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(1, 10)"</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(5,25)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>),</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(5, 25)"</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(15,30)</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">15</span>, <span class="at">df2 =</span> <span class="dv">30</span>),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(15, 30)"</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(30,60)</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">30</span>, <span class="at">df2 =</span> <span class="dv">60</span>),</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(30, 60)"</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all datasets into one</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>fig_07 <span class="ot">=</span> <span class="fu">rbind</span>(f1, f2, f3, f4)</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_07, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> df, <span class="at">linetype =</span> df)) <span class="sc">+</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-07" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of several F-Distributions with differing degrees of freedom.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-07-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Plot of several F-Distributions with differing degrees of freedom.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: Plot of several <em>F</em>-Distributions with differing degrees of freedom.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The expected value (mean) and standard deviation of the <em>F</em>-distribution is:</p>
<p><span class="math display">\[
\begin{split}
E(F) &amp;= \frac{\nu_2}{\nu_2 - 2} \\[1ex]
\sigma^2(F) &amp;= \frac{2\nu_2^2(\nu_1 + \nu_2 - 2)}{\nu_1(\nu_2-2)^2(\nu_2-4)}
\end{split}
\]</span></p>
<p>where <span class="math inline">\(\nu_2 &gt; 2\)</span> for the mean and <span class="math inline">\(\nu_2 &gt; 4\)</span> for the variance.</p>
<p>From these formulas we can see that as <span class="math inline">\(\nu_2 \rightarrow +\infty\)</span> the mean of the <em>F</em>-distribution approaches 1. We can also see that the variation in the <em>F</em>-distribution is a function of both parameters and the variance decreases as either parameter gets larger.</p>
<p>The means and standard deviations for our four example <em>F</em>-distributions are given in the table below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data from table</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tab_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">5</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df2 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">25</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(       </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> df2 <span class="sc">/</span> (df2 <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sqrt</span>((<span class="dv">2</span><span class="sc">*</span>df2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(df1 <span class="sc">+</span> df2 <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">/</span> (df1<span class="sc">*</span>(df2<span class="dv">-2</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(df2<span class="dv">-4</span>)))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>tab_02 <span class="sc">|&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">df1 =</span> <span class="fu">md</span>(<span class="st">"*df1*"</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">df2 =</span> <span class="fu">md</span>(<span class="st">"*df2*"</span>),</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">md</span>(<span class="st">"*M*"</span>),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">md</span>(<span class="st">"*SD*"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(df1, df2, M, SD),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(M, SD),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-02" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.2: Means and standard deviations for four <em>F</em>-distributions.
</figcaption>
<div aria-describedby="tbl-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="viiivxkgai" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#viiivxkgai table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#viiivxkgai thead, #viiivxkgai tbody, #viiivxkgai tfoot, #viiivxkgai tr, #viiivxkgai td, #viiivxkgai th {
  border-style: none;
}

#viiivxkgai p {
  margin: 0;
  padding: 0;
}

#viiivxkgai .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#viiivxkgai .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#viiivxkgai .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#viiivxkgai .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#viiivxkgai .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#viiivxkgai .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#viiivxkgai .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#viiivxkgai .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#viiivxkgai .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#viiivxkgai .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#viiivxkgai .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#viiivxkgai .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#viiivxkgai .gt_spanner_row {
  border-bottom-style: hidden;
}

#viiivxkgai .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#viiivxkgai .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#viiivxkgai .gt_from_md > :first-child {
  margin-top: 0;
}

#viiivxkgai .gt_from_md > :last-child {
  margin-bottom: 0;
}

#viiivxkgai .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#viiivxkgai .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#viiivxkgai .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#viiivxkgai .gt_row_group_first td {
  border-top-width: 2px;
}

#viiivxkgai .gt_row_group_first th {
  border-top-width: 2px;
}

#viiivxkgai .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#viiivxkgai .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#viiivxkgai .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#viiivxkgai .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#viiivxkgai .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#viiivxkgai .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#viiivxkgai .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#viiivxkgai .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#viiivxkgai .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#viiivxkgai .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#viiivxkgai .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#viiivxkgai .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#viiivxkgai .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#viiivxkgai .gt_left {
  text-align: left;
}

#viiivxkgai .gt_center {
  text-align: center;
}

#viiivxkgai .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#viiivxkgai .gt_font_normal {
  font-weight: normal;
}

#viiivxkgai .gt_font_bold {
  font-weight: bold;
}

#viiivxkgai .gt_font_italic {
  font-style: italic;
}

#viiivxkgai .gt_super {
  font-size: 65%;
}

#viiivxkgai .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#viiivxkgai .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#viiivxkgai .gt_indent_1 {
  text-indent: 5px;
}

#viiivxkgai .gt_indent_2 {
  text-indent: 10px;
}

#viiivxkgai .gt_indent_3 {
  text-indent: 15px;
}

#viiivxkgai .gt_indent_4 {
  text-indent: 20px;
}

#viiivxkgai .gt_indent_5 {
  text-indent: 25px;
}

#viiivxkgai .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#viiivxkgai div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="df1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>df1</em></th>
<th id="df2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>df2</em></th>
<th id="M" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>M</em></th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><em>SD</em></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="df1">1</td>
<td class="gt_row gt_center" headers="df2">10</td>
<td class="gt_row gt_center" headers="M">1.25</td>
<td class="gt_row gt_center" headers="SD">2.17</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="df1">15</td>
<td class="gt_row gt_center" headers="df2">30</td>
<td class="gt_row gt_center" headers="M">1.07</td>
<td class="gt_row gt_center" headers="SD">0.50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="df1">30</td>
<td class="gt_row gt_center" headers="df2">60</td>
<td class="gt_row gt_center" headers="M">1.03</td>
<td class="gt_row gt_center" headers="SD">0.33</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="df1">5</td>
<td class="gt_row gt_center" headers="df2">25</td>
<td class="gt_row gt_center" headers="M">1.09</td>
<td class="gt_row gt_center" headers="SD">0.79</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>Because there is no negative side of the distribution, when we use the <em>F</em>-distribution to compute a <em>p</em>-value, we only compute the cumulative density GREATER THAN OR EQUAL TO the value of the <em>F</em>-statistic. For example, the figure below shows the <span class="math inline">\(F(5,25)\)</span>-distribution and the shaded area corresponds to the <em>p</em>-value for an observed <em>F</em>-statistic of 2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(5,25)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig_08 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for shading</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>shade_01 <span class="ot">=</span> fig_08 <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_08, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_01, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-08" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-08-1.png" class="img-fluid figure-img" style="width:70.0%" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-08-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.8: Plot of the probability density function (PDF) for the <span class="math inline">\(F(5,25)\)</span>-distribution. The cumulative density representing the <em>p</em>-value associated with an <em>F</em>-statistic of 2 is shaded in grey.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we can use the <code>pf()</code> function to compute the <em>p</em>-value. Remember, <code>pf()</code> computes the proportion of the area under the curve TO THE LEFT of a particular value. Here we will need to compute the area to the RIGHT of <span class="math inline">\(+2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value based on F(5,25)=2</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1134803</code></pre>
</div>
</div>
<p>The probability of observing an <em>F</em>-statistic at least as extreme as 2, assuming the null hypothesis is true, is 0.113. This is not evidence against the null hypothesis since the data are consistent with the assumed hypothesis.</p>
<p><br></p>
</section>
<section id="creating-a-pdf-and-adding-shading-in-a-ggplot" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="creating-a-pdf-and-adding-shading-in-a-ggplot"><span class="header-section-number">5.5</span> Creating a PDF and Adding Shading in a ggplot</h2>
<p>One method to create the PDF for a distribution using <code>ggplot()</code> is to create a dataset that includes a sequence of <em>X</em>-values for which you want to show the PDF and compute the probability density for each of those values. Then you can use <code>geom_line()</code> to connect those probability densities.</p>
<p>For example, say we want to create the PDF of the <span class="math inline">\(F(15, 100)\)</span>-distribution. Here I will define this for <em>F</em>-values from 0 to 10. (These are the <em>x</em>-values in my plot.) Then I need to compute the probability densities for each of those values using <code>pf()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create F-value and compute probability densities</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>fig_09 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fig_09)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     X           Y
1 0.00 0.000000000
2 0.01 0.008319698
3 0.02 0.022838243
4 0.03 0.040722606
5 0.04 0.060856280
6 0.05 0.082557740</code></pre>
</div>
</div>
<p>Then we can plot the <em>Y</em> versus the <em>X</em> values and connect them using <code>geom_line()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_09, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-09" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-09-1.png" class="img-fluid figure-img" style="width:70.0%" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.9: Plot of the probability density function (PDF) for the <span class="math inline">\(F(5,25)\)</span>-distribution.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To add shading under the curve we need to create a new dataset that only includes the <em>X</em> and <em>Y</em> values in the shaded region. For example to shade the area under the PDF where <span class="math inline">\(F &gt; 2\)</span>, we need to create a new dataset where the <em>X</em> values are greater than 2. Below I do this using <code>filter()</code> and store the data in an object called <code>shade_01</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data included in the shaded region</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>shade_09 <span class="ot">=</span> fig_09 <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shade_09)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     X         Y
1 2.00 0.1558647
2 2.01 0.1537083
3 2.02 0.1515807
4 2.03 0.1494816
5 2.04 0.1474106
6 2.05 0.1453676</code></pre>
</div>
</div>
<p>We re-draw the PDF and then use <code>geom_ribbon()</code> to add shading. This layer requires us to define the area we want shaded. Here we want to shade from <span class="math inline">\(Y=0\)</span> to <span class="math inline">\(Y=\)</span> the probability density for each of the <em>X</em> values in the shading data. To carry this out we need to define <code>x=</code>, <code>ymin=</code> and <code>ymax=</code>.</p>
<p>Since the <em>X</em> values are in a column called <code>X</code> and the probability densities are in a column called <code>Y</code> in the shaded dataa frame, we can call <code>x=X</code> and <code>ymax=Y</code> in the <code>aes()</code> of <code>geom_ribbon()</code>. The <code>ymin=</code> value of 0 is not a column in the data frame, so it is specified OUTSIDE the <code>aes()</code> function. We can then also set characteristics like color of the shading (<code>color=</code>) and transparency level (<code>alpha=</code>). Finally, to ensure that <code>geom_ribbon()</code> is shading only the region we want, we set <code>data=shade_01</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_09, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y))  <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_09, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">ymax =</span> Y), </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-10" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-10-1.png" class="img-fluid figure-img" style="width:70.0%" alt="Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.10: Plot of the probability density function (PDF) for the <span class="math inline">\(F(5,25)\)</span>-distribution. The cumulative density representing the <em>p</em>-value associated with an <em>F</em>-statistic of 2 is shaded in grey.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="protip">
<p>You can click the <code>Code</code> button to see the underlying syntax for many of the figures created in this document.</p>
</div>
<p><br></p>
</section>
<section id="probability-distributions-in-regression" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="probability-distributions-in-regression"><span class="header-section-number">5.6</span> Probability Distributions in Regression</h2>
<p>To illustrate how probability distributions are used in practice, we will will use the data in the file <em>riverview.csv</em> (see the <a href="https://zief0002.github.io/bespectacled-antelope/codebooks/riverview.html">data codebook</a> for more information about these data) and fit a regression model that uses education level and seniority to predict variation in employee income. Some (most?) of this content should also be review from EPsy 8251.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>city <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/bespectacled-antelope/main/data/riverview.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): gender, party
dbl (3): education, income, seniority

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>city</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 5
   education income seniority gender     party      
       &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      
 1         8   26.4         9 female     Independent
 2         8   37.4         7 Not female Democrat   
 3        10   34.2        16 female     Independent
 4        10   25.5         1 female     Republican 
 5        10   47.0        14 Not female Democrat   
 6        12   46.5        11 female     Democrat   
 7        12   52.5        16 female     Independent
 8        12   37.7        14 Not female Democrat   
 9        12   50.3        24 Not female Democrat   
10        14   32.6         5 female     Independent
# ℹ 22 more rows</code></pre>
</div>
</div>
<p>To begin, we will fit a multiple regression model that uses level of education and seniority to predict variation in employee’s incomes. The model is:</p>
<p><span class="math display">\[
\begin{split}
\mathrm{Income}_i &amp;= \beta_0 + \beta_1(\mathrm{Education}_i) + \beta_2(\mathrm{Seniority}_i) + \epsilon_i \\
&amp; \mathrm{where}\quad \epsilon_i \sim \mathcal{N}(0, \sigma^2_{\epsilon})
\end{split}
\]</span></p>
<p>We have four unknowns in this model that need to be estimated: <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, and <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. This last unknown is the error (or residual) variance. As a side note, when you report results from a fitted regression model, you should report the estimated residual variance (or residual standard error) along with the coefficient estimates.</p>
<p>Aside from the estimates for the coefficients and RSE, we are also generally interested in the estimates of uncertainty for the coefficients (i.e., the standard errors). These uncertainty estimates also allow us to carry out hypothesis tests on the effects included in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(income <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> education <span class="sc">+</span> seniority, <span class="at">data =</span> city)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In practice, all of the estimates, SEs, and inferential output are available using functionality in R. For example, the model-level output, including <span class="math inline">\(R^2\)</span>, the <em>F</em>-statistic, the model and residual <em>df</em>, and the residual standard error are all outputted from the <code>glance()</code> function from the <code>{broom}</code> package. We can also partition the variation using the <code>anova()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic       p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.742         0.724  7.65      41.7 0.00000000298     2  -109.  226.  232.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition the variation</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: income
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
education  1 4147.3  4147.3  70.944 2.781e-09 ***
seniority  1  722.9   722.9  12.366   0.00146 ** 
Residuals 29 1695.3    58.5                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Similarly the <code>tidy()</code> function from the <code>{broom}</code> package outputs coefficient-level output, including the coefficients, standard errors, <em>t</em>-values, and associated <em>p</em>-values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.1</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term        estimate std.error statistic     p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    6.77      5.37       1.26 0.218         -4.22      17.8 
2 education      2.25      0.335      6.73 0.000000220    1.57       2.94
3 seniority      0.739     0.210      3.52 0.00146        0.309      1.17</code></pre>
</div>
</div>
<p>Our goal here is to understand how the probability distributions play a role in determining some of these values.</p>
<p><br></p>
</section>
<section id="model-level-inference-the-f-distribution" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="model-level-inference-the-f-distribution"><span class="header-section-number">5.7</span> Model-Level Inference: The <em>F</em>-Distribution</h2>
<p>At the model-level, we are interested in whether or not the model (as a whole) explains variation in the outcome. Our estimate of how much variation the model explains is based on partitioning the total variation of the outcome (<span class="math inline">\(\mathrm{SS}_{\mathrm{Total}}\)</span>) into that which is explained by the model (<span class="math inline">\(\mathrm{SS}_{\mathrm{Model}}\)</span>) and that which is not explained by the model (<span class="math inline">\(\mathrm{SS}_{\mathrm{Residual}}\)</span>). From the <code>anova()</code> output:</p>
<p><span class="math display">\[
\begin{split}
\mathrm{SS}_{\mathrm{Model}} &amp;= 4147.3 + 722.9 = 4870.2\\[1ex]
\mathrm{SS}_{\mathrm{Residual}} &amp;= 1695.3\\[1ex]
\mathrm{SS}_{\mathrm{Total}} &amp;= 4870.2 + 1695.3 = 6565.5
\end{split}
\]</span></p>
<p>Then we compute the a statistic called <span class="math inline">\(R^2\)</span> by computing the ratio of the explained variation to the total variation.</p>
<p><span class="math display">\[
R^2 = \frac{4870.2}{6565.5} = 0.742
\]</span></p>
<p>The model (differences in education and seniority levels) explains 74.2% of the variation in employee’s incomes in the sample. We might also want to test whether this is more variation than we expect because of sampling error. To do this we want to test the hypothesis that:</p>
<p><span class="math display">\[
H_0: \rho^2 = 0
\]</span></p>
<p>To evaluate this we convert the sample <span class="math inline">\(R^2\)</span> value into a test statistic using,</p>
<p><span class="math display">\[
F = \frac{R^2}{1 - R^2} \times \frac{\mathit{df}_{\mathrm{Error}}}{\mathit{df}_{\mathrm{Model}}}
\]</span></p>
<p>The degrees of freedom (<em>df</em>) is also partitioned in the <code>anova()</code> output:</p>
<p><span class="math display">\[
\begin{split}
\mathrm{df}_{\mathrm{Model}} &amp;= 1 + 1 = 2\\[1ex]
\mathrm{df}_{\mathrm{Residual}} &amp;= 29\\[1ex]
\mathrm{df}_{\mathrm{Total}} &amp;= 2 + 29 = 31
\end{split}
\]</span></p>
<p>Converting our <span class="math inline">\(R^2\)</span> value of 0.742 value to an <em>F</em>-statistic:</p>
<p><span class="math display">\[
\begin{split}
F &amp;= \frac{0.742}{1-0.742} \times \frac{29}{2} \\
&amp;= 41.7
\end{split}
\]</span></p>
<p>We write this standardization of <span class="math inline">\(R^2\)</span> as <span class="math inline">\(F(2,29)=41.7\)</span>.</p>
<p><br></p>
<section id="computing-f-from-the-anova-partitioning" class="level3" data-number="5.7.1">
<h3 data-number="5.7.1" class="anchored" data-anchor-id="computing-f-from-the-anova-partitioning"><span class="header-section-number">5.7.1</span> Computing F from the ANOVA Partitioning</h3>
<p>We can also compute the model-level <em>F</em>-statistic directly using the partitioning of variation from the ANOVA table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition the variation</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: income
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
education  1 4147.3  4147.3  70.944 2.781e-09 ***
seniority  1  722.9   722.9  12.366   0.00146 ** 
Residuals 29 1695.3    58.5                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The <em>F</em>-statistic is a ratio of the mean square for the model and the mean square for the error. To compute a mean square we use the general formula:</p>
<p><span class="math display">\[
\mathrm{MS} = \frac{\mathrm{SS}}{\mathrm{df}}
\]</span></p>
<p>The model includes both the education and seniority predictor, so we combine the SS and df. The MS model is:</p>
<p><span class="math display">\[
\begin{split}
\mathrm{MS}_{\mathrm{Model}} &amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{df}_{\mathrm{Model}}} \\[1ex]
&amp;= \frac{4147.3 + 722.9}{1 + 1} \\[1ex]
&amp;= \frac{4870.2}{2} \\[1ex]
&amp;= 2435.1
\end{split}
\]</span></p>
<p>The MS error is:</p>
<p><span class="math display">\[
\begin{split}
\mathrm{MS}_{\mathrm{Error}} &amp;= \frac{\mathrm{SS}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Error}}} \\[1ex]
&amp;= \frac{1695.3 }{29} \\[1ex]
&amp;= 58.5
\end{split}
\]</span></p>
<p>Then, we compute the <em>F</em>-statistic by computing the ratio of these two mean squares.</p>
<p><span class="math display">\[
\begin{split}
F &amp;= \frac{\mathrm{MS}_{\mathrm{Model}}}{\mathrm{MS}_{\mathrm{Error}}} \\[1ex]
&amp;= \frac{2435.1}{58.5} \\[1ex]
&amp;= 41.6
\end{split}
\]</span></p>
<p>Since a mean square represents the average amount of variation (per degree of freedom), we can see that <em>F</em> is a ratio between the average amount of variation explained by the model and the average amount of variation unexplained by the model. In our example, this ratio is 41.6; on average the model explains 41.6 times the variation that is unexplained.</p>
<p>Note that this is an identical computation (although reframed) as the initial computation for <em>F</em>. We can use mathematics to show this equivalence:</p>
<p><span class="math display">\[
\begin{split}
F &amp;= \frac{R^2}{1-R^2} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} \\[1ex]
&amp;= \frac{\frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{SS}_{\mathrm{Total}}}}{\frac{\mathrm{SS}_{\mathrm{Error}}}{\mathrm{SS}_{\mathrm{Total}}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} \\[1ex]
&amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{SS}_{\mathrm{Error}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} \\[1ex]
&amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{df}_{\mathrm{Model}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{SS}_{\mathrm{Error}}} \\[1ex]
&amp;= \mathrm{MS}_{\mathrm{Model}} \times \frac{1}{\mathrm{MS}_{\mathrm{Error}}}\\[1ex]
&amp;= \frac{\mathrm{MS}_{\mathrm{Model}}}{\mathrm{MS}_{\mathrm{Error}}}
\end{split}
\]</span></p>
<p><br></p>
</section>
<section id="testing-the-model-level-null-hypothesis" class="level3" data-number="5.7.2">
<h3 data-number="5.7.2" class="anchored" data-anchor-id="testing-the-model-level-null-hypothesis"><span class="header-section-number">5.7.2</span> Testing the Model-Level Null Hypothesis</h3>
<p>We evaluate our test statistic (<em>F</em> in this case) in the appropriate test distribution, in this case an <em>F</em>-distribution with 2 and 29 degrees of freedom. The figure below, shows the <span class="math inline">\(F(2,29)\)</span>-distribution as a solid, black line. The <em>p</em>-value is the area under the curve that is at least as extreme as the observed <em>F</em>-value of 41.7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>fig_11 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">50</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter shaded area</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>shade <span class="ot">=</span> fig_11 <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="fl">41.7</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_11, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-11" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of the probability density function (PDF) for the F(2,~29)-distribution. The cumulative density representing the p-value for a test evaluating whether rho-squared=0 using an observed F-statistic of 41.7 is also displayed.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-01-mathematical-foundations-probability-density_files/figure-html/fig-11-1.png" class="img-fluid figure-img" style="width:80.0%" alt="Plot of the probability density function (PDF) for the F(2,~29)-distribution. The cumulative density representing the p-value for a test evaluating whether rho-squared=0 using an observed F-statistic of 41.7 is also displayed.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.11: Plot of the probability density function (PDF) for the <span class="math inline">\(F(2,~29)\)</span>-distribution. The cumulative density representing the <em>p</em>-value for a test evaluating whether <span class="math inline">\(\rho^2=0\)</span> using an observed <em>F</em>-statistic of 41.7 is also displayed.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The computation using the cumulative density function, <code>pf()</code>, to obtain the <em>p</em>-value is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for F(2,29)=41.7</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="fl">41.7</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.942114e-09</code></pre>
</div>
</div>
<p>Because we want the upper-tail, rather than taking the difference from 1, we can also use the <code>lower.tail=FALSE</code> argument in <code>pf()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for F(2,29)=41.7</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">41.7</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.942114e-09</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="mean-squares-are-variance-estimates" class="level3" data-number="5.7.3">
<h3 data-number="5.7.3" class="anchored" data-anchor-id="mean-squares-are-variance-estimates"><span class="header-section-number">5.7.3</span> Mean Squares are Variance Estimates</h3>
<p>Mean squares are also estimates of the <em>variance</em>. Consider the computational formula for the sample variance,</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{\sum(Y - \bar{Y})^2}{n-1}
\]</span></p>
<p>This is the total sum of squares divided by the total <em>df</em>. The variance of the outcome variable is interpreted as the average amount of variation in the outcome variable (in the squared metric). Thus, it is also referred to as the mean square total.</p>
<p>When we compute an <em>F</em>-statistic, we are finding the ratio of two different variance estimates—one based on the model (explained variance) and one based on the error (unexplained variance). Under the null hypothesis that <span class="math inline">\(\rho^2 = 0\)</span>, we are assuming that all the variance is unexplained. In that case, our <em>F</em>-statistic would be close to zero. When the model explains a significant amount of variation, the numerator gets larger relative to the denominator and the <em>F</em>-value is larger.</p>
<p>The mean squared error (from the <code>anova()</code> output) plays a special role in regression analysis. It is the variance estimate for the conditional distributions of the residuals in our visual depiction of the distributional assumptions of the residuals underlying linear regression.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-12" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Visual Depiction of the Distributional Assumptions of the Residuals Underlying Linear Regression">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figs/04-regression-assumptions-residuals.png" class="img-fluid figure-img" style="width:70.0%" alt="Visual Depiction of the Distributional Assumptions of the Residuals Underlying Linear Regression">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.12: Visual Depiction of the Distributional Assumptions of the Residuals Underlying Linear Regression
</figcaption>
</figure>
</div>
</div>
</div>
<p>Recall that we made implicit assumptions about the conditional distributions of the residuals, namely that they were identically and normally distributed with a mean of zero and some variance. Based on the estimate of the mean squared error, the variance of each of these distributions is 58.5.</p>
<p>While the variance is a mathematical convenience, the standard deviation is often a better descriptor of the variation in a distribution since it is measured in the original metric. The standard deviation fro the residuals (error) is 7.6. Because the residuals are statistics (summaries computed from sample data), their standard deviation is referred to as a “standard error”.</p>
<div class="fyi">
<p>The <em>residual standard error</em> (RSE) is sometimes referred to as the <em>Root Mean Squared Error</em> (RMSE).</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fl">58.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.648529</code></pre>
</div>
</div>
<p>Why is this value important? It gives the expected variation in the conditional residual distributions, which is a measure of the average amount of error. For example, since all of the conditional distributions of the residuals are assumed to be normally distributed, we would expect that 95% of the residuals would fall between <span class="math inline">\(\pm2\)</span> standard errors from 0; or, in this case, between <span class="math inline">\(-15.3\)</span> and <span class="math inline">\(+15.3\)</span>. Observations with residuals that are more extreme may be regression outliers.</p>
<p>More importantly, it is a value that we need to estimate in order to specify the model.</p>
<p><br></p>
</section>
</section>
<section id="coefficent-level-inference-the-t-distribution" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="coefficent-level-inference-the-t-distribution"><span class="header-section-number">5.8</span> Coefficent-Level Inference: The <em>t</em>-Distribution</h2>
<p>Recall that the coefficients and SEs for the coefficients are computed directly from the raw data based on the OLS estimation. These can then be uses to construct a test statistic (e.g., <em>t</em>) to carry out a hypothesis test or compute endpoints for a confidence interval. To see how this is done, we will consider the partial effect of education level (after controlling for differences in seniority) in our fitted model.</p>
<p><span class="math display">\[
\begin{split}
\hat\beta_{\mathrm{Education}}&amp;=2.25 \\[1ex]
\mathrm{SE}(\hat\beta_{\mathrm{Education}}) &amp;=0.335
\end{split}
\]</span></p>
<p>We might want to test whether the partial effect of education level on income, after accounting for differences in seniority level, we observed in the data is more than we would expect because of sampling error. To answer this we need to evaluate the following hypothesis:</p>
<p><span class="math display">\[
H_0: \beta_{\mathrm{Education}} = 0
\]</span></p>
<p>We begin by converting our estimated regression coefficient to a <em>t</em>-statistic using:</p>
<p><span class="math display">\[
t_k = \frac{\hat\beta_k}{\mathrm{SE}(\hat\beta_k)}
\]</span></p>
<p>In our example,</p>
<p><span class="math display">\[
\begin{split}
t_{\mathrm{Education}} &amp;= \frac{2.25}{0.335} \\[1ex]
&amp;= 6.72
\end{split}
\]</span></p>
<p>Remember this tells us the education coefficient of 2252 is 6.72 standard errors above 0. Since we are estimating the SE using sample data, our test statistic is likely <em>t</em>-distributed<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Which value should we use for <em>df</em>? Well, for that, statistical theory tells us that we should use the error <em>df</em> value from the model. In our example, this would be:</p>
<p><span class="math display">\[
t(29) = 6.72
\]</span></p>
<p>Using the <em>t</em>-distribution with 29 <em>df</em>, we can compute the <em>p</em>-value associated with the two-tailed test that <span class="math inline">\(\beta_{\mathrm{Education}=0}\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for the two-tailed test of no effect of education</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="sc">-</span><span class="fl">6.72</span>, <span class="at">df =</span> <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.257125e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fl">6.72</span>, <span class="at">df =</span> <span class="dv">29</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.257125e-07</code></pre>
</div>
</div>
<p>The <em>p</em>-value is 0.0000002. The data are inconsistent with the hypothesis that there is no partial effect of education level on income (after accounting for differences in seniority level).</p>
<p>We could also carry out these tests for the partial effect of seniority level and, if it is of interest, for the intercept. For both of those tests, we would use the same <em>t</em>-distribution, but our test statistic would be computed based on the coefficient estimates and standard errors for those terms, respectively.</p>
<p><br></p>
<section id="confidencecompatibility-intervals-for-the-coefficients" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="confidencecompatibility-intervals-for-the-coefficients"><span class="header-section-number">5.8.1</span> Confidence/Compatibility Intervals for the Coefficients</h3>
<p>The confidence interval for the <em>k</em>th regression coefficient is computed as:</p>
<p><span class="math display">\[
\mathrm{CI} = \hat\beta_k \pm t^{*}(\mathrm{SE}_{\hat\beta_k})
\]</span></p>
<p>where <span class="math inline">\(t^*\)</span> is the quantile of the <em>t</em>-distribution that defines the confidence level for the interval. (This <em>t</em>-distribution, again, has degrees-of-freedom equal to the error <em>df</em> in the model.) The confidence level is related to the alpha level (type I error rate) used in inference. Namely,</p>
<p><span class="math display">\[
\mathrm{Confidence~Level} = 1 - \alpha
\]</span></p>
<p>So, if you use <span class="math inline">\(\alpha=.05\)</span>, then the confidence level would be <span class="math inline">\(.95\)</span>, and we would call this a 95% confidence interval. The alpha value also helps determine the quantile we use in the CI formula,</p>
<p><span class="math display">\[
t^* = (1-\frac{\alpha}{2}) ~ \mathrm{quantile}
\]</span> For the example using <span class="math inline">\(\alpha=.05\)</span>, a 95% confidence interval, the <span class="math inline">\(t^*\)</span> value would be associated with the quantile of 0.975. We would denote this as:</p>
<p><span class="math display">\[
t^{*}_{.975}
\]</span></p>
<p>Say we wanted to find the 95% confidence interval for the education coefficient. We know that the estimated coefficient for education is 2.25, and the standard error for this estimate is 0.335. We also know that based on the model fitted, the residual <em>df</em> is 29. We need to find the 0.975th quantile in the <em>t</em>-distribution with 29 <em>df</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find 0.975th quantile</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">29</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.04523</code></pre>
</div>
</div>
<p>Now we can use all of this information to compute the confidence interval:</p>
<p><span class="math display">\[
\begin{split}
95\%~CI  &amp;= 2.25 \pm 2.04523(0.335) \\[1ex]
&amp;= \big[1.56,~2.94\big]
\end{split}
\]</span></p>
<p><br></p>
</section>
</section>
<section id="learn-more" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="learn-more"><span class="header-section-number">5.9</span> Learn More</h2>
<p>For more information, you can also see the section <em>Some Continuous Distributions</em> in CHapter 5 of the <span class="citation" data-cites="Fox:2021">Fox (<a href="#ref-Fox:2021" role="doc-biblioref">2021</a>)</span> textbook.</p>
<p><br></p>
</section>
<section id="references" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="references"><span class="header-section-number">5.10</span> References</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Fox:2021" class="csl-entry" role="listitem">
Fox, J. (2021). <em>A mathematical primer for social statistics</em> (2nd ed.). Sage.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Remember, the mean and standard deviations in the population are called “parameters”.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Whether this is actually <em>t</em>-distributed depends on whether the model assumptions are met.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-00-likelihood.html" class="pagination-link" aria-label="Likelihood">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Likelihood</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-03-likelihood-framework-for-evidence.html" class="pagination-link" aria-label="Likelihood: A Framework for Evidence">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Evidence</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb60" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Mathematical Foundations: Probability Density</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>Understanding ideas about probability distributions (especially continuous probability distributions) is essential for understanding likelihood.</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## Terminology and Basic Ideas of Probability Distributions</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>A probability distribution is simply a mapping of every outcome in the sample space to a probability. (It is conventional to use *x* to denote the outcomes.) This mapping can take many forms such a list, a plot, or an equation. All are reasonable to define the probability distribution, although some of these are more typical for discrete variables (e.g., list, plot), while others are more typical for continuous distributions (e.g., plot, equation). Here are a couple different probability distributions:</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-01</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "An example of a discrete and continuous probability distribution."</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "An example of a discrete and continuous probability distribution."</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figs/04-probability-distributions-example.png"</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>In general, the probability of an outcome (*p(x)*) is defined as the number of times an outcome appears in the sample space divided by the total number of outcomes. So, for example, in the probability experiment of flipping a fair coin twice, the sample space is:</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>S = <span class="sc">\{</span>HH,~HT,~TH,~TT<span class="sc">\}</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>The probability of a head and a tail (assuming order doesn't matter) is:</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>p(HT~\mathrm{or}~TH) = \frac{2}{4} = 0.5</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>This falls apart when we move to continuous distributions. For example, consider finding the probability of a zero occurring in the standard normal distribution given in @fig-01. The sample space includes every outcome possible and is:</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>S = <span class="sc">\{</span>-\infty, ~ +\infty<span class="sc">\}</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>so the probability of zero (which occurs once in that sample space) is:</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>p(0) = \frac{1}{\infty} \approx 0</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>Likewise the probability of 1 or 2 is also:</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>p(1) = \frac{1}{\infty} \approx 0 <span class="sc">\\</span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>p(2) = \frac{1}{\infty} \approx 0 </span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>In fact the probability of every possible outcome is 0. The problem is that if we add all the probabilities together, we have to get 1 (Law of Probability), and in this case we don't; the sum of $0 + 0 + \ldots + 0 = 0$. Because of this, in continuous distributions, we typically compute the probability of a range of values. For example, in our standard normal distribution:</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>p(x \leq 0) = 0.5 <span class="sc">\\</span></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>p(-1 \leq x \leq 1) = 0.68 <span class="sc">\\</span></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>p(-2 \leq x \leq 2) = 0.95</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Density</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>In a continuous distribution we also need to account be able to talk about the fact that some outcomes are more likely than other outcomes. For example, in our standard normal distribution outcomes near zero are more probable than outcomes near 1, which are more probable than outcomes near 2, etc. Since we can't use probability to do this (remember the probability of each outcome is the same, namely 0), we use something called *probability density*. This is akin to a relative probability, so outcomes with a higher probability density are more likely than outcomes with a lower probability density.</span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>The mapping of all the outcomes to their probability densities is called a *probability density function* (PDF). Thus the equation or "bell-shaped" curve describing the standard normal distribution in @fig-01 is technically a PDF Here are some laws governing PDFs:</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Probability densities are always positive.</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The probability of an outcome *x* between *a* and *b* equals the integral (area under the curve) between *a* and *b* of the probability density function. That is: </span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a>p(a \leq x \leq b) = \int_a^b p(x) dx</span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The area under the curve from negative infinity to positive infinity is 1. That is: </span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a>p(-\infty \leq x \leq +\infty) = \int_{-\infty}^{+\infty} p(x) = 1</span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a>Next we will look at the PDF for a normal distribution.</span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a><span class="fu">## PDF for a Normal (Gaussian) Distribution</span></span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a>The probability density function (PDF) of a normal distribution is mathematically defined as:</span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a>p(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left<span class="co">[</span><span class="ot">-\frac{(x-\mu)^2}{2\sigma^2}\right</span><span class="co">]</span></span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a>for $-\infty \leq x \leq \infty$. </span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a>To calculate the probability density, we need three pieces of information: (1) the outcome (*x*-value) for which we want to determine the probability density, (2) the mean ($\mu$) of the normal distribution *x* is a member of, and (3) the standard deviation ($\sigma$) of the normal distribution *x* is a member of. Then, we can compute the probability density ($p(x)$) for a particular $x$ value by using the equation.</span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a>As an example, consider a normal distribution with a mean of 50, and a standard deviation of 10. The probability density for $x=65$ can be found using,</span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a>p(65) &amp;= \frac{1}{10\sqrt{2\pi}}\exp\left<span class="co">[</span><span class="ot">-\frac{(65-50)^2}{2\times10^2}\right</span><span class="co">]</span> <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a>&amp;= 0.01295176</span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a>Using R, we can carry out the computation,</span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(50,10)</span></span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">10</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">225</span>) <span class="sc">/</span> <span class="dv">200</span>)</span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a>There is also a more direct way to compute this using the <span class="in">`dnorm()`</span> function. This function computes the density of <span class="in">`x`</span> from a normal distribution with a specified <span class="in">`mean`</span> and <span class="in">`sd`</span>.</span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(50,10)</span></span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb60-131"><a href="#cb60-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-132"><a href="#cb60-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-133"><a href="#cb60-133" aria-hidden="true" tabindex="-1"></a>Symbolically, we might write</span>
<span id="cb60-134"><a href="#cb60-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-135"><a href="#cb60-135" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-136"><a href="#cb60-136" aria-hidden="true" tabindex="-1"></a>P\bigg(x=65 \mid \mathcal{N}(50,10)\bigg) = 0.01295176</span>
<span id="cb60-137"><a href="#cb60-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-138"><a href="#cb60-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-139"><a href="#cb60-139" aria-hidden="true" tabindex="-1"></a>which is read:</span>
<span id="cb60-140"><a href="#cb60-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-141"><a href="#cb60-141" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The probability density of $x=65$ GIVEN the normal distribution having a mean of 50 and standard deviation of 10 is equal to 0.013.</span></span>
<span id="cb60-142"><a href="#cb60-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-143"><a href="#cb60-143" aria-hidden="true" tabindex="-1"></a>Note that the probability density for a value is not only a function of *x*, but also depends on the mean and standard deviation of the normal distribution. For example, the probability density of $x=65$ in the normal distribution having a mean of 30 and standard deviation of 20 is a different value than the probability density we found earlier.</span>
<span id="cb60-144"><a href="#cb60-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-147"><a href="#cb60-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-148"><a href="#cb60-148" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the probability density of x=65 in N(30,20)</span></span>
<span id="cb60-149"><a href="#cb60-149" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb60-150"><a href="#cb60-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-151"><a href="#cb60-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-152"><a href="#cb60-152" aria-hidden="true" tabindex="-1"></a>Here, </span>
<span id="cb60-153"><a href="#cb60-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-154"><a href="#cb60-154" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-155"><a href="#cb60-155" aria-hidden="true" tabindex="-1"></a>P\bigg(x=65 \mid \mathcal{N}(30,20)\bigg) = 0.004313866</span>
<span id="cb60-156"><a href="#cb60-156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-157"><a href="#cb60-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-158"><a href="#cb60-158" aria-hidden="true" tabindex="-1"></a>In general, when we think about the normal distribution, we are thinking about the mapping of each *x*-value from $-\infty$ to $+\infty$ to its associated probability density. Rather than list each of these mappings out, we can create a plot of these mappings. This plot gives us the familiar "bell shape". Theoretically this plot is the graphical depiction of the PDF.</span>
<span id="cb60-159"><a href="#cb60-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-162"><a href="#cb60-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-163"><a href="#cb60-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-02</span></span>
<span id="cb60-164"><a href="#cb60-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb60-165"><a href="#cb60-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb60-166"><a href="#cb60-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb60-167"><a href="#cb60-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for a N(50,10) distribution (blue, solid line) and for a N(30,20) distribution (red, dashed line). The probability density value for x=65 is also displayed on both PDFs."</span></span>
<span id="cb60-168"><a href="#cb60-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for a $\\mathcal{N}(50,10)$ distribution (blue, solid line) and for a $\\mathcal{N}(30,20)$ distribution (red, dashed line). The probability density value for $x=65$ is also displayed on both PDFs."</span></span>
<span id="cb60-169"><a href="#cb60-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-170"><a href="#cb60-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb60-171"><a href="#cb60-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-172"><a href="#cb60-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-173"><a href="#cb60-173" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb60-174"><a href="#cb60-174" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-175"><a href="#cb60-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">40</span>, <span class="at">to =</span> <span class="dv">90</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-176"><a href="#cb60-176" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-177"><a href="#cb60-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-178"><a href="#cb60-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y1 =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb60-179"><a href="#cb60-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y2 =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">30</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb60-180"><a href="#cb60-180" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-181"><a href="#cb60-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-182"><a href="#cb60-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-183"><a href="#cb60-183" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y1)) <span class="sc">+</span></span>
<span id="cb60-184"><a href="#cb60-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#0085af"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb60-185"><a href="#cb60-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y2), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#c62f4b"</span>) <span class="sc">+</span></span>
<span id="cb60-186"><a href="#cb60-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb60-187"><a href="#cb60-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-188"><a href="#cb60-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb60-189"><a href="#cb60-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">y =</span> <span class="fl">0.01295176</span>,  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#0085af"</span>) <span class="sc">+</span></span>
<span id="cb60-190"><a href="#cb60-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">65</span>, <span class="at">y =</span> <span class="fl">0.004313866</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#c62f4b"</span>)</span>
<span id="cb60-191"><a href="#cb60-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-192"><a href="#cb60-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-193"><a href="#cb60-193" aria-hidden="true" tabindex="-1"></a>Of course, the PDF is different for normal distributions with different means ($\mu$) or standard deviations ($\sigma$). This implies that there is not one normal distribution, but rather an infinite number of normal distributions, each with a different mean or standard deviation. (We refer to the normal distribution as a "family" of distributions.)</span>
<span id="cb60-194"><a href="#cb60-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-195"><a href="#cb60-195" aria-hidden="true" tabindex="-1"></a>To completely define the PDF we need to specify the mean and standard deviation we are using to compute the probability densities. Specifying these values is referred to as *parameterizing the distribution*^<span class="co">[</span><span class="ot">Remember, the mean and standard deviations in the population are called "parameters".</span><span class="co">]</span>.</span>
<span id="cb60-196"><a href="#cb60-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-197"><a href="#cb60-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-198"><a href="#cb60-198" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-199"><a href="#cb60-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-200"><a href="#cb60-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-201"><a href="#cb60-201" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other Useful R Functions for Working with Normal Probability Distributions</span></span>
<span id="cb60-202"><a href="#cb60-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-203"><a href="#cb60-203" aria-hidden="true" tabindex="-1"></a>We use <span class="in">`dnorm()`</span> when we want to compute the probability density associated with a particular *x*-value in a given normal distribution. There are three other functions that are quite useful for working with the normal probability distribution:</span>
<span id="cb60-204"><a href="#cb60-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-205"><a href="#cb60-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pnorm()`</span> : To compute the probability (area under the PDF)</span>
<span id="cb60-206"><a href="#cb60-206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`qnorm()`</span> : To compute the $x$ value given a particular probability</span>
<span id="cb60-207"><a href="#cb60-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`rnorm()`</span> : To draw a random observation from the distribution</span>
<span id="cb60-208"><a href="#cb60-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-209"><a href="#cb60-209" aria-hidden="true" tabindex="-1"></a>Each of these function also requires the arguments <span class="in">`mean=`</span> and <span class="in">`sd=`</span>. Below we will examine how to use each of these additional functions.</span>
<span id="cb60-210"><a href="#cb60-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-211"><a href="#cb60-211" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-212"><a href="#cb60-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-213"><a href="#cb60-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-214"><a href="#cb60-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### pnorm(): Computing Cumulative Probability Density</span></span>
<span id="cb60-215"><a href="#cb60-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-216"><a href="#cb60-216" aria-hidden="true" tabindex="-1"></a>The function <span class="in">`pnorm()`</span> computes the area under the PDF curve from $-\infty$ to some *x*-value. (Sometimes this is referred to as the cumulative probability density of *x*.) It is important to note that the PDF is defined such that the entire area under the curve is equal to 1. Because of this, we can also think about using area under the curve as an analog to probability in a continuous distribution.</span>
<span id="cb60-217"><a href="#cb60-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-218"><a href="#cb60-218" aria-hidden="true" tabindex="-1"></a>For example, we might ask about the probability of observing an *x*-value that is less than or equal to 65 given it is from a $\mathcal{N}(50,10)$ distribution. Symbolically, we want to find:</span>
<span id="cb60-219"><a href="#cb60-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-220"><a href="#cb60-220" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-221"><a href="#cb60-221" aria-hidden="true" tabindex="-1"></a>P\bigg(x \leq 65 \mid \mathcal{N}(50,10)\bigg) </span>
<span id="cb60-222"><a href="#cb60-222" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-223"><a href="#cb60-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-224"><a href="#cb60-224" aria-hidden="true" tabindex="-1"></a>This is akin to finding the proportion of the area under the $\mathcal{N}(50,10)$ PDF that is to the left of 65. The figure below shows a graphical depiction of the cumulative probability density for $x=65$.</span>
<span id="cb60-225"><a href="#cb60-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-228"><a href="#cb60-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-229"><a href="#cb60-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-03</span></span>
<span id="cb60-230"><a href="#cb60-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb60-231"><a href="#cb60-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for a N(50,10) distribution. The area that is shaded grey (relative to the total area under the PDF) represents the cumulative probability density for x=65."</span></span>
<span id="cb60-232"><a href="#cb60-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for a N(50,10) distribution. The area that is shaded grey (relative to the total area under the PDF) represents the cumulative probability density for x=65."</span></span>
<span id="cb60-233"><a href="#cb60-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-234"><a href="#cb60-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb60-235"><a href="#cb60-235" aria-hidden="true" tabindex="-1"></a>fig_03 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-236"><a href="#cb60-236" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">90</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-237"><a href="#cb60-237" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-238"><a href="#cb60-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-239"><a href="#cb60-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb60-240"><a href="#cb60-240" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-241"><a href="#cb60-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-242"><a href="#cb60-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out X&lt;=65</span></span>
<span id="cb60-243"><a href="#cb60-243" aria-hidden="true" tabindex="-1"></a>shaded <span class="ot">=</span> fig_03 <span class="sc">%&gt;%</span></span>
<span id="cb60-244"><a href="#cb60-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&lt;=</span> <span class="dv">65</span>)</span>
<span id="cb60-245"><a href="#cb60-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-246"><a href="#cb60-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-247"><a href="#cb60-247" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_03, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb60-248"><a href="#cb60-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shaded, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-249"><a href="#cb60-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-250"><a href="#cb60-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span></span>
<span id="cb60-251"><a href="#cb60-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-252"><a href="#cb60-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb60-253"><a href="#cb60-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-254"><a href="#cb60-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-255"><a href="#cb60-255" aria-hidden="true" tabindex="-1"></a>We can compute the cumulative probability density using the <span class="in">`pnorm()`</span> function. The "p" stand for "probability".</span>
<span id="cb60-256"><a href="#cb60-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-259"><a href="#cb60-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-260"><a href="#cb60-260" aria-hidden="true" tabindex="-1"></a><span class="co"># Find P(x&lt;=65 | N(50,10) )</span></span>
<span id="cb60-261"><a href="#cb60-261" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">65</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb60-262"><a href="#cb60-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-263"><a href="#cb60-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-264"><a href="#cb60-264" aria-hidden="true" tabindex="-1"></a>We can interpret this as:</span>
<span id="cb60-265"><a href="#cb60-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-266"><a href="#cb60-266" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The probability of observing an *x*-value that is less than or equal to 65 (if it is drawn from a normal distribution with a mean of 50 and standard deviation of 10) is 0.933.</span></span>
<span id="cb60-267"><a href="#cb60-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-268"><a href="#cb60-268" aria-hidden="true" tabindex="-1"></a>In mathematics, the area under a curve is called an *integral*. The grey-shaded area in the previous figure can also be expressed as an integral of the probability density function:</span>
<span id="cb60-269"><a href="#cb60-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-270"><a href="#cb60-270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-271"><a href="#cb60-271" aria-hidden="true" tabindex="-1"></a>\int_{-\infty}^{65} p(x) dx</span>
<span id="cb60-272"><a href="#cb60-272" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-273"><a href="#cb60-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-274"><a href="#cb60-274" aria-hidden="true" tabindex="-1"></a>where $p(x)$ is the PDF for the normal distribution. </span>
<span id="cb60-275"><a href="#cb60-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-276"><a href="#cb60-276" aria-hidden="true" tabindex="-1"></a>The most common application for finding the cumulative density is to compute a *p*-value. The *p*-value is just the area under the distribution (curve) that is AT LEAST as extreme as some observed value. For example, assume we computed a test statistic of $z=2.5$, and were evaluating whether this was different from 0 (two-tailed test). Graphically, we want to determine the proportion of the area under the PDF that is shaded grey in the figure below.</span>
<span id="cb60-277"><a href="#cb60-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-280"><a href="#cb60-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-281"><a href="#cb60-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-04</span></span>
<span id="cb60-282"><a href="#cb60-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb60-283"><a href="#cb60-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for the standard normal distribution (M=0, SD=1). The cumulative density representing the p-value for a two-tailed test evaluating whether mu=0 using an observed mean of 2.5 is also displayed."</span></span>
<span id="cb60-284"><a href="#cb60-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for the standard normal distribution ($M=0$, $SD=1$). The cumulative density representing the *p*-value for a two-tailed test evaluating whether $\\mu=0$ using an observed mean of 2.5 is also displayed."</span></span>
<span id="cb60-285"><a href="#cb60-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-286"><a href="#cb60-286" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb60-287"><a href="#cb60-287" aria-hidden="true" tabindex="-1"></a>fig_04 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-288"><a href="#cb60-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-289"><a href="#cb60-289" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-290"><a href="#cb60-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-291"><a href="#cb60-291" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-292"><a href="#cb60-292" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-293"><a href="#cb60-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-294"><a href="#cb60-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for shading</span></span>
<span id="cb60-295"><a href="#cb60-295" aria-hidden="true" tabindex="-1"></a>shade_01 <span class="ot">=</span> fig_04 <span class="sc">%&gt;%</span></span>
<span id="cb60-296"><a href="#cb60-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="fl">2.5</span>)</span>
<span id="cb60-297"><a href="#cb60-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-298"><a href="#cb60-298" aria-hidden="true" tabindex="-1"></a>shade_02 <span class="ot">=</span> fig_04 <span class="sc">%&gt;%</span></span>
<span id="cb60-299"><a href="#cb60-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fl">2.5</span>)</span>
<span id="cb60-300"><a href="#cb60-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-301"><a href="#cb60-301" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-302"><a href="#cb60-302" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_04, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb60-303"><a href="#cb60-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_01, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-304"><a href="#cb60-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_02, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-305"><a href="#cb60-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-306"><a href="#cb60-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"z"</span>) <span class="sc">+</span></span>
<span id="cb60-307"><a href="#cb60-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-308"><a href="#cb60-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb60-309"><a href="#cb60-309" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-310"><a href="#cb60-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-311"><a href="#cb60-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-312"><a href="#cb60-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-313"><a href="#cb60-313" aria-hidden="true" tabindex="-1"></a>If the distribution of the test statistic is normally distributed, we can use <span class="in">`pnorm()`</span> to compute the *p*-value. If we assume the test statistic, *z*, has been scaled to use standardized units, the standard deviation we use in <span class="in">`pnorm()`</span> will be <span class="in">`sd=1`</span>. The mean is based on the value being tested in the null hypothesis. In most null hypotheses, we are testing a difference from 0 (e.g., $H_0: \mu=0$, $H_0: \beta=0$), so we would use <span class="in">`mean=0`</span> in the <span class="in">`pnorm()`</span> function. </span>
<span id="cb60-314"><a href="#cb60-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-315"><a href="#cb60-315" aria-hidden="true" tabindex="-1"></a>Remember, <span class="in">`pnorm()`</span> computes the proportion of the area under the curve TO THE LEFT of a particular value. Here we will compute the area to the left of $-2.5$ and then double it to produce the actual *p*-value. (We can double it because the normal distribution is symmetric so the area to the left of $-2.5$ is the same as the area to the right of $+2.5$.)</span>
<span id="cb60-316"><a href="#cb60-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-319"><a href="#cb60-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-320"><a href="#cb60-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value based on z=2.5</span></span>
<span id="cb60-321"><a href="#cb60-321" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="at">q =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-322"><a href="#cb60-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-323"><a href="#cb60-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-324"><a href="#cb60-324" aria-hidden="true" tabindex="-1"></a>We interpret this *p*-value as:</span>
<span id="cb60-325"><a href="#cb60-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-326"><a href="#cb60-326" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The probability of observing a statistic at least as extreme as 2.5, assuming the null hypothesis is true, is 0.012. This is evidence against the null hypothesis since the data are inconsistent with the assumed hypothesis. </span></span>
<span id="cb60-327"><a href="#cb60-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-328"><a href="#cb60-328" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-329"><a href="#cb60-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-330"><a href="#cb60-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-331"><a href="#cb60-331" aria-hidden="true" tabindex="-1"></a><span class="fu">### qnorm(): Computing Quantiles</span></span>
<span id="cb60-332"><a href="#cb60-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-333"><a href="#cb60-333" aria-hidden="true" tabindex="-1"></a>The <span class="in">`qnorm()`</span> function is essentially the inverse of the <span class="in">`pnorm()`</span> function. The <span class="in">`pnorm()`</span> function computes the cumulative probability GIVEN a particular quantile (*x*-value). The `qnorm()` function computes the quantile GIVEN a cumulative probability. For example, in the $\mathcal{N}(50, 10)$ distribution, half of the area under the PDF is below the *x*-value (quantile) of 50.</span>
<span id="cb60-334"><a href="#cb60-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-335"><a href="#cb60-335" aria-hidden="true" tabindex="-1"></a>To use the <span class="in">`qnorm()`</span> function to give the *x*-value (quantile) that defines the lower 0.5 of the area under the $\mathcal{N}(50, 10)$ PDF, the syntax would be:</span>
<span id="cb60-336"><a href="#cb60-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-339"><a href="#cb60-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-340"><a href="#cb60-340" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the quantile that has a cumulative density of 0.5 in the N(50, 10) distribution</span></span>
<span id="cb60-341"><a href="#cb60-341" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.5</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb60-342"><a href="#cb60-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-343"><a href="#cb60-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-344"><a href="#cb60-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-345"><a href="#cb60-345" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-346"><a href="#cb60-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-347"><a href="#cb60-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-348"><a href="#cb60-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### rnorm(): Generating Random Observations</span></span>
<span id="cb60-349"><a href="#cb60-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-350"><a href="#cb60-350" aria-hidden="true" tabindex="-1"></a>The <span class="in">`rnorm()`</span> function can be used to generate random observations drawn from a specified normal distribution. Aside from the <span class="in">`mean=`</span> and <span class="in">`sd=`</span> arguments, we also need to specify the number of observations to generate by including the argument <span class="in">`n=`</span>. For example, to generate 15 observations drawn from a $\mathcal{N}(50,10)$ distribution we would use the following syntax:</span>
<span id="cb60-351"><a href="#cb60-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-354"><a href="#cb60-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-355"><a href="#cb60-355" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 15 observations from N(50,10)</span></span>
<span id="cb60-356"><a href="#cb60-356" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb60-357"><a href="#cb60-357" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb60-358"><a href="#cb60-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-359"><a href="#cb60-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-360"><a href="#cb60-360" aria-hidden="true" tabindex="-1"></a>The <span class="in">`set.seed()`</span> function sets the state of the random number generator used in R so that the results are reproducible. If you don't use <span class="in">`set.seed()`</span> you will get a different set of observations each time you run <span class="in">`rnorm()`</span>. Here we set the starting seed to 100, but you can set this to any integer you want.</span>
<span id="cb60-361"><a href="#cb60-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-362"><a href="#cb60-362" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-363"><a href="#cb60-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-364"><a href="#cb60-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-365"><a href="#cb60-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Student's *t*-Distribution</span></span>
<span id="cb60-366"><a href="#cb60-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-367"><a href="#cb60-367" aria-hidden="true" tabindex="-1"></a>The PDF of Student's *t*-distribution looks similar to the PDF for a standard normal distribution. In the figure below, Student's *t*-distribution is depicted with a solid, black line and the standard normal distribution ($M=0$, $SD=1$) is depicted with a dotted, red line.</span>
<span id="cb60-368"><a href="#cb60-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-371"><a href="#cb60-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-372"><a href="#cb60-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-05</span></span>
<span id="cb60-373"><a href="#cb60-373" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb60-374"><a href="#cb60-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for both the standard normal distribution (dotted, red line) and Student's t(5) distribution (solid, black line)."</span></span>
<span id="cb60-375"><a href="#cb60-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for both the standard normal distribution (dotted, red line) and Student's $t(5)$ distribution (solid, black line)."</span></span>
<span id="cb60-376"><a href="#cb60-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-377"><a href="#cb60-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb60-378"><a href="#cb60-378" aria-hidden="true" tabindex="-1"></a>fig_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-379"><a href="#cb60-379" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-380"><a href="#cb60-380" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-381"><a href="#cb60-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-382"><a href="#cb60-382" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_t =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">5</span>),</span>
<span id="cb60-383"><a href="#cb60-383" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y_norm =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb60-384"><a href="#cb60-384" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb60-385"><a href="#cb60-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-386"><a href="#cb60-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-387"><a href="#cb60-387" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_05, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y_t)) <span class="sc">+</span></span>
<span id="cb60-388"><a href="#cb60-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-389"><a href="#cb60-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Y_norm), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb60-390"><a href="#cb60-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span></span>
<span id="cb60-391"><a href="#cb60-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-392"><a href="#cb60-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb60-393"><a href="#cb60-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span>
<span id="cb60-394"><a href="#cb60-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-395"><a href="#cb60-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-396"><a href="#cb60-396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Both the standard normal distribution and Student's *t*-distribution are symmetric distributions.</span>
<span id="cb60-397"><a href="#cb60-397" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Both the standard normal distribution and Student's *t*-distribution have a mean (expected value) of 0. </span>
<span id="cb60-398"><a href="#cb60-398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The standard deviation for Student's *t*-distribution is, however, larger than the standard deviation for the standard normal distribution ($SD&gt;1$). You can see this in the distribution because the tails in Student's *t*-distribution are fatter (more error) than the standard normal distribution.</span>
<span id="cb60-399"><a href="#cb60-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-400"><a href="#cb60-400" aria-hidden="true" tabindex="-1"></a>In practice, we often use Student's *t*-distribution rather than the standard normal distribution in our evaluations of sample data. This is because the increased error (i.e., standard deviation) associated with Student's *t*-distribution better models the additional uncertainty associated with having incomplete information (i.e., a sample rather than the entire population).</span>
<span id="cb60-401"><a href="#cb60-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-402"><a href="#cb60-402" aria-hidden="true" tabindex="-1"></a>Student's *t*-distribution also constitutes a family of distributions; there is not a single *t*-distribution. The specific shape (and thus probability density) is defined by a parameter called the *degrees of freedom* (*df*). The plot below shows the standard normal distribution (purple) and four *t*-distributions with varying *df*-values. The means and standard deviations for each of these distributions is also provided in a table.</span>
<span id="cb60-403"><a href="#cb60-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-406"><a href="#cb60-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-407"><a href="#cb60-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-06</span></span>
<span id="cb60-408"><a href="#cb60-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb60-409"><a href="#cb60-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb60-410"><a href="#cb60-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb60-411"><a href="#cb60-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of several t-Distributions with differing degrees of freedom."</span></span>
<span id="cb60-412"><a href="#cb60-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of several *t*-Distributions with differing degrees of freedom."</span></span>
<span id="cb60-413"><a href="#cb60-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-414"><a href="#cb60-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(3)</span></span>
<span id="cb60-415"><a href="#cb60-415" aria-hidden="true" tabindex="-1"></a>df_03 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-416"><a href="#cb60-416" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-417"><a href="#cb60-417" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-418"><a href="#cb60-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-419"><a href="#cb60-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">3</span>),</span>
<span id="cb60-420"><a href="#cb60-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"03"</span></span>
<span id="cb60-421"><a href="#cb60-421" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb60-422"><a href="#cb60-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-423"><a href="#cb60-423" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(5)</span></span>
<span id="cb60-424"><a href="#cb60-424" aria-hidden="true" tabindex="-1"></a>df_05 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-425"><a href="#cb60-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-426"><a href="#cb60-426" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-427"><a href="#cb60-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-428"><a href="#cb60-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">5</span>),</span>
<span id="cb60-429"><a href="#cb60-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"05"</span></span>
<span id="cb60-430"><a href="#cb60-430" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-431"><a href="#cb60-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-432"><a href="#cb60-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(10)</span></span>
<span id="cb60-433"><a href="#cb60-433" aria-hidden="true" tabindex="-1"></a>df_10 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-434"><a href="#cb60-434" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-435"><a href="#cb60-435" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-436"><a href="#cb60-436" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(</span>
<span id="cb60-437"><a href="#cb60-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">10</span>),</span>
<span id="cb60-438"><a href="#cb60-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"10"</span></span>
<span id="cb60-439"><a href="#cb60-439" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-440"><a href="#cb60-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-441"><a href="#cb60-441" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for t(25)</span></span>
<span id="cb60-442"><a href="#cb60-442" aria-hidden="true" tabindex="-1"></a>df_25 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-443"><a href="#cb60-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-444"><a href="#cb60-444" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-445"><a href="#cb60-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-446"><a href="#cb60-446" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dt</span>(<span class="at">x =</span> X, <span class="at">df =</span> <span class="dv">25</span>),</span>
<span id="cb60-447"><a href="#cb60-447" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"25"</span></span>
<span id="cb60-448"><a href="#cb60-448" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-449"><a href="#cb60-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-450"><a href="#cb60-450" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for standard normal</span></span>
<span id="cb60-451"><a href="#cb60-451" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-452"><a href="#cb60-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-453"><a href="#cb60-453" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-454"><a href="#cb60-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-455"><a href="#cb60-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> X, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb60-456"><a href="#cb60-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"Standard normal"</span></span>
<span id="cb60-457"><a href="#cb60-457" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-458"><a href="#cb60-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-459"><a href="#cb60-459" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all datasets into one</span></span>
<span id="cb60-460"><a href="#cb60-460" aria-hidden="true" tabindex="-1"></a>fig_06 <span class="ot">=</span> <span class="fu">rbind</span>(df_03, df_05, df_10, df_25, z)</span>
<span id="cb60-461"><a href="#cb60-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-462"><a href="#cb60-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-463"><a href="#cb60-463" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_06, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> df, <span class="at">linetype =</span> df)) <span class="sc">+</span></span>
<span id="cb60-464"><a href="#cb60-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-465"><a href="#cb60-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t"</span>) <span class="sc">+</span></span>
<span id="cb60-466"><a href="#cb60-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-467"><a href="#cb60-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb60-468"><a href="#cb60-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb60-469"><a href="#cb60-469" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>() <span class="sc">+</span></span>
<span id="cb60-470"><a href="#cb60-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb60-471"><a href="#cb60-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-472"><a href="#cb60-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-473"><a href="#cb60-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-474"><a href="#cb60-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-477"><a href="#cb60-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-478"><a href="#cb60-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-01</span></span>
<span id="cb60-479"><a href="#cb60-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Means and standard deviations for four *t*-Distributions and the standard normal distribution."</span></span>
<span id="cb60-480"><a href="#cb60-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-481"><a href="#cb60-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb60-482"><a href="#cb60-482" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb60-483"><a href="#cb60-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-484"><a href="#cb60-484" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data from table</span></span>
<span id="cb60-485"><a href="#cb60-485" aria-hidden="true" tabindex="-1"></a>tab_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-486"><a href="#cb60-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="st">"3"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>, <span class="st">"25"</span>, <span class="st">"z"</span>),</span>
<span id="cb60-487"><a href="#cb60-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">M =</span> <span class="fl">0.00</span>,</span>
<span id="cb60-488"><a href="#cb60-488" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.5</span>, <span class="fl">1.22</span>, <span class="fl">1.08</span>, <span class="fl">1.00</span>)</span>
<span id="cb60-489"><a href="#cb60-489" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-490"><a href="#cb60-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-491"><a href="#cb60-491" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb60-492"><a href="#cb60-492" aria-hidden="true" tabindex="-1"></a>tab_01 <span class="sc">|&gt;</span></span>
<span id="cb60-493"><a href="#cb60-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb60-494"><a href="#cb60-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb60-495"><a href="#cb60-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="fu">md</span>(<span class="st">"*df*"</span>),</span>
<span id="cb60-496"><a href="#cb60-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">md</span>(<span class="st">"*M*"</span>),</span>
<span id="cb60-497"><a href="#cb60-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">md</span>(<span class="st">"*SD*"</span>)</span>
<span id="cb60-498"><a href="#cb60-498" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-499"><a href="#cb60-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb60-500"><a href="#cb60-500" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(df, M, SD),</span>
<span id="cb60-501"><a href="#cb60-501" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb60-502"><a href="#cb60-502" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-503"><a href="#cb60-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-504"><a href="#cb60-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-505"><a href="#cb60-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-506"><a href="#cb60-506" aria-hidden="true" tabindex="-1"></a>If we compare the means and standard deviations for these distributions, we find that the mean for all the *t*-distributions is 0, same as the standard normal distribution. All *t*-distributions are unimodal and symmetric around zero. The standard deviation for every *t*-distribution is higher than the standard deviation for the standard normal distribution. Mathematically, the variance for the *t*-distribution is:</span>
<span id="cb60-507"><a href="#cb60-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-508"><a href="#cb60-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-509"><a href="#cb60-509" aria-hidden="true" tabindex="-1"></a>\sigma^2(t) = \frac{\nu}{\nu-2}</span>
<span id="cb60-510"><a href="#cb60-510" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-511"><a href="#cb60-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-512"><a href="#cb60-512" aria-hidden="true" tabindex="-1"></a>where $\nu$ (the Greek letter nu) is the degrees of freedom. (Note that $\nu \geq 2$.) Examining this formula, we find that Student *t*-distributions with higher *df* values have less variation. When $\nu=+\infty$, the variance approaches 1, which is the same as the standard normal distribution.</span>
<span id="cb60-513"><a href="#cb60-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-514"><a href="#cb60-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-515"><a href="#cb60-515" aria-hidden="true" tabindex="-1"></a>There are four primary functions for working with Student's *t*-distribution:</span>
<span id="cb60-516"><a href="#cb60-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-517"><a href="#cb60-517" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`dt()`</span> : To compute the probability density (point on the curve)</span>
<span id="cb60-518"><a href="#cb60-518" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`pt()`</span> : To compute the cumulative density (area under the PDF)</span>
<span id="cb60-519"><a href="#cb60-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`qt()`</span> : To compute the quantile value given a particular probability</span>
<span id="cb60-520"><a href="#cb60-520" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`rt()`</span> : To draw a random observation from the distribution</span>
<span id="cb60-521"><a href="#cb60-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-522"><a href="#cb60-522" aria-hidden="true" tabindex="-1"></a>Each of these requires the argument <span class="in">`df=`</span>. </span>
<span id="cb60-523"><a href="#cb60-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-524"><a href="#cb60-524" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-525"><a href="#cb60-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-526"><a href="#cb60-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-527"><a href="#cb60-527" aria-hidden="true" tabindex="-1"></a><span class="fu">## The F-distribution</span></span>
<span id="cb60-528"><a href="#cb60-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-529"><a href="#cb60-529" aria-hidden="true" tabindex="-1"></a>The *F*-distribution, like the *t*-distribution, constitutes a family of distributions. They are positively skewed and generally have a lower-limit of 0. To parameterize an *F*-distribution we need two parameters, namely $\nu_1$ and $\nu_2$. These are both degrees of freedom. The exact shape of the *F*-distribution s governed by the two degrees of freedom parameters. The figure below shows several *F*-distributions with different degrees of freedom.</span>
<span id="cb60-530"><a href="#cb60-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-533"><a href="#cb60-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-534"><a href="#cb60-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-07</span></span>
<span id="cb60-535"><a href="#cb60-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb60-536"><a href="#cb60-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb60-537"><a href="#cb60-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb60-538"><a href="#cb60-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of several F-Distributions with differing degrees of freedom."</span></span>
<span id="cb60-539"><a href="#cb60-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of several *F*-Distributions with differing degrees of freedom."</span></span>
<span id="cb60-540"><a href="#cb60-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-541"><a href="#cb60-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(1,10)</span></span>
<span id="cb60-542"><a href="#cb60-542" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-543"><a href="#cb60-543" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-544"><a href="#cb60-544" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-545"><a href="#cb60-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-546"><a href="#cb60-546" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">1</span>, <span class="at">df2 =</span> <span class="dv">10</span>),</span>
<span id="cb60-547"><a href="#cb60-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(1, 10)"</span></span>
<span id="cb60-548"><a href="#cb60-548" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb60-549"><a href="#cb60-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-550"><a href="#cb60-550" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(5,25)</span></span>
<span id="cb60-551"><a href="#cb60-551" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-552"><a href="#cb60-552" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-553"><a href="#cb60-553" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-554"><a href="#cb60-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-555"><a href="#cb60-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>),</span>
<span id="cb60-556"><a href="#cb60-556" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(5, 25)"</span></span>
<span id="cb60-557"><a href="#cb60-557" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-558"><a href="#cb60-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-559"><a href="#cb60-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(15,30)</span></span>
<span id="cb60-560"><a href="#cb60-560" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-561"><a href="#cb60-561" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-562"><a href="#cb60-562" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-563"><a href="#cb60-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-564"><a href="#cb60-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">15</span>, <span class="at">df2 =</span> <span class="dv">30</span>),</span>
<span id="cb60-565"><a href="#cb60-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(15, 30)"</span></span>
<span id="cb60-566"><a href="#cb60-566" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-567"><a href="#cb60-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-568"><a href="#cb60-568" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(30,60)</span></span>
<span id="cb60-569"><a href="#cb60-569" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-570"><a href="#cb60-570" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-571"><a href="#cb60-571" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-572"><a href="#cb60-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-573"><a href="#cb60-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">30</span>, <span class="at">df2 =</span> <span class="dv">60</span>),</span>
<span id="cb60-574"><a href="#cb60-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> <span class="st">"F(30, 60)"</span></span>
<span id="cb60-575"><a href="#cb60-575" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-576"><a href="#cb60-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-577"><a href="#cb60-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all datasets into one</span></span>
<span id="cb60-578"><a href="#cb60-578" aria-hidden="true" tabindex="-1"></a>fig_07 <span class="ot">=</span> <span class="fu">rbind</span>(f1, f2, f3, f4)</span>
<span id="cb60-579"><a href="#cb60-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-580"><a href="#cb60-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-581"><a href="#cb60-581" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_07, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y, <span class="at">color =</span> df, <span class="at">linetype =</span> df)) <span class="sc">+</span></span>
<span id="cb60-582"><a href="#cb60-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-583"><a href="#cb60-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb60-584"><a href="#cb60-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-585"><a href="#cb60-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb60-586"><a href="#cb60-586" aria-hidden="true" tabindex="-1"></a>  ggsci<span class="sc">::</span><span class="fu">scale_color_d3</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb60-587"><a href="#cb60-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">values =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb60-588"><a href="#cb60-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-589"><a href="#cb60-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-590"><a href="#cb60-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-591"><a href="#cb60-591" aria-hidden="true" tabindex="-1"></a>The expected value (mean) and standard deviation of the *F*-distribution is:</span>
<span id="cb60-592"><a href="#cb60-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-593"><a href="#cb60-593" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-594"><a href="#cb60-594" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-595"><a href="#cb60-595" aria-hidden="true" tabindex="-1"></a>E(F) &amp;= \frac{\nu_2}{\nu_2 - 2} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-596"><a href="#cb60-596" aria-hidden="true" tabindex="-1"></a>\sigma^2(F) &amp;= \frac{2\nu_2^2(\nu_1 + \nu_2 - 2)}{\nu_1(\nu_2-2)^2(\nu_2-4)}</span>
<span id="cb60-597"><a href="#cb60-597" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-598"><a href="#cb60-598" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-599"><a href="#cb60-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-600"><a href="#cb60-600" aria-hidden="true" tabindex="-1"></a>where $\nu_2 &gt; 2$ for the mean and $\nu_2 &gt; 4$ for the variance.</span>
<span id="cb60-601"><a href="#cb60-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-602"><a href="#cb60-602" aria-hidden="true" tabindex="-1"></a>From these formulas we can see that as $\nu_2 \rightarrow +\infty$ the mean of the *F*-distribution approaches 1. We can also see that the variation in the *F*-distribution is a function of both parameters and the variance decreases as either parameter gets larger.</span>
<span id="cb60-603"><a href="#cb60-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-604"><a href="#cb60-604" aria-hidden="true" tabindex="-1"></a>The means and standard deviations for our four example *F*-distributions are given in the table below.</span>
<span id="cb60-605"><a href="#cb60-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-608"><a href="#cb60-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-609"><a href="#cb60-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-02</span></span>
<span id="cb60-610"><a href="#cb60-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Means and standard deviations for four *F*-distributions."</span></span>
<span id="cb60-611"><a href="#cb60-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-612"><a href="#cb60-612" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data from table</span></span>
<span id="cb60-613"><a href="#cb60-613" aria-hidden="true" tabindex="-1"></a>tab_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-614"><a href="#cb60-614" aria-hidden="true" tabindex="-1"></a>  <span class="at">df1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">5</span>),</span>
<span id="cb60-615"><a href="#cb60-615" aria-hidden="true" tabindex="-1"></a>  <span class="at">df2 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">25</span>)</span>
<span id="cb60-616"><a href="#cb60-616" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb60-617"><a href="#cb60-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(       </span>
<span id="cb60-618"><a href="#cb60-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> df2 <span class="sc">/</span> (df2 <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb60-619"><a href="#cb60-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">sqrt</span>((<span class="dv">2</span><span class="sc">*</span>df2<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(df1 <span class="sc">+</span> df2 <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">/</span> (df1<span class="sc">*</span>(df2<span class="dv">-2</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(df2<span class="dv">-4</span>)))</span>
<span id="cb60-620"><a href="#cb60-620" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-621"><a href="#cb60-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-622"><a href="#cb60-622" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb60-623"><a href="#cb60-623" aria-hidden="true" tabindex="-1"></a>tab_02 <span class="sc">|&gt;</span></span>
<span id="cb60-624"><a href="#cb60-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb60-625"><a href="#cb60-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb60-626"><a href="#cb60-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">df1 =</span> <span class="fu">md</span>(<span class="st">"*df1*"</span>),</span>
<span id="cb60-627"><a href="#cb60-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">df2 =</span> <span class="fu">md</span>(<span class="st">"*df2*"</span>),</span>
<span id="cb60-628"><a href="#cb60-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">M =</span> <span class="fu">md</span>(<span class="st">"*M*"</span>),</span>
<span id="cb60-629"><a href="#cb60-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">md</span>(<span class="st">"*SD*"</span>)</span>
<span id="cb60-630"><a href="#cb60-630" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-631"><a href="#cb60-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(</span>
<span id="cb60-632"><a href="#cb60-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(df1, df2, M, SD),</span>
<span id="cb60-633"><a href="#cb60-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"center"</span></span>
<span id="cb60-634"><a href="#cb60-634" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-635"><a href="#cb60-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb60-636"><a href="#cb60-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(M, SD),</span>
<span id="cb60-637"><a href="#cb60-637" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">2</span></span>
<span id="cb60-638"><a href="#cb60-638" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-639"><a href="#cb60-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-640"><a href="#cb60-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-641"><a href="#cb60-641" aria-hidden="true" tabindex="-1"></a>Because there is no negative side of the distribution, when we use the *F*-distribution to compute a *p*-value, we only compute the cumulative density GREATER THAN OR EQUAL TO the value of the *F*-statistic. For example, the figure below shows the $F(5,25)$-distribution and the shaded area corresponds to the *p*-value for an observed *F*-statistic of 2.</span>
<span id="cb60-642"><a href="#cb60-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-643"><a href="#cb60-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-646"><a href="#cb60-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-647"><a href="#cb60-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-08</span></span>
<span id="cb60-648"><a href="#cb60-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb60-649"><a href="#cb60-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey."</span></span>
<span id="cb60-650"><a href="#cb60-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for the $F(5,25)$-distribution. The cumulative density representing the *p*-value associated with an *F*-statistic of 2 is shaded in grey."</span></span>
<span id="cb60-651"><a href="#cb60-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-652"><a href="#cb60-652" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for F(5,25)</span></span>
<span id="cb60-653"><a href="#cb60-653" aria-hidden="true" tabindex="-1"></a>fig_08 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-654"><a href="#cb60-654" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-655"><a href="#cb60-655" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-656"><a href="#cb60-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-657"><a href="#cb60-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span>
<span id="cb60-658"><a href="#cb60-658" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-659"><a href="#cb60-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-660"><a href="#cb60-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data for shading</span></span>
<span id="cb60-661"><a href="#cb60-661" aria-hidden="true" tabindex="-1"></a>shade_01 <span class="ot">=</span> fig_08 <span class="sc">%&gt;%</span></span>
<span id="cb60-662"><a href="#cb60-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb60-663"><a href="#cb60-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-664"><a href="#cb60-664" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-665"><a href="#cb60-665" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_08, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb60-666"><a href="#cb60-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_01, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-667"><a href="#cb60-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-668"><a href="#cb60-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb60-669"><a href="#cb60-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-670"><a href="#cb60-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb60-671"><a href="#cb60-671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-672"><a href="#cb60-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-673"><a href="#cb60-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-674"><a href="#cb60-674" aria-hidden="true" tabindex="-1"></a>Here we can use the <span class="in">`pf()`</span> function to compute the *p*-value. Remember, <span class="in">`pf()`</span> computes the proportion of the area under the curve TO THE LEFT of a particular value. Here we will need to compute the area to the RIGHT of $+2$.</span>
<span id="cb60-675"><a href="#cb60-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-678"><a href="#cb60-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-679"><a href="#cb60-679" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value based on F(5,25)=2</span></span>
<span id="cb60-680"><a href="#cb60-680" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="at">q =</span> <span class="dv">2</span>, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span>
<span id="cb60-681"><a href="#cb60-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-682"><a href="#cb60-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-683"><a href="#cb60-683" aria-hidden="true" tabindex="-1"></a>The probability of observing an *F*-statistic at least as extreme as 2, assuming the null hypothesis is true, is 0.113. This is not evidence against the null hypothesis since the data are consistent with the assumed hypothesis. </span>
<span id="cb60-684"><a href="#cb60-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-685"><a href="#cb60-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-686"><a href="#cb60-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-687"><a href="#cb60-687" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-688"><a href="#cb60-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-689"><a href="#cb60-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-690"><a href="#cb60-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating a PDF and Adding Shading in a ggplot</span></span>
<span id="cb60-691"><a href="#cb60-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-692"><a href="#cb60-692" aria-hidden="true" tabindex="-1"></a>One method to create the PDF for a distribution using <span class="in">`ggplot()`</span> is to create a dataset that includes a sequence of *X*-values for which you want to show the PDF and compute the probability density for each of those values. Then you can use <span class="in">`geom_line()`</span> to connect those probability densities.</span>
<span id="cb60-693"><a href="#cb60-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-694"><a href="#cb60-694" aria-hidden="true" tabindex="-1"></a>For example, say we want to create the PDF of the $F(15, 100)$-distribution. Here I will define this for *F*-values from 0 to 10. (These are the *x*-values in my plot.) Then I need to compute the probability densities for each of those values using <span class="in">`pf()`</span>. </span>
<span id="cb60-695"><a href="#cb60-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-698"><a href="#cb60-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-699"><a href="#cb60-699" aria-hidden="true" tabindex="-1"></a><span class="co"># Create F-value and compute probability densities</span></span>
<span id="cb60-700"><a href="#cb60-700" aria-hidden="true" tabindex="-1"></a>fig_09 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-701"><a href="#cb60-701" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-702"><a href="#cb60-702" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb60-703"><a href="#cb60-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-704"><a href="#cb60-704" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">25</span>)</span>
<span id="cb60-705"><a href="#cb60-705" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-706"><a href="#cb60-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-707"><a href="#cb60-707" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb60-708"><a href="#cb60-708" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fig_09)</span>
<span id="cb60-709"><a href="#cb60-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-710"><a href="#cb60-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-711"><a href="#cb60-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-712"><a href="#cb60-712" aria-hidden="true" tabindex="-1"></a>Then we can plot the *Y* versus the *X* values and connect them using <span class="in">`geom_line()`</span>.</span>
<span id="cb60-713"><a href="#cb60-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-716"><a href="#cb60-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-717"><a href="#cb60-717" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-09</span></span>
<span id="cb60-718"><a href="#cb60-718" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb60-719"><a href="#cb60-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for the F(5,25)-distribution."</span></span>
<span id="cb60-720"><a href="#cb60-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for the $F(5,25)$-distribution."</span></span>
<span id="cb60-721"><a href="#cb60-721" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_09, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb60-722"><a href="#cb60-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-723"><a href="#cb60-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb60-724"><a href="#cb60-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-725"><a href="#cb60-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span>
<span id="cb60-726"><a href="#cb60-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-727"><a href="#cb60-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-728"><a href="#cb60-728" aria-hidden="true" tabindex="-1"></a>To add shading under the curve we need to create a new dataset that only includes the *X* and *Y* values in the shaded region. For example to shade the area under the PDF where $F &gt; 2$, we need to create a new dataset where the *X* values are greater than 2. Below I do this using <span class="in">`filter()`</span> and store the data in an object called <span class="in">`shade_01`</span>.</span>
<span id="cb60-729"><a href="#cb60-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-732"><a href="#cb60-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-733"><a href="#cb60-733" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter data included in the shaded region</span></span>
<span id="cb60-734"><a href="#cb60-734" aria-hidden="true" tabindex="-1"></a>shade_09 <span class="ot">=</span> fig_09 <span class="sc">%&gt;%</span></span>
<span id="cb60-735"><a href="#cb60-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb60-736"><a href="#cb60-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-737"><a href="#cb60-737" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb60-738"><a href="#cb60-738" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(shade_09)</span>
<span id="cb60-739"><a href="#cb60-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-740"><a href="#cb60-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-741"><a href="#cb60-741" aria-hidden="true" tabindex="-1"></a>We re-draw the PDF and then use <span class="in">`geom_ribbon()`</span> to add shading. This layer requires us to define the area we want shaded. Here we want to shade from $Y=0$ to $Y=$ the probability density for each of the *X* values in the shading data. To carry this out we need to define <span class="in">`x=`</span>, <span class="in">`ymin=`</span> and <span class="in">`ymax=`</span>. </span>
<span id="cb60-742"><a href="#cb60-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-743"><a href="#cb60-743" aria-hidden="true" tabindex="-1"></a>Since the *X* values are in a column called <span class="in">`X`</span> and the probability densities are in a column called <span class="in">`Y`</span> in the shaded dataa frame, we can call <span class="in">`x=X`</span> and <span class="in">`ymax=Y`</span> in the <span class="in">`aes()`</span> of <span class="in">`geom_ribbon()`</span>. The <span class="in">`ymin=`</span> value of 0 is not a column in the data frame, so it is specified OUTSIDE the <span class="in">`aes()`</span> function. We can then also set characteristics like color of the shading (<span class="in">`color=`</span>) and transparency level (<span class="in">`alpha=`</span>). Finally, to ensure that <span class="in">`geom_ribbon()`</span> is shading only the region we want, we set <span class="in">`data=shade_01`</span>.</span>
<span id="cb60-744"><a href="#cb60-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-747"><a href="#cb60-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-748"><a href="#cb60-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-10</span></span>
<span id="cb60-749"><a href="#cb60-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb60-750"><a href="#cb60-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for the F(5,25)-distribution. The cumulative density representing the p-value associated with an F-statistic of 2 is shaded in grey."</span></span>
<span id="cb60-751"><a href="#cb60-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for the $F(5,25)$-distribution. The cumulative density representing the *p*-value associated with an *F*-statistic of 2 is shaded in grey."</span></span>
<span id="cb60-752"><a href="#cb60-752" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-753"><a href="#cb60-753" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_09, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y))  <span class="sc">+</span></span>
<span id="cb60-754"><a href="#cb60-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade_09, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">ymax =</span> Y), </span>
<span id="cb60-755"><a href="#cb60-755" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb60-756"><a href="#cb60-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-757"><a href="#cb60-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"F"</span>) <span class="sc">+</span></span>
<span id="cb60-758"><a href="#cb60-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb60-759"><a href="#cb60-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb60-760"><a href="#cb60-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-761"><a href="#cb60-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-762"><a href="#cb60-762" aria-hidden="true" tabindex="-1"></a>:::protip</span>
<span id="cb60-763"><a href="#cb60-763" aria-hidden="true" tabindex="-1"></a>You can click the <span class="in">`Code`</span> button to see the underlying syntax for many of the figures created in this document.</span>
<span id="cb60-764"><a href="#cb60-764" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-765"><a href="#cb60-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-766"><a href="#cb60-766" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-767"><a href="#cb60-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-768"><a href="#cb60-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-769"><a href="#cb60-769" aria-hidden="true" tabindex="-1"></a><span class="fu">## Probability Distributions in Regression</span></span>
<span id="cb60-770"><a href="#cb60-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-771"><a href="#cb60-771" aria-hidden="true" tabindex="-1"></a>To illustrate how probability distributions are used in practice, we will will use the data in the file *riverview.csv* (see the <span class="co">[</span><span class="ot">data codebook</span><span class="co">](https://zief0002.github.io/bespectacled-antelope/codebooks/riverview.html)</span> for more information about these data) and fit a regression model that uses education level and seniority to predict variation in employee income. Some (most?) of this content should also be review from EPsy 8251.</span>
<span id="cb60-772"><a href="#cb60-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-773"><a href="#cb60-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-776"><a href="#cb60-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-777"><a href="#cb60-777" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb60-778"><a href="#cb60-778" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb60-779"><a href="#cb60-779" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-780"><a href="#cb60-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-781"><a href="#cb60-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb60-782"><a href="#cb60-782" aria-hidden="true" tabindex="-1"></a>city <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/bespectacled-antelope/main/data/riverview.csv"</span>)</span>
<span id="cb60-783"><a href="#cb60-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-784"><a href="#cb60-784" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb60-785"><a href="#cb60-785" aria-hidden="true" tabindex="-1"></a>city</span>
<span id="cb60-786"><a href="#cb60-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-787"><a href="#cb60-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-788"><a href="#cb60-788" aria-hidden="true" tabindex="-1"></a>To begin, we will fit a multiple regression model that uses level of education and seniority to predict variation in employee's incomes. The model is:</span>
<span id="cb60-789"><a href="#cb60-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-790"><a href="#cb60-790" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-791"><a href="#cb60-791" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-792"><a href="#cb60-792" aria-hidden="true" tabindex="-1"></a>\mathrm{Income}_i &amp;= \beta_0 + \beta_1(\mathrm{Education}_i) + \beta_2(\mathrm{Seniority}_i) + \epsilon_i <span class="sc">\\</span></span>
<span id="cb60-793"><a href="#cb60-793" aria-hidden="true" tabindex="-1"></a>&amp; \mathrm{where}\quad \epsilon_i \sim \mathcal{N}(0, \sigma^2_{\epsilon})</span>
<span id="cb60-794"><a href="#cb60-794" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-795"><a href="#cb60-795" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-796"><a href="#cb60-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-797"><a href="#cb60-797" aria-hidden="true" tabindex="-1"></a>We have four unknowns in this model that need to be estimated: $\beta_0$, $\beta_1$, $\beta_2$, and $\sigma^2_{\epsilon}$. This last unknown is the error (or residual) variance. As a side note, when you report results from a fitted regression model, you should report the estimated residual variance (or residual standard error) along with the coefficient estimates.</span>
<span id="cb60-798"><a href="#cb60-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-799"><a href="#cb60-799" aria-hidden="true" tabindex="-1"></a>Aside from the estimates for the coefficients and RSE, we are also generally interested in the estimates of uncertainty for the coefficients (i.e., the standard errors). These uncertainty estimates also allow us to carry out hypothesis tests on the effects included in the model.</span>
<span id="cb60-800"><a href="#cb60-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-803"><a href="#cb60-803" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-804"><a href="#cb60-804" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb60-805"><a href="#cb60-805" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(income <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> education <span class="sc">+</span> seniority, <span class="at">data =</span> city)</span>
<span id="cb60-806"><a href="#cb60-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-807"><a href="#cb60-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-808"><a href="#cb60-808" aria-hidden="true" tabindex="-1"></a>In practice, all of the estimates, SEs, and inferential output are available using functionality in R. For example, the model-level output, including $R^2$, the *F*-statistic, the model and residual *df*, and the residual standard error are all outputted from the <span class="in">`glance()`</span> function from the <span class="in">`{broom}`</span> package. We can also partition the variation using the <span class="in">`anova()`</span> function.</span>
<span id="cb60-809"><a href="#cb60-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-812"><a href="#cb60-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-813"><a href="#cb60-813" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb60-814"><a href="#cb60-814" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.1</span>)</span>
<span id="cb60-815"><a href="#cb60-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-816"><a href="#cb60-816" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition the variation</span></span>
<span id="cb60-817"><a href="#cb60-817" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb60-818"><a href="#cb60-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-819"><a href="#cb60-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-820"><a href="#cb60-820" aria-hidden="true" tabindex="-1"></a>Similarly the <span class="in">`tidy()`</span> function from the <span class="in">`{broom}`</span> package outputs coefficient-level output, including the coefficients, standard errors, *t*-values, and associated *p*-values.</span>
<span id="cb60-821"><a href="#cb60-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-824"><a href="#cb60-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-825"><a href="#cb60-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient-level output</span></span>
<span id="cb60-826"><a href="#cb60-826" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm<span class="fl">.1</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-827"><a href="#cb60-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-828"><a href="#cb60-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-829"><a href="#cb60-829" aria-hidden="true" tabindex="-1"></a>Our goal here is to understand how the probability distributions play a role in determining some of these values.</span>
<span id="cb60-830"><a href="#cb60-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-831"><a href="#cb60-831" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-832"><a href="#cb60-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-833"><a href="#cb60-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-834"><a href="#cb60-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model-Level Inference: The *F*-Distribution</span></span>
<span id="cb60-835"><a href="#cb60-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-836"><a href="#cb60-836" aria-hidden="true" tabindex="-1"></a>At the model-level, we are interested in whether or not the model (as a whole) explains variation in the outcome. Our estimate of how much variation the model explains is based on partitioning the total variation of the outcome ($\mathrm{SS}_{\mathrm{Total}}$) into that which is explained by the model ($\mathrm{SS}_{\mathrm{Model}}$) and that which is not explained by the model ($\mathrm{SS}_{\mathrm{Residual}}$). From the <span class="in">`anova()`</span> output:</span>
<span id="cb60-837"><a href="#cb60-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-838"><a href="#cb60-838" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-839"><a href="#cb60-839" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-840"><a href="#cb60-840" aria-hidden="true" tabindex="-1"></a>\mathrm{SS}_{\mathrm{Model}} &amp;= 4147.3 + 722.9 = 4870.2<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-841"><a href="#cb60-841" aria-hidden="true" tabindex="-1"></a>\mathrm{SS}_{\mathrm{Residual}} &amp;= 1695.3<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-842"><a href="#cb60-842" aria-hidden="true" tabindex="-1"></a>\mathrm{SS}_{\mathrm{Total}} &amp;= 4870.2 + 1695.3 = 6565.5</span>
<span id="cb60-843"><a href="#cb60-843" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-844"><a href="#cb60-844" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-845"><a href="#cb60-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-846"><a href="#cb60-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-847"><a href="#cb60-847" aria-hidden="true" tabindex="-1"></a>Then we compute the a statistic called $R^2$ by computing the ratio of the explained variation to the total variation.</span>
<span id="cb60-848"><a href="#cb60-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-849"><a href="#cb60-849" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-850"><a href="#cb60-850" aria-hidden="true" tabindex="-1"></a>R^2 = \frac{4870.2}{6565.5} = 0.742</span>
<span id="cb60-851"><a href="#cb60-851" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-852"><a href="#cb60-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-853"><a href="#cb60-853" aria-hidden="true" tabindex="-1"></a>The model (differences in education and seniority levels) explains 74.2% of the variation in employee's incomes in the sample. We might also want to test whether this is more variation than we expect because of sampling error. To do this we want to test the hypothesis that:</span>
<span id="cb60-854"><a href="#cb60-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-855"><a href="#cb60-855" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-856"><a href="#cb60-856" aria-hidden="true" tabindex="-1"></a>H_0: \rho^2 = 0</span>
<span id="cb60-857"><a href="#cb60-857" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-858"><a href="#cb60-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-859"><a href="#cb60-859" aria-hidden="true" tabindex="-1"></a>To evaluate this we convert the sample $R^2$ value into a test statistic using,</span>
<span id="cb60-860"><a href="#cb60-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-861"><a href="#cb60-861" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-862"><a href="#cb60-862" aria-hidden="true" tabindex="-1"></a>F = \frac{R^2}{1 - R^2} \times \frac{\mathit{df}_{\mathrm{Error}}}{\mathit{df}_{\mathrm{Model}}}</span>
<span id="cb60-863"><a href="#cb60-863" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-864"><a href="#cb60-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-865"><a href="#cb60-865" aria-hidden="true" tabindex="-1"></a>The degrees of freedom (*df*) is also partitioned in the <span class="in">`anova()`</span> output:</span>
<span id="cb60-866"><a href="#cb60-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-867"><a href="#cb60-867" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-868"><a href="#cb60-868" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-869"><a href="#cb60-869" aria-hidden="true" tabindex="-1"></a>\mathrm{df}_{\mathrm{Model}} &amp;= 1 + 1 = 2<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-870"><a href="#cb60-870" aria-hidden="true" tabindex="-1"></a>\mathrm{df}_{\mathrm{Residual}} &amp;= 29<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-871"><a href="#cb60-871" aria-hidden="true" tabindex="-1"></a>\mathrm{df}_{\mathrm{Total}} &amp;= 2 + 29 = 31</span>
<span id="cb60-872"><a href="#cb60-872" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-873"><a href="#cb60-873" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-874"><a href="#cb60-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-875"><a href="#cb60-875" aria-hidden="true" tabindex="-1"></a>Converting our $R^2$ value of 0.742 value to an *F*-statistic:</span>
<span id="cb60-876"><a href="#cb60-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-877"><a href="#cb60-877" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-878"><a href="#cb60-878" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-879"><a href="#cb60-879" aria-hidden="true" tabindex="-1"></a>F &amp;= \frac{0.742}{1-0.742} \times \frac{29}{2} <span class="sc">\\</span></span>
<span id="cb60-880"><a href="#cb60-880" aria-hidden="true" tabindex="-1"></a>&amp;= 41.7</span>
<span id="cb60-881"><a href="#cb60-881" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-882"><a href="#cb60-882" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-883"><a href="#cb60-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-884"><a href="#cb60-884" aria-hidden="true" tabindex="-1"></a>We write this standardization of $R^2$ as $F(2,29)=41.7$.</span>
<span id="cb60-885"><a href="#cb60-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-886"><a href="#cb60-886" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-887"><a href="#cb60-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-888"><a href="#cb60-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-889"><a href="#cb60-889" aria-hidden="true" tabindex="-1"></a><span class="fu">### Computing F from the ANOVA Partitioning</span></span>
<span id="cb60-890"><a href="#cb60-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-891"><a href="#cb60-891" aria-hidden="true" tabindex="-1"></a>We can also compute the model-level *F*-statistic directly using the partitioning of variation from the ANOVA table.</span>
<span id="cb60-892"><a href="#cb60-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-895"><a href="#cb60-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-896"><a href="#cb60-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition the variation</span></span>
<span id="cb60-897"><a href="#cb60-897" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm<span class="fl">.1</span>)</span>
<span id="cb60-898"><a href="#cb60-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-899"><a href="#cb60-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-900"><a href="#cb60-900" aria-hidden="true" tabindex="-1"></a>The *F*-statistic is a ratio of the mean square for the model and the mean square for the error. To compute a mean square we use the general formula:</span>
<span id="cb60-901"><a href="#cb60-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-902"><a href="#cb60-902" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-903"><a href="#cb60-903" aria-hidden="true" tabindex="-1"></a>\mathrm{MS} = \frac{\mathrm{SS}}{\mathrm{df}}</span>
<span id="cb60-904"><a href="#cb60-904" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-905"><a href="#cb60-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-906"><a href="#cb60-906" aria-hidden="true" tabindex="-1"></a>The model includes both the education and seniority predictor, so we combine the SS and df. The MS model is:</span>
<span id="cb60-907"><a href="#cb60-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-908"><a href="#cb60-908" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-909"><a href="#cb60-909" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-910"><a href="#cb60-910" aria-hidden="true" tabindex="-1"></a>\mathrm{MS}_{\mathrm{Model}} &amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{df}_{\mathrm{Model}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-911"><a href="#cb60-911" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{4147.3 + 722.9}{1 + 1} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-912"><a href="#cb60-912" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{4870.2}{2} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-913"><a href="#cb60-913" aria-hidden="true" tabindex="-1"></a>&amp;= 2435.1</span>
<span id="cb60-914"><a href="#cb60-914" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-915"><a href="#cb60-915" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-916"><a href="#cb60-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-917"><a href="#cb60-917" aria-hidden="true" tabindex="-1"></a>The MS error is:</span>
<span id="cb60-918"><a href="#cb60-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-919"><a href="#cb60-919" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-920"><a href="#cb60-920" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-921"><a href="#cb60-921" aria-hidden="true" tabindex="-1"></a>\mathrm{MS}_{\mathrm{Error}} &amp;= \frac{\mathrm{SS}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Error}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-922"><a href="#cb60-922" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1695.3 }{29} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-923"><a href="#cb60-923" aria-hidden="true" tabindex="-1"></a>&amp;= 58.5</span>
<span id="cb60-924"><a href="#cb60-924" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-925"><a href="#cb60-925" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-926"><a href="#cb60-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-927"><a href="#cb60-927" aria-hidden="true" tabindex="-1"></a>Then, we compute the *F*-statistic by computing the ratio of these two mean squares.</span>
<span id="cb60-928"><a href="#cb60-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-929"><a href="#cb60-929" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-930"><a href="#cb60-930" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-931"><a href="#cb60-931" aria-hidden="true" tabindex="-1"></a>F &amp;= \frac{\mathrm{MS}_{\mathrm{Model}}}{\mathrm{MS}_{\mathrm{Error}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-932"><a href="#cb60-932" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{2435.1}{58.5} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-933"><a href="#cb60-933" aria-hidden="true" tabindex="-1"></a>&amp;= 41.6</span>
<span id="cb60-934"><a href="#cb60-934" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-935"><a href="#cb60-935" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-936"><a href="#cb60-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-937"><a href="#cb60-937" aria-hidden="true" tabindex="-1"></a>Since a mean square represents the average amount of variation (per degree of freedom), we can see that *F* is a ratio between the average amount of variation explained by the model and the average amount of variation unexplained by the model. In our example, this ratio is 41.6; on average the model explains 41.6 times the variation that is unexplained.</span>
<span id="cb60-938"><a href="#cb60-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-939"><a href="#cb60-939" aria-hidden="true" tabindex="-1"></a>Note that this is an identical computation (although reframed) as the initial computation for *F*. We can use mathematics to show this equivalence:</span>
<span id="cb60-940"><a href="#cb60-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-941"><a href="#cb60-941" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-942"><a href="#cb60-942" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-943"><a href="#cb60-943" aria-hidden="true" tabindex="-1"></a>F &amp;= \frac{R^2}{1-R^2} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-944"><a href="#cb60-944" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{SS}_{\mathrm{Total}}}}{\frac{\mathrm{SS}_{\mathrm{Error}}}{\mathrm{SS}_{\mathrm{Total}}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-945"><a href="#cb60-945" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{SS}_{\mathrm{Error}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{df}_{\mathrm{Model}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-946"><a href="#cb60-946" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\mathrm{SS}_{\mathrm{Model}}}{\mathrm{df}_{\mathrm{Model}}} \times \frac{\mathrm{df}_{\mathrm{Error}}}{\mathrm{SS}_{\mathrm{Error}}} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-947"><a href="#cb60-947" aria-hidden="true" tabindex="-1"></a>&amp;= \mathrm{MS}_{\mathrm{Model}} \times \frac{1}{\mathrm{MS}_{\mathrm{Error}}}<span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-948"><a href="#cb60-948" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{\mathrm{MS}_{\mathrm{Model}}}{\mathrm{MS}_{\mathrm{Error}}}</span>
<span id="cb60-949"><a href="#cb60-949" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-950"><a href="#cb60-950" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-951"><a href="#cb60-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-952"><a href="#cb60-952" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-953"><a href="#cb60-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-954"><a href="#cb60-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-955"><a href="#cb60-955" aria-hidden="true" tabindex="-1"></a><span class="fu">### Testing the Model-Level Null Hypothesis</span></span>
<span id="cb60-956"><a href="#cb60-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-957"><a href="#cb60-957" aria-hidden="true" tabindex="-1"></a>We evaluate our test statistic (*F* in this case) in the appropriate test distribution, in this case an *F*-distribution with 2 and 29 degrees of freedom. The figure below, shows the $F(2,29)$-distribution as a solid, black line. The *p*-value is the area under the curve that is at least as extreme as the observed *F*-value of 41.7.</span>
<span id="cb60-958"><a href="#cb60-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-961"><a href="#cb60-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-962"><a href="#cb60-962" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-11</span></span>
<span id="cb60-963"><a href="#cb60-963" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb60-964"><a href="#cb60-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb60-965"><a href="#cb60-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb60-966"><a href="#cb60-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of the probability density function (PDF) for the F(2,~29)-distribution. The cumulative density representing the p-value for a test evaluating whether rho-squared=0 using an observed F-statistic of 41.7 is also displayed."</span></span>
<span id="cb60-967"><a href="#cb60-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of the probability density function (PDF) for the $F(2,~29)$-distribution. The cumulative density representing the *p*-value for a test evaluating whether $\\rho^2=0$ using an observed *F*-statistic of 41.7 is also displayed."</span></span>
<span id="cb60-968"><a href="#cb60-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb60-969"><a href="#cb60-969" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data</span></span>
<span id="cb60-970"><a href="#cb60-970" aria-hidden="true" tabindex="-1"></a>fig_11 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-971"><a href="#cb60-971" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">50</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb60-972"><a href="#cb60-972" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb60-973"><a href="#cb60-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb60-974"><a href="#cb60-974" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> <span class="fu">df</span>(<span class="at">x =</span> X, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>)</span>
<span id="cb60-975"><a href="#cb60-975" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-976"><a href="#cb60-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-977"><a href="#cb60-977" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter shaded area</span></span>
<span id="cb60-978"><a href="#cb60-978" aria-hidden="true" tabindex="-1"></a>shade <span class="ot">=</span> fig_11 <span class="sc">%&gt;%</span></span>
<span id="cb60-979"><a href="#cb60-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(X <span class="sc">&gt;=</span> <span class="fl">41.7</span>)</span>
<span id="cb60-980"><a href="#cb60-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-981"><a href="#cb60-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb60-982"><a href="#cb60-982" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fig_11, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb60-983"><a href="#cb60-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-984"><a href="#cb60-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb60-985"><a href="#cb60-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> shade, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="fu">aes</span>(<span class="at">ymax =</span> Y), <span class="at">color =</span> <span class="st">"#bbbbbb"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)</span>
<span id="cb60-986"><a href="#cb60-986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-987"><a href="#cb60-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-988"><a href="#cb60-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-989"><a href="#cb60-989" aria-hidden="true" tabindex="-1"></a>The computation using the cumulative density function, <span class="in">`pf()`</span>, to obtain the *p*-value is:</span>
<span id="cb60-990"><a href="#cb60-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-993"><a href="#cb60-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-994"><a href="#cb60-994" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for F(2,29)=41.7</span></span>
<span id="cb60-995"><a href="#cb60-995" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(<span class="fl">41.7</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>)</span>
<span id="cb60-996"><a href="#cb60-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-997"><a href="#cb60-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-998"><a href="#cb60-998" aria-hidden="true" tabindex="-1"></a>Because we want the upper-tail, rather than taking the difference from 1, we can also use the <span class="in">`lower.tail=FALSE`</span> argument in <span class="in">`pf()`</span>.</span>
<span id="cb60-999"><a href="#cb60-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1002"><a href="#cb60-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1003"><a href="#cb60-1003" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for F(2,29)=41.7</span></span>
<span id="cb60-1004"><a href="#cb60-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">41.7</span>, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">29</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-1005"><a href="#cb60-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1006"><a href="#cb60-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1007"><a href="#cb60-1007" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-1008"><a href="#cb60-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1009"><a href="#cb60-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1010"><a href="#cb60-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mean Squares are Variance Estimates</span></span>
<span id="cb60-1011"><a href="#cb60-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1012"><a href="#cb60-1012" aria-hidden="true" tabindex="-1"></a>Mean squares are also estimates of the *variance*. Consider the computational formula for the sample variance,</span>
<span id="cb60-1013"><a href="#cb60-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1014"><a href="#cb60-1014" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1015"><a href="#cb60-1015" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}^2 = \frac{\sum(Y - \bar{Y})^2}{n-1}</span>
<span id="cb60-1016"><a href="#cb60-1016" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1017"><a href="#cb60-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1018"><a href="#cb60-1018" aria-hidden="true" tabindex="-1"></a>This is the total sum of squares divided by the total *df*. The variance of the outcome variable is interpreted as the average amount of variation in the outcome variable (in the squared metric). Thus, it is also referred to as the mean square total.</span>
<span id="cb60-1019"><a href="#cb60-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1020"><a href="#cb60-1020" aria-hidden="true" tabindex="-1"></a>When we compute an *F*-statistic, we are finding the ratio of two different variance estimates---one based on the model (explained variance) and one based on the error (unexplained variance). Under the null hypothesis that $\rho^2 = 0$, we are assuming that all the variance is unexplained. In that case, our *F*-statistic would be close to zero. When the model explains a significant amount of variation, the numerator gets larger relative to the denominator and the *F*-value is larger.</span>
<span id="cb60-1021"><a href="#cb60-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1022"><a href="#cb60-1022" aria-hidden="true" tabindex="-1"></a>The mean squared error (from the <span class="in">`anova()`</span> output) plays a special role in regression analysis. It is the variance estimate for the conditional distributions of the residuals in our visual depiction of the distributional assumptions of the residuals underlying linear regression.</span>
<span id="cb60-1023"><a href="#cb60-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1026"><a href="#cb60-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1027"><a href="#cb60-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-12</span></span>
<span id="cb60-1028"><a href="#cb60-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb60-1029"><a href="#cb60-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "70%"</span></span>
<span id="cb60-1030"><a href="#cb60-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Visual Depiction of the Distributional Assumptions of the Residuals Underlying Linear Regression"</span></span>
<span id="cb60-1031"><a href="#cb60-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visual Depiction of the Distributional Assumptions of the Residuals Underlying Linear Regression"</span></span>
<span id="cb60-1032"><a href="#cb60-1032" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figs/04-regression-assumptions-residuals.png"</span>)</span>
<span id="cb60-1033"><a href="#cb60-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1034"><a href="#cb60-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1035"><a href="#cb60-1035" aria-hidden="true" tabindex="-1"></a>Recall that we made implicit assumptions about the conditional distributions of the residuals, namely that they were identically and normally distributed with a mean of zero and some variance. Based on the estimate of the mean squared error, the variance of each of these distributions is 58.5.</span>
<span id="cb60-1036"><a href="#cb60-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1037"><a href="#cb60-1037" aria-hidden="true" tabindex="-1"></a>While the variance is a mathematical convenience, the standard deviation is often a better descriptor of the variation in a distribution since it is measured in the original metric. The standard deviation fro the residuals (error) is 7.6. Because the residuals are statistics (summaries computed from sample data), their standard deviation is referred to as a "standard error". </span>
<span id="cb60-1038"><a href="#cb60-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1039"><a href="#cb60-1039" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb60-1040"><a href="#cb60-1040" aria-hidden="true" tabindex="-1"></a>The *residual standard error* (RSE) is sometimes referred to as the *Root Mean Squared Error* (RMSE).</span>
<span id="cb60-1041"><a href="#cb60-1041" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-1042"><a href="#cb60-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1045"><a href="#cb60-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1046"><a href="#cb60-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute RMSE</span></span>
<span id="cb60-1047"><a href="#cb60-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fl">58.5</span>)</span>
<span id="cb60-1048"><a href="#cb60-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1049"><a href="#cb60-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1050"><a href="#cb60-1050" aria-hidden="true" tabindex="-1"></a>Why is this value important? It gives the expected variation in the conditional residual distributions, which is a measure of the average amount of error. For example, since all of the conditional distributions of the residuals are assumed to be normally distributed, we would expect that 95% of the residuals would fall between $\pm2$ standard errors from 0; or, in this case, between $-15.3$ and $+15.3$. Observations with residuals that are more extreme may be regression outliers.</span>
<span id="cb60-1051"><a href="#cb60-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1052"><a href="#cb60-1052" aria-hidden="true" tabindex="-1"></a>More importantly, it is a value that we need to estimate in order to specify the model.</span>
<span id="cb60-1053"><a href="#cb60-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1054"><a href="#cb60-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1055"><a href="#cb60-1055" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-1056"><a href="#cb60-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1057"><a href="#cb60-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1058"><a href="#cb60-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coefficent-Level Inference: The *t*-Distribution</span></span>
<span id="cb60-1059"><a href="#cb60-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1060"><a href="#cb60-1060" aria-hidden="true" tabindex="-1"></a>Recall that the coefficients and SEs for the coefficients are computed directly from the raw data based on the OLS estimation. These can then be uses to construct a test statistic (e.g., *t*) to carry out a hypothesis test or compute endpoints for a confidence interval. To see how this is done, we will consider the partial effect of education level (after controlling for differences in seniority) in our fitted model.</span>
<span id="cb60-1061"><a href="#cb60-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1062"><a href="#cb60-1062" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1063"><a href="#cb60-1063" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-1064"><a href="#cb60-1064" aria-hidden="true" tabindex="-1"></a>\hat\beta_{\mathrm{Education}}&amp;=2.25 <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-1065"><a href="#cb60-1065" aria-hidden="true" tabindex="-1"></a>\mathrm{SE}(\hat\beta_{\mathrm{Education}}) &amp;=0.335</span>
<span id="cb60-1066"><a href="#cb60-1066" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-1067"><a href="#cb60-1067" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1068"><a href="#cb60-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1069"><a href="#cb60-1069" aria-hidden="true" tabindex="-1"></a>We might want to test whether the partial effect of education level on income, after accounting for differences in seniority level, we observed in the data is more than we would expect because of sampling error. To answer this we need to evaluate the following hypothesis:</span>
<span id="cb60-1070"><a href="#cb60-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1071"><a href="#cb60-1071" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1072"><a href="#cb60-1072" aria-hidden="true" tabindex="-1"></a>H_0: \beta_{\mathrm{Education}} = 0</span>
<span id="cb60-1073"><a href="#cb60-1073" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1074"><a href="#cb60-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1075"><a href="#cb60-1075" aria-hidden="true" tabindex="-1"></a>We begin by converting our estimated regression coefficient to a *t*-statistic using:</span>
<span id="cb60-1076"><a href="#cb60-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1077"><a href="#cb60-1077" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1078"><a href="#cb60-1078" aria-hidden="true" tabindex="-1"></a>t_k = \frac{\hat\beta_k}{\mathrm{SE}(\hat\beta_k)}</span>
<span id="cb60-1079"><a href="#cb60-1079" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1080"><a href="#cb60-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1081"><a href="#cb60-1081" aria-hidden="true" tabindex="-1"></a>In our example,</span>
<span id="cb60-1082"><a href="#cb60-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1083"><a href="#cb60-1083" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1084"><a href="#cb60-1084" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-1085"><a href="#cb60-1085" aria-hidden="true" tabindex="-1"></a>t_{\mathrm{Education}} &amp;= \frac{2.25}{0.335} <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-1086"><a href="#cb60-1086" aria-hidden="true" tabindex="-1"></a>&amp;= 6.72</span>
<span id="cb60-1087"><a href="#cb60-1087" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-1088"><a href="#cb60-1088" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1089"><a href="#cb60-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1090"><a href="#cb60-1090" aria-hidden="true" tabindex="-1"></a>Remember this tells us the education coefficient of 2252 is 6.72 standard errors above 0. Since we are estimating the SE using sample data, our test statistic is likely *t*-distributed^[Whether this is actually *t*-distributed depends on whether the model assumptions are met.]. Which value should we use for *df*? Well, for that, statistical theory tells us that we should use the error *df* value from the model. In our example, this would be:</span>
<span id="cb60-1091"><a href="#cb60-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1092"><a href="#cb60-1092" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1093"><a href="#cb60-1093" aria-hidden="true" tabindex="-1"></a>t(29) = 6.72</span>
<span id="cb60-1094"><a href="#cb60-1094" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1095"><a href="#cb60-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1096"><a href="#cb60-1096" aria-hidden="true" tabindex="-1"></a>Using the *t*-distribution with 29 *df*, we can compute the *p*-value associated with the two-tailed test that $\beta_{\mathrm{Education}=0}$:</span>
<span id="cb60-1097"><a href="#cb60-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1100"><a href="#cb60-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1101"><a href="#cb60-1101" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for the two-tailed test of no effect of education</span></span>
<span id="cb60-1102"><a href="#cb60-1102" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="sc">-</span><span class="fl">6.72</span>, <span class="at">df =</span> <span class="dv">29</span>)</span>
<span id="cb60-1103"><a href="#cb60-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1104"><a href="#cb60-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># alternatively</span></span>
<span id="cb60-1105"><a href="#cb60-1105" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fl">6.72</span>, <span class="at">df =</span> <span class="dv">29</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-1106"><a href="#cb60-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1107"><a href="#cb60-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1108"><a href="#cb60-1108" aria-hidden="true" tabindex="-1"></a>The *p*-value is 0.0000002. The data are inconsistent with the hypothesis that there is no partial effect of education level on income (after accounting for differences in seniority level).</span>
<span id="cb60-1109"><a href="#cb60-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1110"><a href="#cb60-1110" aria-hidden="true" tabindex="-1"></a>We could also carry out these tests for the partial effect of seniority level and, if it is of interest, for the intercept. For both of those tests, we would use the same *t*-distribution, but our test statistic would be computed based on the coefficient estimates and standard errors for those terms, respectively.</span>
<span id="cb60-1111"><a href="#cb60-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1112"><a href="#cb60-1112" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-1113"><a href="#cb60-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1114"><a href="#cb60-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1115"><a href="#cb60-1115" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confidence/Compatibility Intervals for the Coefficients</span></span>
<span id="cb60-1116"><a href="#cb60-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1117"><a href="#cb60-1117" aria-hidden="true" tabindex="-1"></a>The confidence interval for the *k*th regression coefficient is computed as:</span>
<span id="cb60-1118"><a href="#cb60-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1119"><a href="#cb60-1119" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1120"><a href="#cb60-1120" aria-hidden="true" tabindex="-1"></a>\mathrm{CI} = \hat\beta_k \pm t^{*}(\mathrm{SE}_{\hat\beta_k})</span>
<span id="cb60-1121"><a href="#cb60-1121" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1122"><a href="#cb60-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1123"><a href="#cb60-1123" aria-hidden="true" tabindex="-1"></a>where $t^*$ is the quantile of the *t*-distribution that defines the confidence level for the interval. (This *t*-distribution, again, has degrees-of-freedom equal to the error *df* in the model.) The confidence level is related to the alpha level (type I error rate) used in inference. Namely,</span>
<span id="cb60-1124"><a href="#cb60-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1125"><a href="#cb60-1125" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1126"><a href="#cb60-1126" aria-hidden="true" tabindex="-1"></a>\mathrm{Confidence~Level} = 1 - \alpha</span>
<span id="cb60-1127"><a href="#cb60-1127" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1128"><a href="#cb60-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1129"><a href="#cb60-1129" aria-hidden="true" tabindex="-1"></a>So, if you use $\alpha=.05$, then the confidence level would be $.95$, and we would call this a 95% confidence interval. The alpha value also helps determine the quantile we use in the CI formula,</span>
<span id="cb60-1130"><a href="#cb60-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1131"><a href="#cb60-1131" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1132"><a href="#cb60-1132" aria-hidden="true" tabindex="-1"></a>t^* = (1-\frac{\alpha}{2}) ~ \mathrm{quantile}</span>
<span id="cb60-1133"><a href="#cb60-1133" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1134"><a href="#cb60-1134" aria-hidden="true" tabindex="-1"></a>For the example using $\alpha=.05$, a 95% confidence interval, the $t^*$ value would be associated with the quantile of 0.975. We would denote this as:</span>
<span id="cb60-1135"><a href="#cb60-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1136"><a href="#cb60-1136" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1137"><a href="#cb60-1137" aria-hidden="true" tabindex="-1"></a>t^{*}_{.975}</span>
<span id="cb60-1138"><a href="#cb60-1138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1139"><a href="#cb60-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1140"><a href="#cb60-1140" aria-hidden="true" tabindex="-1"></a>Say we wanted to find the 95% confidence interval for the education coefficient. We know that the estimated coefficient for education is 2.25, and the standard error for this estimate is 0.335. We also know that based on the model fitted, the residual *df* is 29. We need to find the 0.975th quantile in the *t*-distribution with 29 *df*.</span>
<span id="cb60-1141"><a href="#cb60-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1144"><a href="#cb60-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb60-1145"><a href="#cb60-1145" aria-hidden="true" tabindex="-1"></a><span class="co"># Find 0.975th quantile</span></span>
<span id="cb60-1146"><a href="#cb60-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">29</span>)</span>
<span id="cb60-1147"><a href="#cb60-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-1148"><a href="#cb60-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1149"><a href="#cb60-1149" aria-hidden="true" tabindex="-1"></a>Now we can use all of this information to compute the confidence interval:</span>
<span id="cb60-1150"><a href="#cb60-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1151"><a href="#cb60-1151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1152"><a href="#cb60-1152" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb60-1153"><a href="#cb60-1153" aria-hidden="true" tabindex="-1"></a>95\%~CI  &amp;= 2.25 \pm 2.04523(0.335) <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb60-1154"><a href="#cb60-1154" aria-hidden="true" tabindex="-1"></a>&amp;= \big<span class="co">[</span><span class="ot">1.56,~2.94\big</span><span class="co">]</span></span>
<span id="cb60-1155"><a href="#cb60-1155" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb60-1156"><a href="#cb60-1156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb60-1157"><a href="#cb60-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1158"><a href="#cb60-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1159"><a href="#cb60-1159" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-1160"><a href="#cb60-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1161"><a href="#cb60-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1162"><a href="#cb60-1162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Learn More</span></span>
<span id="cb60-1163"><a href="#cb60-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1164"><a href="#cb60-1164" aria-hidden="true" tabindex="-1"></a>For more information, you can also see the section *Some Continuous Distributions* in CHapter 5 of the @Fox:2021 textbook.</span>
<span id="cb60-1165"><a href="#cb60-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1166"><a href="#cb60-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1167"><a href="#cb60-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1168"><a href="#cb60-1168" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb60-1169"><a href="#cb60-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1170"><a href="#cb60-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-1171"><a href="#cb60-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>