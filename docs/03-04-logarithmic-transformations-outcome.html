<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Log-Transforming the Outcome – Advanced Modeling and Reproducibility for Educational Scientists</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-05-rule-of-the-bulge.html" rel="next">
<link href="./03-03-logarithmic-transformations-predictor.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed04999718f06b735b1f8009dce43b94.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7c121de436c7c20b050f1da4c0bef0bb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/sticky-notes.css">
<link rel="stylesheet" href="assets/table-styles.css">
</head>

<body class="nav-sidebar floating fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-modeling-nonlinearity.html">Modeling Nonlinearity</a></li><li class="breadcrumb-item"><a href="./03-04-logarithmic-transformations-outcome.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Modeling and Reproducibility for Educational Scientists</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Front Matter</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Statistical Reproducibility</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-project-organization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Project Organization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-introduction-to-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-more-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">More Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-creating-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Creating Tables with gt</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-likelihood.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Likelihood</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-01-mathematical-foundations-probability-density.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mathematical Foundations: Probability Density</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-03-likelihood-framework-for-evidence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Evidence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-04-likelihood-framework-for-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Likelihood: A Framework for Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-00-modeling-nonlinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonlinearity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-01-polynomial-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Polynomial Effects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-02-information-criteria-and-model-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Information Criteria and Model Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-03-logarithmic-transformations-predictor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-04-logarithmic-transformations-outcome.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-05-rule-of-the-bulge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Rule of the Bulge—An Example”</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-00-modeling-dichotomous-outcomes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Dichotomous Outcomes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-01-linear-probability-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-02-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Logistic Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-03-more-logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">More Logistic Regression</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-00-modeling-nonindependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Nonindependence</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-01-introduction-to-mixed-effects-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introduction to Mixed-Effects Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-02-lmer-average-change-over-time.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">LMER: Average Change Over Time</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-03-lmer-other-random-effects-and-covariates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">LMER: Other Random-Effects and Covariates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-04-lmer-alt-representations-and-assumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">LMER: Alternative Representations and Assumptions</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-00-modeling-nonlinearity.html">Modeling Nonlinearity</a></li><li class="breadcrumb-item"><a href="./03-04-logarithmic-transformations-outcome.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Log-Transforming the Outcome</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Quarto Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this set of notes, you will learn another method for dealing with nonlinearity. Specifically, we will look at log-transforming the outcome in a linear model. This transformation can also help rectify violations of the normality and homogeneity of variance assumptions. To do so, we will use the <a href="https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/carbon.csv"><em>carbon.csv</em></a> dataset. (See <a href="http://zief0002.github.io/fluffy-ants/codebooks/carbon.html">data codebook</a>.)</p>
<p>Our analytic goal will be to explain variation in worldwide carbon emissions. Specifically:</p>
<ul>
<li>What is the effect of a country’s wealth on carbon emissions?</li>
<li>Does this effect persist after controlling for urbanization?</li>
<li>Does this relationship vary between world regions?</li>
</ul>
<p>Within this work, we will use information theoretic approcaches (namely the AICc and related measures) to evaluate any fitted models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/carbon.csv"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>carbon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 5
   country             region      co2 wealth urbanization
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;
 1 Afghanistan         Asia      0.254   1.07        3.35 
 2 Albania             Europe    1.59    3.75        1.32 
 3 Algeria             Africa    3.69    3.54        2.81 
 4 Angola              Africa    1.12    2.71        4.31 
 5 Antigua and Barbuda Americas  5.88    4.36        0.432
 6 Argentina           Americas  4.41    4.49        1.15 
 7 Armenia             Europe    1.89    3.72        0.309
 8 Australia           Oceania  16.9     5.60        1.66 
 9 Austria             Europe    7.75    5.82        0.836
10 Azerbaijan          Europe    3.7     3.79        1.47 
# ℹ 179 more rows</code></pre>
</div>
</div>
<p><br></p>
<section id="relationship-between-wealth-and-carbon-emissions" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="relationship-between-wealth-and-carbon-emissions"><span class="header-section-number">11.1</span> Relationship between Wealth and Carbon Emissions</h2>
<p>To being the analysis, we will examine the marginal distributions of wealth (predictor) and carbon emissions (outcome), as well as a scatterplot between them for our sample data.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginal distribution of co2 (outcome)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> co2)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginal distribution of wealth (predictor)</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="dv">38</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">31.3</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Place figures side-by-side</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">/</span> p2) <span class="sc">|</span>  p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exploration" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Density plot of the distribution of carbon dioxide emissions (LEFT) and wealth (CENTER). The scatterplot (RIGHT) shows the relationship between wealth and carbon dioxide emissions. The loess smoother  (blue line) is also displayed on the scatterplot. Two countries having extreme CO2 emissions are also identified." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exploration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-exploration-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Density plot of the distribution of carbon dioxide emissions (LEFT) and wealth (CENTER). The scatterplot (RIGHT) shows the relationship between wealth and carbon dioxide emissions. The loess smoother  (blue line) is also displayed on the scatterplot. Two countries having extreme CO2 emissions are also identified.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exploration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Density plot of the distribution of carbon dioxide emissions (LEFT) and wealth (CENTER). The scatterplot (RIGHT) shows the relationship between wealth and carbon dioxide emissions. The loess smoother (blue line) is also displayed on the scatterplot. Two countries having extreme CO2 emissions are also identified.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The distribution of CO2 emissions is severely right-skewed. Although the median emissions is around 2.5 metric tons per person, the plot shows evidence that several countries have high emissions. The distribution of wealth is more symmetric (perhaps a little left-skewed), with most countries having a weath level around 3.5.</p>
<p>The scatterplot suggests a positive, nonlinear relationship between wealth and CO2 emissions; countries that are wealthier also tend to have higher CO2 emissions. It also suggests that there is more variation in CO2 emissions at higher levels of wealth than at lower levels of wealth—potential violation of the homoskedasticity assumption. The curvilinear relationship between wealth and carbon emissions suggests that we may want to include a quadratic effect of wealth in the model. We fit both a linear and quadratic model and show the residual plots for both models in <a href="#fig-resid-model-linear" class="quarto-xref">Figure&nbsp;<span>11.2</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-alt: "Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing CO2 emissions on wealth in a linear model (TOP) and in a model that includes a quadratic effect of wealth (BOTTOM). The reference line of Y=0 is also displayed in the scatterplot along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residual plots</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm<span class="fl">.1</span>) <span class="sc">/</span> <span class="fu">residual_plots</span>(lm<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resid-model-linear" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid-model-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-resid-model-linear-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid-model-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing CO2 emissions on wealth in a linear model (TOP) and in a model that includes a quadratic effect of wealth (BOTTOM). The reference line of Y=0 is also displayed in the scatterplot along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plots from the linear model show clear violations of almost every assumption. By including a quadratic effect of wealth in the model, we have mitigated the “linearity” assumption; the average residual is 0 in this model. However, the residual plots still suggest violations of the normality assumption and of the assumption of homoskedasticity.</p>
<p><br></p>
</section>
<section id="exponential-functions-another-non-linear-function" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="exponential-functions-another-non-linear-function"><span class="header-section-number">11.2</span> Exponential Functions: Another Non-Linear Function</h2>
<p>We do not have to use a quadratic function to model curvilinear relationships. We can use any mathematical function that mimics the curvilinear pattern observed in the data.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> One mathematical function that is useful for modeling curvilinearity is the exponential function. The exponential function is shown in the right-hand side of the figure below.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  (x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_01, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quadratic Function"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="dv">2</span><span class="sc">^</span>x)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Exponential Function"</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-quadratic-log" class="quarto-float quarto-figure quarto-figure-center anchored" alt="LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quadratic-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-quadratic-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quadratic-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.3: LEFT: Negative quadratic function of <em>X</em>. RIGHT: Logarithmic function of <em>X</em>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>These two functions have some similarities. They both model non-linear growth (continuous and increasing growth). However, in the quadratic function, the parabola changes direction (<em>y</em>-values decrease until some <em>x</em>-value, at which point the <em>y</em>-values increase). The exponential function, on the other hand, does not change direction—it continues to grow, at ever increasing amounts.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>To fit an exponential function we need to choose a <em>base</em> for the function and then we raise the right-hand side of our fitted equation using that base. For example, if we choose the base of 2, our fitted equation would be:</p>
<p><span class="math display">\[
\hat{Y}_i = 2^{\hat\beta_0 + \hat\beta_1(X_i)}
\]</span></p>
<p>Unfortunately, the <code>lm()</code> function does not allow us to fit this directly. There is, however, a workaround that we can employ. But, to do so, requires us to understand the relationship between exponents and logarithms.</p>
<!-- As you consider different mathematical functions, it is important to consider the substantive knowledge in an area. For example, while empirically both the quadratic polynomial model and the exponential model might both suggest reasonable fit to the data, in this context, the logarithmic model might be a more substantively sound model than the quadratic polynomial model. We would probably expect that the effect of SAT on graduation rate would diminish for schools with higher median SAT scores, but that it wouldn't actually change direction. (This would mean that at some value, an increase in SAT would be asociated with a lower graduation rate!) -->
<p><br></p>
<section id="quick-refresher-on-exponents-and-logarithms" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="quick-refresher-on-exponents-and-logarithms"><span class="header-section-number">11.2.1</span> Quick Refresher on Exponents and Logarithms</h3>
<p>The logarithm is an inverse function of an exponent. Consider this example,</p>
<p><span class="math display">\[
\log_2 (32)
\]</span></p>
<p>The base-2 logarithm of 32 is the exponent to which the base, 2 in our example, must be raised to produce 32. Mathematically it is equivalent to solving the following equation for <em>x</em>:</p>
<p><span class="math display">\[
\begin{split}
2^{x} &amp;= 32 \\
x &amp;= 5
\end{split}
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
\log_2 (32) = 5
\]</span></p>
<p>To compute a logarithm using R, we use the <code>log()</code> function. We also specify the argument <code>base=</code>, since logarithms are unique to a particular base. For example, to compute the mathematical expression <span class="math inline">\(\log_2 (32)\)</span>, we use</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">32</span>, <span class="at">base =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>There is also a shortcut function to use base-2.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log2</span>(<span class="dv">32</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="workaround-for-lm" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="workaround-for-lm"><span class="header-section-number">11.3</span> Workaround for <code>lm()</code></h2>
<p>Recall that what we want to fit is the following exponential model:</p>
<p><span class="math display">\[
\hat{Y}_i = 2^{\hat\beta_0 + \hat\beta_1(X_i)}
\]</span></p>
<p>What we will do is take the base-2 logarithm of both sides of the equation:</p>
<p><span class="math display">\[
\log_2(\hat{Y}_i) = \log_2\bigg(2^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg)
\]</span></p>
<p>Since logarithms and exponents are inverse functions, the log and power on right-hand side of the equation cancel out and we are left with:</p>
<p><span class="math display">\[
\log_2(\hat{Y}_i) = \hat\beta_0 + \hat\beta_1(X_i)
\]</span></p>
<p>That is, we can regress the log-transformed values of <em>Y</em> onto <em>X</em>.</p>
<p><br></p>
<section id="log-transforming-variables" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="log-transforming-variables"><span class="header-section-number">11.3.1</span> Log-Transforming Variables</h3>
<p>For our purposes, we need to log-transform each value of the <em>Y</em> attribute, namely the CO2 values in our data. Here, we will log-transform the CO2 values (using base-2). To do this we create a new column called <code>l2co2</code> using the <code>mutate()</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base-2 log-transformed CO2 values</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">l2co2 =</span> <span class="fu">log</span>(co2, <span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>carbon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 6
   country             region      co2 wealth urbanization  l2co2
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;
 1 Afghanistan         Asia      0.254   1.07        3.35  -1.98 
 2 Albania             Europe    1.59    3.75        1.32   0.669
 3 Algeria             Africa    3.69    3.54        2.81   1.88 
 4 Angola              Africa    1.12    2.71        4.31   0.163
 5 Antigua and Barbuda Americas  5.88    4.36        0.432  2.56 
 6 Argentina           Americas  4.41    4.49        1.15   2.14 
 7 Armenia             Europe    1.89    3.72        0.309  0.918
 8 Australia           Oceania  16.9     5.60        1.66   4.08 
 9 Austria             Europe    7.75    5.82        0.836  2.95 
10 Azerbaijan          Europe    3.7     3.79        1.47   1.89 
# ℹ 179 more rows</code></pre>
</div>
</div>
<p>How does the distribution of the log-transformed CO2 values compare to the distribution of raw CO2 values? We can examine the density plot of both the original and log-transformed variables to answer this.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> co2)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values of predictor"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> l2co2)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2 (Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Log-2 transformed carbon emissions"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-dist" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Density plot of the raw CO2 values (LEFT) and the base-2 log-transformed CO2 (RIGHT)." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-log-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Density plot of the raw CO2 values (LEFT) and the base-2 log-transformed CO2 (RIGHT).">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.4: Density plot of the raw CO2 values (LEFT) and the base-2 log-transformed CO2 (RIGHT).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Comparing the shapes of the two distributions, we see that:</p>
<ul>
<li>The original CO2 variable was right-skewed. The log-transformed variable is more symmetric. (It is perhaps even a bit left-skewed, although certainly closer to symmetric than the original.)</li>
<li>The scale is quite different between the two variables (one is, after all, log-transformed). This has greatly affected the center (mean) and the variation. Importantly, after log-transforming, the variation in the distribution is much smaller.</li>
</ul>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>Logarithmic transformations change the shape, center, and variation of a distribution! For modelers, they take (1) make a right-skewed variable more symmetric and (2) reduce the variation in the distribution.</p>
</div>
<p><br></p>
</section>
<section id="relationship-between-log-transformed-co2-emissions-and-wealth" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="relationship-between-log-transformed-co2-emissions-and-wealth"><span class="header-section-number">11.3.2</span> Relationship between Log-Transformed CO2 Emissions and Wealth</h3>
<p>Let’s examine the relationship between the log-transformed CO2 emissions and wealth.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> l2co2)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log2(Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="fl">5.25</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">4.97</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatterplot-log" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot between wealth and log base-2 transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterplot-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-scatterplot-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Scatterplot between wealth and log base-2 transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.5: Scatterplot between wealth and log base-2 transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Log-transforming the outcome has drastically affected the scale for the outcome. The relationship between wealth and the log-transformed CO2 emissions is much more linear (although not perfect). The two countries which had extremely high CO2 emissions when we examined raw CO2, no longer seems like outliers in the transformed data. The differences in variation of log-carbon emissions between lower wealth and higher wealth countries also seems less severe.</p>
<p>Has this helped us better meet the distributional assumptions for the regression model? To find out, we will fit the model using the log-transformed carbon emissions and examine the residual plots.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lm.log2 <span class="ot">=</span> <span class="fu">lm</span>(l2co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residual plots</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-resid-log" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing log-transformed CO2 emisssions on wealth. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-resid-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-resid-log-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%" alt="Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing log-transformed CO2 emisssions on wealth. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-resid-log-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.6: Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing log-transformed CO2 emisssions on wealth. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
<p>These plots suggest that after the transforming the outcome, there is a great deal of improvement in meeting the assumption of normality. The assumption of homoskedasticity also looks markedly improved. There still seems to be violations of the linearity assumption.</p>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>For now, we will proceed so you understand how to interpret coefficients from models where the outcome has been log-transformed, but we will come back and fix this nonlinearity later.</p>
</div>
<p><br></p>
</section>
</section>
<section id="interpreting-the-regression-output" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="interpreting-the-regression-output"><span class="header-section-number">11.4</span> Interpreting the Regression Output</h2>
<p>We will now examine the model- and coefficient-level output from the model.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.838         0.837 0.866      955. 5.60e-75     1  -237.  481.  490.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>The model-level summary information suggests that differences in wealth explains 83.8% of the variation in log-transformed carbon dioxide emissions. Since differences in <span class="math inline">\(\log_2(\mathrm{CO2})\)</span> imply that there are differences in the raw CO2 values, we would typically just say that “differences in wealth explain 83.8% of the variation in carbon dioxide emissions.” That is, we interpret the <span class="math inline">\(R^2\)</span> value as if we hadn’t used any log-transformation at all!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
  -3.168922    1.188289 </code></pre>
</div>
</div>
<p>From the coefficient-level output, the fitted equation is:</p>
<p><span class="math display">\[
\log_2\left(\widehat{\mathrm{CO2}_i}\right) = -3.17 + 1.19(\mathrm{Wealth}_i)
\]</span></p>
<p>We can interpret the coefficients as we always do, recognizing that these interpretation are based on the log-transformed outcome.</p>
<ul>
<li>The intercept value of <span class="math inline">\(-3.17\)</span> is the predicted log-2 transformed carbon dioxide emissions for countries with a wealth level of 0 (extrapolation).</li>
<li>The slope, <span class="math inline">\(\hat{\beta_1} = 1.19\)</span>, indicates that each one-unit difference in the wealth measure is associated with a 1.19-unit change in the log-2 carbon dioxide emission, on average.</li>
</ul>
<p><br></p>
<section id="better-interpretations-back-transforming-to-the-raw-metric" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="better-interpretations-back-transforming-to-the-raw-metric"><span class="header-section-number">11.4.1</span> Better Interpretations: Back-transforming to the Raw Metric</h3>
<p>While these interpretations are technically correct, it is more helpful to your readers (and more conventional) to interpret any regression results in the raw metric of the variable rather than log-transformed metric. This means we have to <em>back-transform the interpretations</em>. To think about how to do this, we first consider a more general expression of the fitted linear model:</p>
<p><span class="math display">\[
\log_2\left(\hat{Y}_i\right) = \hat\beta_0 + \hat\beta_1(X_{i})
\]</span></p>
<p>The left-hand side of the equation is in the log-transformed metric, which drives our interpretations. If we want to instead, interpret using the raw metric of <em>Y</em>, we need to back-transform from <span class="math inline">\(\log_2(Y)\)</span> to <em>Y</em>. To back-transform, we use the inverse function, which is to exponentiate using the base of the logarithm, in our case, base-2.</p>
<p><span class="math display">\[
2^{\log_2(Y_i)} = Y_i
\]</span></p>
<p>If we exponentiate the left-hand side of the equation, to maintain the equality, we also need to exponentiate the right-hand side of the equation.</p>
<p><span class="math display">\[
2^{\log_2(Y_i)} = 2^{\hat\beta_0 + \hat\beta_1(X_{i})}
\]</span></p>
<p>Then we use rules of exponents to simplify this.</p>
<p><span class="math display">\[
Y_i = 2^{\hat\beta_0} \times 2^{\hat\beta_1(X_{i})}
\]</span></p>
<p>For our example, we exponentiate both sides of the fitted equation to get the following back-transformed fitted equation:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = 2^{-3.17} \times 2^{1.19(\mathrm{Wealth}_i)}
\]</span></p>
<p><br></p>
</section>
<section id="substituting-in-values-for-wealth-to-interpret-effects" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="substituting-in-values-for-wealth-to-interpret-effects"><span class="header-section-number">11.4.2</span> Substituting in Values for Wealth to Interpret Effects</h3>
<p>To interpret the back-transformed effects, we can substitute in the different values for wealth and solve. For example when wealth = 0:</p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(0)}\\
&amp;= 0.111 \times 1 \\
&amp;= 0.111
\end{split}
\]</span></p>
<p>In R, we use the <code>^</code> operator to exponentiate. In our example, to compute the predicted caron dioxide emissions, we use the following:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predicted CO2 when wealth=0</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.17</span>) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="fl">1.19</span> <span class="sc">*</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1111053</code></pre>
</div>
</div>
<p>The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation). This is how we interpret the intercept! How about countries that have a wealth level of 1 (a one-unit difference in wealth from countries that have a wealth level of 0)?</p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(1)}\\
&amp;= 0.111 \times 2.28 \\
&amp;= 0.253
\end{split}
\]</span></p>
<p>The predicted CO2 emission for a countries that have a wealth level of 1 is 0.253 metric tons per person. This is 2.28 TIMES the emissions of countries that have a wealth level of 0. How about countries that have a wealth level of 2 (a one-unit difference in wealth from countries that have a wealth level of 1)?</p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(2)}\\
&amp;= 0.111 \times 5.21 \\
&amp;= 0.578
\end{split}
\]</span></p>
<p>Using another rule of exponents we could re-write this last fitted equation as:</p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times (2^{1.19})^2\\
&amp;= 0.111 \times 2.28^2 \\
&amp;= 0.111 \times 2.28 \times 2.28 \\
&amp;= 0.578
\end{split}
\]</span></p>
<p>This is 2.28 TIMES the emissions of countries that have a wealth level of 1. Each 1-unit increase in wealth is associated with an increase in CO2 emissions of a factor of 2.28 (i.e., 2.28 times higher CO2 emissions). The technical language we use to express “2.28 times” is a “2.28-fold difference”. So we would conventionally interpret this as:</p>
<blockquote class="blockquote">
<p>Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average.</p>
</blockquote>
<p>To summarize, when we back-transform from interpretations of log-<em>Y</em> to <em>Y</em> the rate-of-change is <strong>multiplicative rather than additive</strong>. And to determine the multiplicative rate-of-change, we take the base we chose to the power of the estimated slope, that is:</p>
<p><span class="math display">\[
\text{Rate-of-Change} = \text{base}^{\hat\beta_1}
\]</span></p>
<p>A computational shortcut to obtain the back-transformed interpretations is to exponentiate the output of the <code>coef()</code> function (which returns the coefficients from the fitted model).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain back-transformed interpretations</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">^</span> <span class="fu">coef</span>(lm.log2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
  0.1111884   2.2788237 </code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="interpretation-of-the-rate-of-change-as-percent-change" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="interpretation-of-the-rate-of-change-as-percent-change"><span class="header-section-number">11.4.3</span> Interpretation of the Rate-of-Change as Percent Change</h3>
<p>The results of log-transformed models are often interpreted as <em>percent change</em>. Rather than saying that each one-unit difference in wealth is associated with a 2.28-fold difference in carbon emissions, on average. We can also interpret this change as a percent change. To do this, we compute:</p>
<p><span class="math display">\[
\mathrm{Percent~Change} = (2^{\hat{\beta_1}} -1) \times 100
\]</span></p>
<p>In our example,</p>
<p><span class="math display">\[
\begin{split}
\mathrm{Percent~Change} &amp;= (2^{1.19} -1) \times 100 \\[1ex]
&amp;= 128.15
\end{split}
\]</span></p>
<p>Thus the interpretation is:</p>
<blockquote class="blockquote">
<p>Each one-unit difference in wealth is associated with a 128% change in carbon emissions, on average.</p>
</blockquote>
<div class="fyi">
<p><strong>WARNING</strong></p>
<p>Be very careful when you are working with and interpreting using percents. The phrases “percent change” and “percentage point change” are two very different things. For example, increasing a graduation rate from 50% to 60% represents an increase of 10 percentage points, but it is a 20% increase or a 120% change!</p>
</div>
<p><br></p>
</section>
<section id="plotting-the-fitted-model" class="level3" data-number="11.4.4">
<h3 data-number="11.4.4" class="anchored" data-anchor-id="plotting-the-fitted-model"><span class="header-section-number">11.4.4</span> Plotting the Fitted Model</h3>
<p>As always, we should plot the fitted model to aid in interpretation. To do this we will use the back-transformed expression of the fitted equation:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = 2^{-3.17} \times 2^{1.19(\mathrm{Wealth}_i)}
\]</span></p>
<p>This can be plotted by using the <code>geom_function()</code> layer of <code>ggplot()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.17</span>) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="fl">1.19</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model-02-fitted" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted CO2 emisssions as a function of wealth." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-02-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-model-02-fitted-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Plot of predicted CO2 emisssions as a function of wealth.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-02-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.7: Plot of predicted CO2 emisssions as a function of wealth.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on this plot, we see a non-linear, positive effect of wealth on carbon emissions. Wealthier countries tend to have higher carbon emissions, on average, but the increase in carbon emissions as countries get wealthier is not constant; it is exponentially increasing.</p>
<p><br></p>
</section>
</section>
<section id="using-a-different-base" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="using-a-different-base"><span class="header-section-number">11.5</span> Using a Different Base</h2>
<p>The choice of base-2 for our logarithm was arbitrary. We could have chosen any base. For example, another common base to use is base-10. Now the fitted equation will be represented as:</p>
<p><span class="math display">\[
\hat{Y}_i = 10^{\hat\beta_0 + \hat\beta_1(X_i)}
\]</span></p>
<p>Here we take the base-10 logarithm of both sides of the equation:</p>
<p><span class="math display">\[
\begin{split}
\log_{10}(\hat{Y}_i) &amp;= \log_{10}\bigg(10^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg) \\[2ex]
&amp;= \hat\beta_0 + \hat\beta_1(X_i)
\end{split}
\]</span></p>
<p>That is, we can regress the base-10 log-transformed values of <em>Y</em> onto <em>X</em>. To do this, we initially create a new column in the data that includes the base-10 logs of the carbon dioxide emission values. We can then use those as the outcome in our <code>lm()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base-10 log-transformed CO2 values</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">l10co2 =</span> <span class="fu">log</span>(co2, <span class="at">base =</span> <span class="dv">10</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>carbon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 7
   country             region      co2 wealth urbanization  l2co2  l10co2
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1 Afghanistan         Asia      0.254   1.07        3.35  -1.98  -0.595 
 2 Albania             Europe    1.59    3.75        1.32   0.669  0.201 
 3 Algeria             Africa    3.69    3.54        2.81   1.88   0.567 
 4 Angola              Africa    1.12    2.71        4.31   0.163  0.0492
 5 Antigua and Barbuda Americas  5.88    4.36        0.432  2.56   0.769 
 6 Argentina           Americas  4.41    4.49        1.15   2.14   0.644 
 7 Armenia             Europe    1.89    3.72        0.309  0.918  0.276 
 8 Australia           Oceania  16.9     5.60        1.66   4.08   1.23  
 9 Austria             Europe    7.75    5.82        0.836  2.95   0.889 
10 Azerbaijan          Europe    3.7     3.79        1.47   1.89   0.568 
# ℹ 179 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>lm.log10 <span class="ot">=</span> <span class="fu">lm</span>(l10co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.838         0.837 0.261      955. 5.60e-75     1  -12.9  31.7  41.4
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>The model-level output is identical to the model-level output from the base-2 model! That is differences in wealth explains 83.8% of the variation in CO2 emissions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
 -0.9539406   0.3577107 </code></pre>
</div>
</div>
<p>Because we changed the base, the coefficient estimates for the fitted equation have changed. Writing the new fitted equation:</p>
<p><span class="math display">\[
\log_{10}(\widehat{\mathrm{CO2}_i}) = -0.954 + 0.358(\mathrm{Wealth}_i)
\]</span></p>
<p>Or, back-transforming the left-hand side:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = 10^{-0.954} \times 10^{0.358(\mathrm{Wealth}_i)}
\]</span></p>
<p>To interpret these, we exponentiate the coefficients using base-10.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="sc">^</span> <span class="fu">coef</span>(lm.log10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
  0.1111884   2.2788237 </code></pre>
</div>
</div>
<p>We get the exact same back-transformed coefficients as we did when we back-transformed the base-2 coefficients! Based on these, the interpretations are:</p>
<ul>
<li><strong>Intercept:</strong> The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation).</li>
<li><strong>Rate-of-Change:</strong> Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average. OR using the language of percent change, each one-unit difference in wealth level is associated with a 128% increase in carbon emissions, on average.</li>
</ul>
<p>Lastly, we can plot the fitted curve.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.954</span>) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.358</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model-10-fitted" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted CO2 emisssions as a function of wealth." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-10-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-model-10-fitted-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Plot of predicted CO2 emisssions as a function of wealth.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-10-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.8: Plot of predicted CO2 emisssions as a function of wealth.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This is the exact same fitted curve we obtained from the base-2 model.</p>
<div class="fyi">
<p><strong>FYI</strong></p>
<p>It isn’t shown here, but because the fitted curve is exactly the same (i.e., the <em>Y</em>-hat values are the same), the residuals are exactly the same for the base-10 and base-2 models. This implies the residual plots will be identical as well. Changing the base does NOT change the fit of the model!</p>
<p>Changing the base does not change any of the information we get from the model. The model-level output is the same regardless of base. While the fitted equation changes depending on the base chosen, the back-transformed interpretations of the coefficients and the plot of the fitted curve are the same. Moreover the residuals and therefore your evaluations of the assumptions will be the same regardless of base!</p>
</div>
</section>
<section id="one-more-base-base-e" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="one-more-base-base-e"><span class="header-section-number">11.6</span> One More Base: Base-e</h2>
<p>One base that is commonly used for log-transformations in the social sciences is base-<em>e</em>. <em>e</em> is a mathematical constant (Euler’s number) that is approximately equal to 2.71828.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> We can obtain this by using the <code>exp()</code> function in R. This function takes <em>e</em> to some exponent that is given as the argument. So to obtain the approximation of <em>e</em> we use</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.718282</code></pre>
</div>
</div>
<p>The base-<em>e</em> logarithm for a number, referred to as the <em>natural logarithm</em>, can be obtained using the <code>log()</code> function with the argument <code>base=exp(1)</code>. However, this base is so commonly used that it is the default value for the <code>base=</code> argument. So, if we use the <code>log()</code> function without defining the <code>base=</code> argument, it will automatically use base-<em>e</em>. For example, the natural logarithm of 10 can be computed as</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.302585</code></pre>
</div>
</div>
<p>If we took <span class="math inline">\(e^{2.303}\)</span> we would obtain 10. The natural logarithm even has its own mathematical notation; <span class="math inline">\(\ln\)</span>. For example, we would mathematically express the natural logarithm of 10 as</p>
<p><span class="math display">\[
\ln (10) = 2.303
\]</span></p>
<p><br></p>
<section id="fitting-the-model-using-base-e-logarithms" class="level3" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="fitting-the-model-using-base-e-logarithms"><span class="header-section-number">11.6.1</span> Fitting the Model Using Base-e Logarithms</h3>
<p>The fitted equation will be represented as:</p>
<p><span class="math display">\[
\hat{Y}_i = e^{\hat\beta_0 + \hat\beta_1(X_i)}
\]</span></p>
<p>Here we take the natural logarithm of both sides of the equation:</p>
<p><span class="math display">\[
\begin{split}
\ln(\hat{Y}_i) &amp;= \ln\bigg(e^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg) \\[2ex]
&amp;= \hat\beta_0 + \hat\beta_1(X_i)
\end{split}
\]</span></p>
<p>That is, we can regress the natural log-transformed values of <em>Y</em> onto <em>X</em>. To do this, we initially create a new column in the data that includes the natural logs of the carbon dioxide emission values. We can then use those as the outcome in our <code>lm()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create natural log-transformed CO2 values</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">lnco2 =</span> <span class="fu">log</span>(co2)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>carbon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 8
   country             region      co2 wealth urbanization  l2co2  l10co2  lnco2
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
 1 Afghanistan         Asia      0.254   1.07        3.35  -1.98  -0.595  -1.37 
 2 Albania             Europe    1.59    3.75        1.32   0.669  0.201   0.464
 3 Algeria             Africa    3.69    3.54        2.81   1.88   0.567   1.31 
 4 Angola              Africa    1.12    2.71        4.31   0.163  0.0492  0.113
 5 Antigua and Barbuda Americas  5.88    4.36        0.432  2.56   0.769   1.77 
 6 Argentina           Americas  4.41    4.49        1.15   2.14   0.644   1.48 
 7 Armenia             Europe    1.89    3.72        0.309  0.918  0.276   0.637
 8 Australia           Oceania  16.9     5.60        1.66   4.08   1.23    2.83 
 9 Austria             Europe    7.75    5.82        0.836  2.95   0.889   2.05 
10 Azerbaijan          Europe    3.7     3.79        1.47   1.89   0.568   1.31 
# ℹ 179 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(lnco2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.838         0.837 0.600      955. 5.60e-75     1  -169.  344.  353.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>The model-level output is identical to the model-level output from the base-2 and base-10 model, which we expected. That is differences in wealth explains 83.8% of the variation in CO2 emissions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.ln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
 -2.1965295   0.8236594 </code></pre>
</div>
</div>
<p>Because we changed the base, the coefficient estimates for the fitted equation have changed. Writing the new fitted equation:</p>
<p><span class="math display">\[
\ln(\widehat{\mathrm{CO2}_i}) = -2.20 + 0.824(\mathrm{Wealth}_i)
\]</span></p>
<p>Or, back-transforming the left-hand side:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = e^{2.20} \times e^{0.824(\mathrm{Wealth}_i)}
\]</span></p>
<p>To interpret these, we exponentiate the coefficients using base-e.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponentiate using base-e</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(lm.ln))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth 
  0.1111884   2.2788237 </code></pre>
</div>
</div>
<p>We get the exact same back-transformed coefficients as we did when we back-transformed the base-2 coefficients. Again, this is expected. Based on these, the interpretations are:</p>
<ul>
<li><strong>Intercept:</strong> The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation).</li>
<li><strong>Rate-of-Change:</strong> Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average. OR using the language of percent change, each one-unit difference in wealth level is associated with a 128% increase in carbon emissions, on average.</li>
</ul>
<p>Lastly, we can plot the fitted curve.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.20</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.824</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-model-e-fitted" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted CO2 emisssions as a function of wealth." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-e-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-model-e-fitted-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Plot of predicted CO2 emisssions as a function of wealth.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-e-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.9: Plot of predicted CO2 emisssions as a function of wealth.
</figcaption>
</figure>
</div>
</div>
</div>
<p>This is the exact same fitted curve we obtained from the base-2 and base-10 models. Once again, this is completely expected.</p>
</section>
<section id="what-is-special-about-base-e" class="level3" data-number="11.6.2">
<h3 data-number="11.6.2" class="anchored" data-anchor-id="what-is-special-about-base-e"><span class="header-section-number">11.6.2</span> What is Special About Base-e</h3>
<p>Other than being a cool number, why do Social Scientists like using base-e? It turns out that if the slope estimate is small (e.g., <span class="math inline">\(\hat\beta_k &lt; 0.20\)</span>), we can directly take the slope value from the <code>coef()</code> output, multiply it by 100, and interpret it as the percent change. That is because for small values of the slope,</p>
<p><span class="math display">\[
(e^{\hat{\beta_1}} -1) \approx \hat{\beta_1}
\]</span></p>
<p>In our example, the slope is not less than 0.20, so we have to do the math, <span class="math inline">\((e^{0.824}-1)\times 100=128\)</span>, to compute the percent change.</p>
</section>
</section>
<section id="modeling-the-remaining-non-linearity" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="modeling-the-remaining-non-linearity"><span class="header-section-number">11.7</span> Modeling the Remaining Non-Linearity</h2>
<p>Remember that the residual plots suggested that the problem of heterogeneity in the residuals was “fixed” by using the log-transformed outcome, but it did not completely fix the non-linearity. We can also see this by plotting the log-transformed CO2 emisssions versus wealth.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> <span class="fu">log</span>(co2))) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ln(Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="fl">3.64</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">3.44</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatterplot-log-take2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatterplot between wealth and log-transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterplot-log-take2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-scatterplot-log-take2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Scatterplot between wealth and log-transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-log-take2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.10: Scatterplot between wealth and log-transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot.
</figcaption>
</figure>
</div>
</div>
</div>
<p>How do we model the non-linearity we observe in the relationship even after we log-transformed the outcome? The pattern shown by the loess smoother in the plot, suggests a curvilinear pattern similar to what we observed in the college data in previous sets of notes. This means we can try to model the non-linearity by including a polynomial effect of wealth in the model.</p>
<p>To see if this improves our assumptions we will fit the polynomial model and examine the residuals. Here we fit the model by creating the natural logarithm of the CO2 values directly in the <code>lm()</code>. (If we do that, we don’t have to create a new column of log-transfomed values in the data!)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit polynomial model</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>lm.poly <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.poly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residuals-log-quad" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Density plots of the standardized residuals and scatterplot of the standardized residuals versus the fitted values for the model using the linear and quadratic effects of wealth to predict variation in log-transfomed carbon emissions. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area) in the scatterplot. The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residuals-log-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-residuals-log-quad-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" alt="Density plots of the standardized residuals and scatterplot of the standardized residuals versus the fitted values for the model using the linear and quadratic effects of wealth to predict variation in log-transfomed carbon emissions. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area) in the scatterplot. The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residuals-log-quad-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.11: Density plots of the standardized residuals and scatterplot of the standardized residuals versus the fitted values for the model using the linear and quadratic effects of wealth to predict variation in log-transfomed carbon emissions. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area) in the scatterplot. The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on the residual plots, the polynomial model shows good fit to all the assumptions. Although this is reason enough to adopt the model that includes the quadratic term, we can also evaluate this by computing and comparing the AICc (and associated information theoretic metrics) for this model and the model that only includes the linear effect of wealth.</p>
<p>Because the <code>aictab()</code> function requires us to use the exact same outcome (computed in exactly the same way), we will refit the linear and quadratic models by computing the natural log of CO2 emissions directly in the <code>lm()</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit polynomial model</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>lm.poly <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.ln, lm.poly),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Linear effect"</span>, <span class="st">"Quadratic effect"</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                 K   AICc Delta_AICc AICcWt Cum.Wt      LL
Quadratic effect 4 313.80       0.00      1      1 -152.79
Linear effect    3 343.78      29.99      0      1 -168.83</code></pre>
</div>
</div>
<p>The empirical evidence supports adopting the polynomial model that includes both the quadratic and linear effects of wealth.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.poly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.863         0.862 0.552      581. 3.05e-80     2  -153.  314.  327.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>Examining the model-level summary information from the quadratic polynomial model, we find that the model explains 86.3% of the variation in CO2 emisssions.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.poly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      wealth I(wealth^2) 
 -2.8993795   1.3823852  -0.0836962 </code></pre>
</div>
</div>
<p>From the coefficient-level output, the fitted equation is:</p>
<p><span class="math display">\[
\ln\left(\widehat{\mathrm{CO2}_i}\right) = -2.90 + 1.38(\mathrm{Wealth}_i) - 0.0837(\mathrm{Wealth}_i^2)
\]</span></p>
<p><br></p>
<section id="interpreting-the-effect-of-wealth" class="level3" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="interpreting-the-effect-of-wealth"><span class="header-section-number">11.7.1</span> Interpreting the Effect of Wealth</h3>
<p>Since the quadratic term is an interaction term, we interpret the effect of wealth generally as:</p>
<div class="fyi">
<p><strong>INTERPRETATION</strong></p>
<p>The effect of wealth on carbon dioxide emissions depends on the level of wealth.</p>
</div>
<p>To better understand the nature of this relationship we plot the fitted curve. To do so, we first back-transform the metric of log-carbon emission to the metric of raw carbon emissions. Remember, this creates a multiplicative relationship among the exponentiated coefficients. Exponentiating both sides of the fitted equation:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = e^{-2.90} \times e^{1.38(\mathrm{Wealth}_i)} \times e^{-0.0837(\mathrm{Wealth}_i^2)}
\]</span></p>
<p>Plotting this function will allow us to understand the relationship between wealth and carbon emissions from the polynomial model. Inputting this into the <code>geom_function()</code> layer of our <code>ggplot()</code> syntax, we get:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.90</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.38</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0837</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)} ) <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-poly-fitted" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-poly-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-poly-fitted-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-poly-fitted-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.12: Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="FYI">
<p><strong>Answering the First Research Question</strong></p>
<p>The relationship between wealth and carbon emisssions is complicated. It combines the positive exponential growth we saw earlier with the change in curvature of the negative quadratic effect. In general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels.</p>
</div>
<p><br></p>
</section>
</section>
<section id="rq-2-does-the-quadratic-effect-of-wealth-persist-after-controlling-for-urbanization" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="rq-2-does-the-quadratic-effect-of-wealth-persist-after-controlling-for-urbanization"><span class="header-section-number">11.8</span> RQ 2: Does the quadratic effect of wealth persist after controlling for urbanization?</h2>
<p>To answer the second research we will include urbanization in the model as a covariate. That is, we will fit the model:</p>
<p><span class="math display">\[
\ln\left(\mathrm{CO2}_i\right) = \beta_0 + \beta_1(\mathrm{Wealth}_i) + \beta_2(\mathrm{Wealth}_i^2) + \beta_3(\mathrm{Urbanization_i}) + \epsilon_i
\]</span></p>
<p>where <span class="math inline">\(\epsilon_i\overset{\mathrm{i.i.d.}}{\sim}\mathcal{N}(0,\sigma^2_{\epsilon})\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization, <span class="at">data =</span> carbon)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.861         0.859 0.555      375. 2.30e-77     3  -152.  313.  329.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
<p>This model explains 86.1% of the variation in carbon emissions. We also look at the model evidence.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.ln, lm.poly, lm<span class="fl">.3</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Wealth"</span>, <span class="st">"Wealth, Wealth^2"</span>, <span class="st">"Wealth, Wealth^2, Urbanization"</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                               K   AICc Delta_AICc AICcWt Cum.Wt      LL
Wealth, Wealth^2, Urbanization 5 313.70       0.00   0.51   0.51 -151.68
Wealth, Wealth^2               4 313.80       0.10   0.49   1.00 -152.79
Wealth                         3 343.78      30.09   0.00   1.00 -168.83</code></pre>
</div>
</div>
<p>The model that included urbanization has more empirical evidence than the model that doesn’t, but the <span class="math inline">\(\Delta\)</span>AICc values and model probabilities suggest that both models are reasonable candidates.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       wealth  I(wealth^2) urbanization 
 -2.73862600   1.34091626  -0.08032407  -0.03308582 </code></pre>
</div>
</div>
<p>From the coefficient-level output, the fitted equation is:</p>
<p><span class="math display">\[
\ln\left(\widehat{\mathrm{CO2}_i}\right) = -2.74 + 1.34(\mathrm{Wealth}_i) -0.08(\mathrm{Wealth}_i^2) - 0.03(\mathrm{Urbanization}_i)
\]</span></p>
<p>Interpreting these in the log-metric:</p>
<ul>
<li>The intercept, <span class="math inline">\(\hat{\beta_0} = -2.74\)</span>, is the average predicted natural log of CO2 emissions for countries with a wealth level of 0 and an urbanization of 0 (extrapolation).</li>
<li>The linear slope of wealth would not be interpreted because it is part of an interaction term.</li>
<li>The effect of wealth on carbon emissions depends on the level of wealth, after controlling for differences in urbanization.</li>
<li>The urbanization effect indicates that each one-point difference in the urbanization measure is associated with lower natural log values of CO2 emissions by <span class="math inline">\(0.03\)</span>, on average, after controlling for differences in wealth.</li>
</ul>
<p>Back-transforming the fitted equation, we get:</p>
<p><span class="math display">\[
\widehat{\mathrm{CO2}_i} = e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(\mathrm{Urbanization}_i)}
\]</span></p>
<p>If we exponentiate the coefficients:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(lm<span class="fl">.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       wealth  I(wealth^2) urbanization 
  0.06465913   3.82254435   0.92281724   0.96745553 </code></pre>
</div>
</div>
<p>Interpreting these :</p>
<ul>
<li>The average predicted CO2 emissions for countries with a wealth level of 0 and an urbanization of 0 is .064 tonnes (extrapolation).</li>
<li>The linear slope of wealth would not be interpreted because it is part of an interaction term.</li>
<li>The effect of wealth on carbon emissions depends on the level of wealth, after controlling for differences in urbanization.</li>
<li>Each one-point difference in the urbanization measure is associated with a 0.96-fold change in CO2 emissions, on average, after controlling for differences in wealth. OR Each one-point difference in the urbanization measure is associated with a 3.25% decrease in CO2 emissions, on average, after controlling for differences in wealth.</li>
</ul>
<p>Plotting this function will allow us to understand the relationship between wealth, urbanization, and carbon emissions from the polynomial model. Here I choose a low level of urbanization (0.8) and a high level of urbanization (6.2) based on the data. We substitute these into the fitted equation to get an equation expressing carbon dioxide emissions as a function of wealth which we will then input into a <code>geom_function()</code> layer of our <code>ggplot()</code> syntax.</p>
<p><strong>Low Urbanization</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(0.8)} \\[2ex]
&amp;= .065 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times .976 \\[2ex]
&amp;= .0634 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p><strong>High Urbanization</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(6.2)} \\[2ex]
&amp;= .065 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times .830 \\[2ex]
&amp;= .054 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">0634</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.34</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.08</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#56b4e9"</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">054</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.34</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.08</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#0072b2"</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rq2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries with low (light blue) and high (dark blue) urbanization." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rq2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-rq2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries with low (light blue) and high (dark blue) urbanization.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rq2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.13: Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries with low (light blue) and high (dark blue) urbanization.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="fyi">
<p><strong>Answering the Second Research Question</strong></p>
<p>Here we see that in general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels. This pattern is similar for countries with both low and high urbanization, although the countries with higher urbanization have lower carbon dioxide emissions.</p>
</div>
</section>
<section id="rq-3-does-the-effect-of-wealth-vary-between-world-regions" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="rq-3-does-the-effect-of-wealth-vary-between-world-regions"><span class="header-section-number">11.9</span> RQ 3: Does the Effect of Wealth Vary Between World Regions?</h2>
<p>To answer the third research question, we will include world region and urbanization into the model along with our linear and quadratic effects of wealth. To determine if the effects of wealth are different across the different regions we have to include interaction effects between wealth and world region. Since our model includes a quadratic effect of wealth we need to include both:</p>
<ul>
<li><span class="math inline">\(\mathrm{Wealth} \times \mathrm{World~Region}\)</span>, and</li>
<li><span class="math inline">\(\mathrm{Wealth}^2 \times \mathrm{World~Region}\)</span></li>
</ul>
<p>Since world region is categorical, we will need to create a set of dummy variables to represent it in the models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variables for world region</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">africa =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Africa"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">asia =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Asia"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">americas =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Americas"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">europe =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Europe"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">oceania =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Oceania"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>carbon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 × 13
   country  region    co2 wealth urbanization  l2co2  l10co2  lnco2 africa  asia
   &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 Afghani… Asia    0.254   1.07        3.35  -1.98  -0.595  -1.37       0     1
 2 Albania  Europe  1.59    3.75        1.32   0.669  0.201   0.464      0     0
 3 Algeria  Africa  3.69    3.54        2.81   1.88   0.567   1.31       1     0
 4 Angola   Africa  1.12    2.71        4.31   0.163  0.0492  0.113      1     0
 5 Antigua… Ameri…  5.88    4.36        0.432  2.56   0.769   1.77       0     0
 6 Argenti… Ameri…  4.41    4.49        1.15   2.14   0.644   1.48       0     0
 7 Armenia  Europe  1.89    3.72        0.309  0.918  0.276   0.637      0     0
 8 Austral… Ocean… 16.9     5.60        1.66   4.08   1.23    2.83       0     0
 9 Austria  Europe  7.75    5.82        0.836  2.95   0.889   2.05       0     0
10 Azerbai… Europe  3.7     3.79        1.47   1.89   0.568   1.31       0     0
# ℹ 179 more rows
# ℹ 3 more variables: americas &lt;dbl&gt;, europe &lt;dbl&gt;, oceania &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We will start by fitting a model that includes the main-effect of world region in addition to our effects of wealth and urbanization. As always, when we have multiple dummy variables representing a predictor, we include all but one of the dummies in the model. Here we will omit Oceania (our reference group).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.4</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization <span class="sc">+</span> asia <span class="sc">+</span> africa <span class="sc">+</span> americas <span class="sc">+</span> europe, <span class="at">data =</span> carbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also want to include our interactions between world region and wealth. To do this we have to include multiple interaction terms because we have multiple dummy variables. For example, here is the model that includes interactions between region and the lineqar effect of wealth and region and the quadratic effects of wealth where, once again, Oceania is our references group.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.5</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>            asia <span class="sc">+</span> africa <span class="sc">+</span> americas <span class="sc">+</span> europe <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>            asia<span class="sc">:</span>wealth <span class="sc">+</span> africa<span class="sc">:</span>wealth <span class="sc">+</span> americas<span class="sc">:</span>wealth <span class="sc">+</span> europe<span class="sc">:</span>wealth <span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>            asia<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> africa<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> americas<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> europe<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> carbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Evaluating these models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm<span class="fl">.3</span>, lm<span class="fl">.4</span>, lm<span class="fl">.5</span>),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"No world region"</span>, <span class="st">"Main effect of region"</span>, <span class="st">"Interaction between region and wealth"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

                                       K   AICc Delta_AICc AICcWt Cum.Wt
Main effect of region                  9 296.21       0.00      1      1
Interaction between region and wealth 17 308.87      12.67      0      1
No world region                        5 313.70      17.49      0      1
                                           LL
Main effect of region                 -138.59
Interaction between region and wealth -135.60
No world region                       -151.68</code></pre>
</div>
</div>
<p>Here, the empirical evidence favors the model that includes the main effect of world region indicating that there is not evidence of an interaction between world region and wealth. Below we look at the coefficients and write the fitted equation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       wealth  I(wealth^2) urbanization         asia       africa 
  -2.1432012    1.2799732   -0.0693486   -0.0977616   -0.1547836   -0.3577002 
    americas       europe 
  -0.5942931   -0.7134999 </code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{split}
\ln\left(\widehat{\mathrm{CO2}_i}\right) = &amp;-2.14 + 1.28(\mathrm{Wealth}_i) -0.07(\mathrm{Wealth}_i^2) - 0.10(\mathrm{Urbanization}_i) \\
&amp;-0.16(\mathrm{Asia}_i) - .36(\mathrm{Africa}_i) - .59(\mathrm{Americas}_i) - 0.71(\mathrm{Europe}_i)
\end{split}
\]</span></p>
<p>Recall that the coefficients associated with the different regions are comparisons to the reference group. For example, the Asia coefficient indicates that Asia has lower log-CO2 emissions than Oceania by 0.16, on average, controlling for differences in wealth and urbanization. We can also back transform this and interpret it as percent change:</p>
<p><span class="math display">\[
e^{-.16} - 1 = -.147
\]</span></p>
<blockquote class="blockquote">
<p>Asia’s carbon emissions are 14.7% lower than Oceania’s carbon emissions, on average, controlling for differences in wealth and urbanization.</p>
</blockquote>
<p>In this analysis, we are most interested in the effect of wealth on CO2 emissions. So I will again create a plot of this model’s results. After creating this plot we can describe any regional differences, but we will not make inferences about regional differences. To create this plot I will set urbanization to its mean level (2.00) and then produce a fitted equation for each world region. I will do this with the back-transformed outcome.</p>
<div class="fyi">
<p><strong>PROTIP</strong></p>
<p>If the goal of the analysis was to compare different regions, you would have to fit other models to make the different comparisons. If we were using <em>p</em>-values for variable selection, you would also have to adjust based on the total number of pairwise (region-to-region) comparisons using something like the Boferroni or Benjamini-Hochberg adjustments. However, it is less clear how to view multiple comparisons when using information criteria. <span class="citation" data-cites="Dayton:1998">Dayton (<a href="#ref-Dayton:1998" role="doc-biblioref">1998</a>)</span> laid out a framework for using measures such as AIC for the multiple comparisons problem.</p>
</div>
<p><strong>Asia</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)} \times e^{-.16(1)} \times e^{-.36(0)} \times e^{-.59(0)} \times e^{-.71(0)}\\[2ex]
&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .852  \times 1 \times 1 \times 1\\[2ex]
&amp;= .082 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p>From this we note that the effects of the regions that were not Asia became 1 and dropped out of the model. We can use this in our other world regions to shorten the fitted equation.</p>
<p><strong>Africa</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.36(1)} \\[2ex]
&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .698 \\[2ex]
&amp;= .067 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p><strong>Americas</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.59(1)} \\[2ex]
&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .54 \\[2ex]
&amp;= .053 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p><strong>Europe</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.71(1)} \\[2ex]
&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .491 \\[2ex]
&amp;= .047 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p><strong>Oceania</strong></p>
<p><span class="math display">\[
\begin{split}
\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)} \\[2ex]
&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \\[2ex]
&amp;= .096 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}
\end{split}
\]</span></p>
<p>Then we will create our plot by adding one <code>geom_function()</code> layer for each region.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library for color in caption</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">082</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#1b2a41"</span>) <span class="sc">+</span> <span class="co">#Asia</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">067</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#99c24d"</span>) <span class="sc">+</span> <span class="co">#Africa</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">053</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#d30c7b"</span>) <span class="sc">+</span> <span class="co">#Americas</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">047</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#adcad6"</span>) <span class="sc">+</span> <span class="co">#Europe</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">096</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#bc69aa"</span>) <span class="sc">+</span> <span class="co">#Oceania</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Region: &lt;b style = 'color:#1b2a41;'&gt;Asia&lt;/b&gt;, &lt;b style = 'color:#99c24d;'&gt;Africa&lt;/b&gt;, &lt;b style = 'color:#d30c7b;'&gt;Americas&lt;/b&gt;, &lt;b style = 'color:#adcad6;'&gt;Europe&lt;/b&gt;, and &lt;b style = 'color:#bc69aa;'&gt;Oceania&lt;/b&gt;. "</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>()</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rq3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries from different regions of the world. Urbanization has been adjusted for by setting it to its mean value." data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rq3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="03-04-logarithmic-transformations-outcome_files/figure-html/fig-rq3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" alt="Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries from different regions of the world. Urbanization has been adjusted for by setting it to its mean value.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rq3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.14: Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries from different regions of the world. Urbanization has been adjusted for by setting it to its mean value.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="fyi">
<p><strong>Answering the Third Research Question</strong></p>
<p>Here we see that in general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels. This pattern is true for countries with both low and high urbanization, although the countries with higher urbanization have lower exponentially increasing carbon emissions.</p>
</div>
<p><br></p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Dayton:1998" class="csl-entry" role="listitem">
Dayton, C. M. (1998). Information criteria for the paired-comparisons problem. <em>The American Statistician</em>, <em>52</em>(2), 144–151.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>So long as we can ultimately write this function as a linear model, namely, <span class="math inline">\(Y_i=\beta_0+\beta_1(x_i) + \epsilon_i\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Mathematically, the instantaneous derivative of the exponential function is is always positive, and it approaches <span class="math inline">\(+\infty\)</span> for larger values of <em>x</em>, while that for the quadratic function changes in sign from negative to positive.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Fun Fact: <em>e</em> also happens to be Andy’s favorite number. Google founders might also enjoy <em>e</em>, as their IPO indicated they were going to raise <em>e</em>-billion dollars (see this <a href="https://www.forbes.com/sites/jayritter/2014/08/07/googles-ipo-10-years-later/?sh=13a7d532e6ca">Forbes article</a>).<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-03-logarithmic-transformations-predictor.html" class="pagination-link" aria-label="Log-Transforming the Predictor">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Log-Transforming the Predictor</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-05-rule-of-the-bulge.html" class="pagination-link" aria-label="Rule of the Bulge---An Example&quot;">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Rule of the Bulge—An Example”</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb73" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Log-Transforming the Outcome</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"scripts/_common.R"</span>)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>In this set of notes, you will learn another method for dealing with nonlinearity. Specifically, we will look at log-transforming the outcome in a linear model. This transformation can also help rectify violations of the normality and homogeneity of variance assumptions. To do so, we will use the <span class="co">[</span><span class="ot">*carbon.csv*</span><span class="co">](https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/carbon.csv)</span> dataset. (See <span class="co">[</span><span class="ot">data codebook</span><span class="co">](http://zief0002.github.io/fluffy-ants/codebooks/carbon.html)</span>.)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>Our analytic goal will be to explain variation in worldwide carbon emissions. Specifically:</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the effect of a country's wealth on carbon emissions?</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does this effect persist after controlling for urbanization?</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does this relationship vary between world regions? </span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>Within this work, we will use information theoretic approcaches (namely the AICc and related measures) to evaluate any fitted models. </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(educate) </span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in data</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://raw.githubusercontent.com/zief0002/fluffy-ants/main/data/carbon.csv"</span>)</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>carbon</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relationship between Wealth and Carbon Emissions</span></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>To being the analysis, we will examine the marginal distributions of wealth (predictor) and carbon emissions (outcome), as well as a scatterplot between them for our sample data.</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-exploration</span></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Density plot of the distribution of carbon dioxide emissions (LEFT) and wealth (CENTER). The scatterplot (RIGHT) shows the relationship between wealth and carbon dioxide emissions. The loess smoother  (blue line) is also displayed on the scatterplot. Two countries having extreme CO2 emissions are also identified."</span></span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Density plot of the distribution of carbon dioxide emissions (LEFT) and wealth (CENTER). The scatterplot (RIGHT) shows the relationship between wealth and carbon dioxide emissions. The loess smoother  (blue line) is also displayed on the scatterplot. Two countries having extreme CO2 emissions are also identified."</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginal distribution of co2 (outcome)</span></span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>)</span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginal distribution of wealth (predictor)</span></span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth)) <span class="sc">+</span></span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>)</span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="dv">38</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">31.3</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) </span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Place figures side-by-side</span></span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">/</span> p2) <span class="sc">|</span>  p3</span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true" tabindex="-1"></a>The distribution of CO2 emissions is severely right-skewed. Although the median emissions is around 2.5 metric tons per person, the plot shows evidence that several countries have high emissions. The distribution of wealth is more symmetric (perhaps a little left-skewed), with most countries having a weath level around 3.5.</span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true" tabindex="-1"></a>The scatterplot suggests a positive, nonlinear relationship between wealth and CO2 emissions; countries that are wealthier also tend to have higher CO2 emissions. It also suggests that there is more variation in CO2 emissions at higher levels of wealth than at lower levels of wealth---potential violation of the homoskedasticity assumption. The curvilinear relationship between wealth and carbon emissions suggests that we may want to include a quadratic effect of wealth in the model. We fit both a linear and quadratic model and show the residual plots for both models in @fig-resid-model-linear.</span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-resid-model-linear</span></span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing CO2 emissions on wealth in a linear model (TOP) and in a model that includes a quadratic effect of wealth (BOTTOM). The reference line of Y=0 is also displayed in the scatterplot along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true" tabindex="-1"></a><span class="co">#|fig-alt: "Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing CO2 emissions on wealth in a linear model (TOP) and in a model that includes a quadratic effect of wealth (BOTTOM). The reference line of Y=0 is also displayed in the scatterplot along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">lm</span>(co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residual plots</span></span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm<span class="fl">.1</span>) <span class="sc">/</span> <span class="fu">residual_plots</span>(lm<span class="fl">.2</span>)</span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true" tabindex="-1"></a>The plots from the linear model show clear violations of almost every assumption. By including a quadratic effect of wealth in the model, we have mitigated the "linearity" assumption; the average residual is 0 in this model. However, the residual plots still suggest violations of the normality assumption and of the assumption of homoskedasticity.</span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exponential Functions: Another Non-Linear Function</span></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true" tabindex="-1"></a>We do not have to use a quadratic function to model curvilinear relationships. We can use any mathematical function that mimics the curvilinear pattern observed in the data.^<span class="co">[</span><span class="ot">So long as we can ultimately write this function as a linear model, namely, $Y_i=\beta_0+\beta_1(x_i) + \epsilon_i$.</span><span class="co">]</span> One mathematical function that is useful for modeling curvilinearity is the exponential function. The exponential function is shown in the right-hand side of the figure below.</span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-quadratic-log</span></span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*."</span></span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "LEFT: Negative quadratic function of *X*. RIGHT: Logarithmic function of *X*."</span></span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-127"><a href="#cb73-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb73-128"><a href="#cb73-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-129"><a href="#cb73-129" aria-hidden="true" tabindex="-1"></a>fig_01 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb73-130"><a href="#cb73-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb73-131"><a href="#cb73-131" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb73-132"><a href="#cb73-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  (x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb73-133"><a href="#cb73-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-134"><a href="#cb73-134" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_01, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb73-135"><a href="#cb73-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-136"><a href="#cb73-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-137"><a href="#cb73-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb73-138"><a href="#cb73-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb73-139"><a href="#cb73-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quadratic Function"</span>)</span>
<span id="cb73-140"><a href="#cb73-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-141"><a href="#cb73-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-142"><a href="#cb73-142" aria-hidden="true" tabindex="-1"></a>fig_02 <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb73-143"><a href="#cb73-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fl">0.1</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb73-144"><a href="#cb73-144" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb73-145"><a href="#cb73-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span>  <span class="dv">2</span><span class="sc">^</span>x)</span>
<span id="cb73-146"><a href="#cb73-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-147"><a href="#cb73-147" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fig_02, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb73-148"><a href="#cb73-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-149"><a href="#cb73-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-150"><a href="#cb73-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">"X"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb73-151"><a href="#cb73-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">"Y"</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb73-152"><a href="#cb73-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Exponential Function"</span>)</span>
<span id="cb73-153"><a href="#cb73-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-154"><a href="#cb73-154" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb73-155"><a href="#cb73-155" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb73-156"><a href="#cb73-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-157"><a href="#cb73-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-158"><a href="#cb73-158" aria-hidden="true" tabindex="-1"></a>These two functions have some similarities. They both model non-linear growth (continuous and increasing growth). However, in the quadratic function, the parabola changes direction (*y*-values decrease until some *x*-value, at which point the *y*-values increase). The exponential function, on the other hand, does not change direction---it continues to grow, at ever increasing amounts.^[Mathematically, the instantaneous derivative of the exponential function is is always positive, and it approaches $+\infty$ for larger values of *x*, while that for the quadratic function changes in sign from negative to positive.]</span>
<span id="cb73-159"><a href="#cb73-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-160"><a href="#cb73-160" aria-hidden="true" tabindex="-1"></a>To fit an exponential function we need to choose a *base* for the function and then we raise the right-hand side of our fitted equation using that base. For example, if we choose the base of 2, our fitted equation would be:</span>
<span id="cb73-161"><a href="#cb73-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-162"><a href="#cb73-162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-163"><a href="#cb73-163" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = 2^{\hat\beta_0 + \hat\beta_1(X_i)}</span>
<span id="cb73-164"><a href="#cb73-164" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-165"><a href="#cb73-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-166"><a href="#cb73-166" aria-hidden="true" tabindex="-1"></a>Unfortunately, the <span class="in">`lm()`</span> function does not allow us to fit this directly. There is, however, a workaround that we can employ. But, to do so, requires us to understand the relationship between exponents and logarithms.</span>
<span id="cb73-167"><a href="#cb73-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-168"><a href="#cb73-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-169"><a href="#cb73-169" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- As you consider different mathematical functions, it is important to consider the substantive knowledge in an area. For example, while empirically both the quadratic polynomial model and the exponential model might both suggest reasonable fit to the data, in this context, the logarithmic model might be a more substantively sound model than the quadratic polynomial model. We would probably expect that the effect of SAT on graduation rate would diminish for schools with higher median SAT scores, but that it wouldn't actually change direction. (This would mean that at some value, an increase in SAT would be asociated with a lower graduation rate!) --&gt;</span></span>
<span id="cb73-170"><a href="#cb73-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-171"><a href="#cb73-171" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-172"><a href="#cb73-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-173"><a href="#cb73-173" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quick Refresher on Exponents and Logarithms</span></span>
<span id="cb73-174"><a href="#cb73-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-175"><a href="#cb73-175" aria-hidden="true" tabindex="-1"></a>The logarithm is an inverse function of an exponent. Consider this example,</span>
<span id="cb73-176"><a href="#cb73-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-177"><a href="#cb73-177" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-178"><a href="#cb73-178" aria-hidden="true" tabindex="-1"></a>\log_2 (32)</span>
<span id="cb73-179"><a href="#cb73-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-180"><a href="#cb73-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-181"><a href="#cb73-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-182"><a href="#cb73-182" aria-hidden="true" tabindex="-1"></a>The base-2 logarithm of 32 is the exponent to which the base, 2 in our example, must be raised to produce 32. Mathematically it is equivalent to solving the following equation for *x*:</span>
<span id="cb73-183"><a href="#cb73-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-184"><a href="#cb73-184" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-185"><a href="#cb73-185" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-186"><a href="#cb73-186" aria-hidden="true" tabindex="-1"></a>2^{x} &amp;= 32 <span class="sc">\\</span></span>
<span id="cb73-187"><a href="#cb73-187" aria-hidden="true" tabindex="-1"></a>x &amp;= 5</span>
<span id="cb73-188"><a href="#cb73-188" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-189"><a href="#cb73-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-190"><a href="#cb73-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-191"><a href="#cb73-191" aria-hidden="true" tabindex="-1"></a>Thus,</span>
<span id="cb73-192"><a href="#cb73-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-193"><a href="#cb73-193" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-194"><a href="#cb73-194" aria-hidden="true" tabindex="-1"></a>\log_2 (32) = 5</span>
<span id="cb73-195"><a href="#cb73-195" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-196"><a href="#cb73-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-197"><a href="#cb73-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-198"><a href="#cb73-198" aria-hidden="true" tabindex="-1"></a>To compute a logarithm using R, we use the <span class="in">`log()`</span> function. We also specify the argument <span class="in">`base=`</span>, since logarithms are unique to a particular base. For example, to compute the mathematical expression $\log_2 (32)$, we use</span>
<span id="cb73-199"><a href="#cb73-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-202"><a href="#cb73-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-203"><a href="#cb73-203" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">32</span>, <span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb73-204"><a href="#cb73-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-205"><a href="#cb73-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-206"><a href="#cb73-206" aria-hidden="true" tabindex="-1"></a>There is also a shortcut function to use base-2.</span>
<span id="cb73-207"><a href="#cb73-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-208"><a href="#cb73-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-211"><a href="#cb73-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-212"><a href="#cb73-212" aria-hidden="true" tabindex="-1"></a><span class="fu">log2</span>(<span class="dv">32</span>)</span>
<span id="cb73-213"><a href="#cb73-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-214"><a href="#cb73-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-215"><a href="#cb73-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-216"><a href="#cb73-216" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-217"><a href="#cb73-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-218"><a href="#cb73-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-219"><a href="#cb73-219" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workaround for `lm()`</span></span>
<span id="cb73-220"><a href="#cb73-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-221"><a href="#cb73-221" aria-hidden="true" tabindex="-1"></a>Recall that what we want to fit is the following exponential model:</span>
<span id="cb73-222"><a href="#cb73-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-223"><a href="#cb73-223" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-224"><a href="#cb73-224" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = 2^{\hat\beta_0 + \hat\beta_1(X_i)}</span>
<span id="cb73-225"><a href="#cb73-225" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-226"><a href="#cb73-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-227"><a href="#cb73-227" aria-hidden="true" tabindex="-1"></a>What we will do is take the base-2 logarithm of both sides of the equation:</span>
<span id="cb73-228"><a href="#cb73-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-229"><a href="#cb73-229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-230"><a href="#cb73-230" aria-hidden="true" tabindex="-1"></a>\log_2(\hat{Y}_i) = \log_2\bigg(2^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg)</span>
<span id="cb73-231"><a href="#cb73-231" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-232"><a href="#cb73-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-233"><a href="#cb73-233" aria-hidden="true" tabindex="-1"></a>Since logarithms and exponents are inverse functions, the log and power on right-hand side of the equation cancel out and we are left with:</span>
<span id="cb73-234"><a href="#cb73-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-235"><a href="#cb73-235" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-236"><a href="#cb73-236" aria-hidden="true" tabindex="-1"></a>\log_2(\hat{Y}_i) = \hat\beta_0 + \hat\beta_1(X_i)</span>
<span id="cb73-237"><a href="#cb73-237" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-238"><a href="#cb73-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-239"><a href="#cb73-239" aria-hidden="true" tabindex="-1"></a>That is, we can regress the log-transformed values of *Y* onto *X*.</span>
<span id="cb73-240"><a href="#cb73-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-241"><a href="#cb73-241" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-242"><a href="#cb73-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-243"><a href="#cb73-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-244"><a href="#cb73-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-Transforming Variables</span></span>
<span id="cb73-245"><a href="#cb73-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-246"><a href="#cb73-246" aria-hidden="true" tabindex="-1"></a>For our purposes, we need to log-transform each value of the *Y* attribute, namely the CO2 values in our data. Here, we will log-transform the CO2 values (using base-2). To do this we create a new column called <span class="in">`l2co2`</span> using the <span class="in">`mutate()`</span> function.</span>
<span id="cb73-247"><a href="#cb73-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-250"><a href="#cb73-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-251"><a href="#cb73-251" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base-2 log-transformed CO2 values</span></span>
<span id="cb73-252"><a href="#cb73-252" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb73-253"><a href="#cb73-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-254"><a href="#cb73-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">l2co2 =</span> <span class="fu">log</span>(co2, <span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb73-255"><a href="#cb73-255" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-256"><a href="#cb73-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-257"><a href="#cb73-257" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-258"><a href="#cb73-258" aria-hidden="true" tabindex="-1"></a>carbon</span>
<span id="cb73-259"><a href="#cb73-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-260"><a href="#cb73-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-261"><a href="#cb73-261" aria-hidden="true" tabindex="-1"></a>How does the distribution of the log-transformed CO2 values compare to the distribution of raw CO2 values? We can examine the density plot of both the original and log-transformed variables to answer this.</span>
<span id="cb73-262"><a href="#cb73-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-265"><a href="#cb73-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-266"><a href="#cb73-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-dist</span></span>
<span id="cb73-267"><a href="#cb73-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Density plot of the raw CO2 values (LEFT) and the base-2 log-transformed CO2 (RIGHT)."</span></span>
<span id="cb73-268"><a href="#cb73-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Density plot of the raw CO2 values (LEFT) and the base-2 log-transformed CO2 (RIGHT)."</span></span>
<span id="cb73-269"><a href="#cb73-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-270"><a href="#cb73-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-271"><a href="#cb73-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb73-272"><a href="#cb73-272" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb73-273"><a href="#cb73-273" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-274"><a href="#cb73-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb73-275"><a href="#cb73-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-276"><a href="#cb73-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Carbon emissions (metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb73-277"><a href="#cb73-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb73-278"><a href="#cb73-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values of predictor"</span>)</span>
<span id="cb73-279"><a href="#cb73-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-280"><a href="#cb73-280" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> l2co2)) <span class="sc">+</span></span>
<span id="cb73-281"><a href="#cb73-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb73-282"><a href="#cb73-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb73-283"><a href="#cb73-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log2 (Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb73-284"><a href="#cb73-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability density"</span>) <span class="sc">+</span></span>
<span id="cb73-285"><a href="#cb73-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Log-2 transformed carbon emissions"</span>)</span>
<span id="cb73-286"><a href="#cb73-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-287"><a href="#cb73-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Layout the plots</span></span>
<span id="cb73-288"><a href="#cb73-288" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span>
<span id="cb73-289"><a href="#cb73-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-290"><a href="#cb73-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-291"><a href="#cb73-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-292"><a href="#cb73-292" aria-hidden="true" tabindex="-1"></a>Comparing the shapes of the two distributions, we see that:</span>
<span id="cb73-293"><a href="#cb73-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-294"><a href="#cb73-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>The original CO2 variable was right-skewed. The log-transformed variable is more symmetric. (It is perhaps even a bit left-skewed, although certainly closer to symmetric than the original.)</span>
<span id="cb73-295"><a href="#cb73-295" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The scale is quite different between the two variables (one is, after all, log-transformed). This has greatly affected the center (mean) and the variation. Importantly, after log-transforming, the variation in the distribution is much smaller.</span>
<span id="cb73-296"><a href="#cb73-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-297"><a href="#cb73-297" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-298"><a href="#cb73-298" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb73-299"><a href="#cb73-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-300"><a href="#cb73-300" aria-hidden="true" tabindex="-1"></a>Logarithmic transformations change the shape, center, and variation of a distribution! For modelers, they take (1) make a right-skewed variable more symmetric and (2) reduce the variation in the distribution.</span>
<span id="cb73-301"><a href="#cb73-301" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-302"><a href="#cb73-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-303"><a href="#cb73-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-304"><a href="#cb73-304" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-305"><a href="#cb73-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-306"><a href="#cb73-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-307"><a href="#cb73-307" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relationship between Log-Transformed CO2 Emissions and Wealth</span></span>
<span id="cb73-308"><a href="#cb73-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-309"><a href="#cb73-309" aria-hidden="true" tabindex="-1"></a>Let's examine the relationship between the log-transformed CO2 emissions and wealth.</span>
<span id="cb73-310"><a href="#cb73-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-313"><a href="#cb73-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-314"><a href="#cb73-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatterplot-log</span></span>
<span id="cb73-315"><a href="#cb73-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot between wealth and log base-2 transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot."</span></span>
<span id="cb73-316"><a href="#cb73-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Scatterplot between wealth and log base-2 transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot."</span></span>
<span id="cb73-317"><a href="#cb73-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb73-318"><a href="#cb73-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb73-319"><a href="#cb73-319" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> l2co2)) <span class="sc">+</span></span>
<span id="cb73-320"><a href="#cb73-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-321"><a href="#cb73-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb73-322"><a href="#cb73-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-323"><a href="#cb73-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-324"><a href="#cb73-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log2(Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb73-325"><a href="#cb73-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="fl">5.25</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb73-326"><a href="#cb73-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">4.97</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) </span>
<span id="cb73-327"><a href="#cb73-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-328"><a href="#cb73-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-329"><a href="#cb73-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-330"><a href="#cb73-330" aria-hidden="true" tabindex="-1"></a>Log-transforming the outcome has drastically affected the scale for the outcome. The relationship between wealth and the log-transformed CO2 emissions is much more linear (although not perfect). The two countries which had extremely high CO2 emissions when we examined raw CO2, no longer seems like outliers in the transformed data. The differences in variation of log-carbon emissions between lower wealth and higher wealth countries also seems less severe.</span>
<span id="cb73-331"><a href="#cb73-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-332"><a href="#cb73-332" aria-hidden="true" tabindex="-1"></a>Has this helped us better meet the distributional assumptions for the regression model? To find out, we  will fit the model using the log-transformed carbon emissions and examine the residual plots.</span>
<span id="cb73-333"><a href="#cb73-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-334"><a href="#cb73-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-337"><a href="#cb73-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-338"><a href="#cb73-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-resid-log</span></span>
<span id="cb73-339"><a href="#cb73-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing log-transformed CO2 emisssions on wealth. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-340"><a href="#cb73-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Density plot of the standardized residuals (LEFT) and scatterplot of the standarized residuals versus the fitted values (RIGHT) from regressing log-transformed CO2 emisssions on wealth. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area). The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-341"><a href="#cb73-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-342"><a href="#cb73-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-343"><a href="#cb73-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "90%"</span></span>
<span id="cb73-344"><a href="#cb73-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-345"><a href="#cb73-345" aria-hidden="true" tabindex="-1"></a>lm.log2 <span class="ot">=</span> <span class="fu">lm</span>(l2co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb73-346"><a href="#cb73-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-347"><a href="#cb73-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain residual plots</span></span>
<span id="cb73-348"><a href="#cb73-348" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.log2)</span>
<span id="cb73-349"><a href="#cb73-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-350"><a href="#cb73-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-351"><a href="#cb73-351" aria-hidden="true" tabindex="-1"></a>These plots suggest that after the transforming the outcome, there is a great deal of improvement in meeting the assumption of normality. The assumption of homoskedasticity also looks markedly improved. There still seems to be violations of the linearity assumption.</span>
<span id="cb73-352"><a href="#cb73-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-353"><a href="#cb73-353" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-354"><a href="#cb73-354" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb73-355"><a href="#cb73-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-356"><a href="#cb73-356" aria-hidden="true" tabindex="-1"></a>For now, we will proceed so you understand how to interpret coefficients from models where the outcome has been log-transformed, but we will come back and fix this nonlinearity later.</span>
<span id="cb73-357"><a href="#cb73-357" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-358"><a href="#cb73-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-359"><a href="#cb73-359" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-360"><a href="#cb73-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-361"><a href="#cb73-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-362"><a href="#cb73-362" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpreting the Regression Output</span></span>
<span id="cb73-363"><a href="#cb73-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-364"><a href="#cb73-364" aria-hidden="true" tabindex="-1"></a>We will now examine the model- and coefficient-level output from the model.</span>
<span id="cb73-365"><a href="#cb73-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-368"><a href="#cb73-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-369"><a href="#cb73-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb73-370"><a href="#cb73-370" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log2)</span>
<span id="cb73-371"><a href="#cb73-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-372"><a href="#cb73-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-373"><a href="#cb73-373" aria-hidden="true" tabindex="-1"></a>The model-level summary information suggests that differences in wealth explains 83.8% of the variation in log-transformed carbon dioxide emissions. Since differences in $\log_2(\mathrm{CO2})$ imply that there are differences in the raw CO2 values, we would typically just say that "differences in wealth explain 83.8% of the variation in carbon dioxide emissions." That is, we interpret the $R^2$ value as if we hadn't used any log-transformation at all!</span>
<span id="cb73-374"><a href="#cb73-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-377"><a href="#cb73-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-378"><a href="#cb73-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-379"><a href="#cb73-379" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.log2)</span>
<span id="cb73-380"><a href="#cb73-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-381"><a href="#cb73-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-382"><a href="#cb73-382" aria-hidden="true" tabindex="-1"></a>From the coefficient-level output, the fitted equation is:</span>
<span id="cb73-383"><a href="#cb73-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-384"><a href="#cb73-384" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-385"><a href="#cb73-385" aria-hidden="true" tabindex="-1"></a>\log_2\left(\widehat{\mathrm{CO2}_i}\right) = -3.17 + 1.19(\mathrm{Wealth}_i)</span>
<span id="cb73-386"><a href="#cb73-386" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-387"><a href="#cb73-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-388"><a href="#cb73-388" aria-hidden="true" tabindex="-1"></a>We can interpret the coefficients as we always do, recognizing that these interpretation are based on the log-transformed outcome.</span>
<span id="cb73-389"><a href="#cb73-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-390"><a href="#cb73-390" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept value of $-3.17$ is the predicted log-2 transformed carbon dioxide emissions for countries with a wealth level of 0 (extrapolation).</span>
<span id="cb73-391"><a href="#cb73-391" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The slope, $\hat{\beta_1} = 1.19$, indicates that each one-unit difference in the wealth measure is associated with a 1.19-unit change in the log-2 carbon dioxide emission, on average.</span>
<span id="cb73-392"><a href="#cb73-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-393"><a href="#cb73-393" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-394"><a href="#cb73-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-395"><a href="#cb73-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-396"><a href="#cb73-396" aria-hidden="true" tabindex="-1"></a><span class="fu">### Better Interpretations: Back-transforming to the Raw Metric</span></span>
<span id="cb73-397"><a href="#cb73-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-398"><a href="#cb73-398" aria-hidden="true" tabindex="-1"></a>While these interpretations are technically correct, it is more helpful to your readers (and more conventional) to interpret any regression results in the raw metric of the variable rather than log-transformed metric. This means we have to *back-transform the interpretations*. To think about how to do this, we first consider a more general expression of the fitted linear model:</span>
<span id="cb73-399"><a href="#cb73-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-400"><a href="#cb73-400" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-401"><a href="#cb73-401" aria-hidden="true" tabindex="-1"></a>\log_2\left(\hat{Y}_i\right) = \hat\beta_0 + \hat\beta_1(X_{i})</span>
<span id="cb73-402"><a href="#cb73-402" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-403"><a href="#cb73-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-404"><a href="#cb73-404" aria-hidden="true" tabindex="-1"></a>The left-hand side of the equation is in the log-transformed metric, which drives our interpretations. If we want to instead, interpret using the raw metric of *Y*, we need to back-transform from $\log_2(Y)$ to *Y*. To back-transform, we use the inverse function, which is to exponentiate using the base of the logarithm, in our case, base-2.</span>
<span id="cb73-405"><a href="#cb73-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-406"><a href="#cb73-406" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-407"><a href="#cb73-407" aria-hidden="true" tabindex="-1"></a>2^{\log_2(Y_i)} = Y_i</span>
<span id="cb73-408"><a href="#cb73-408" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-409"><a href="#cb73-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-410"><a href="#cb73-410" aria-hidden="true" tabindex="-1"></a>If we exponentiate the left-hand side of the equation, to maintain the equality, we also need to exponentiate the right-hand side of the equation.</span>
<span id="cb73-411"><a href="#cb73-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-412"><a href="#cb73-412" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-413"><a href="#cb73-413" aria-hidden="true" tabindex="-1"></a>2^{\log_2(Y_i)} = 2^{\hat\beta_0 + \hat\beta_1(X_{i})}</span>
<span id="cb73-414"><a href="#cb73-414" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-415"><a href="#cb73-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-416"><a href="#cb73-416" aria-hidden="true" tabindex="-1"></a>Then we use rules of exponents to simplify this.</span>
<span id="cb73-417"><a href="#cb73-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-418"><a href="#cb73-418" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-419"><a href="#cb73-419" aria-hidden="true" tabindex="-1"></a>Y_i = 2^{\hat\beta_0} \times 2^{\hat\beta_1(X_{i})}</span>
<span id="cb73-420"><a href="#cb73-420" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-421"><a href="#cb73-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-422"><a href="#cb73-422" aria-hidden="true" tabindex="-1"></a>For our example, we exponentiate both sides of the fitted equation to get the following back-transformed fitted equation:</span>
<span id="cb73-423"><a href="#cb73-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-424"><a href="#cb73-424" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-425"><a href="#cb73-425" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = 2^{-3.17} \times 2^{1.19(\mathrm{Wealth}_i)}</span>
<span id="cb73-426"><a href="#cb73-426" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-427"><a href="#cb73-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-428"><a href="#cb73-428" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-429"><a href="#cb73-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-430"><a href="#cb73-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-431"><a href="#cb73-431" aria-hidden="true" tabindex="-1"></a><span class="fu">### Substituting in Values for Wealth to Interpret Effects</span></span>
<span id="cb73-432"><a href="#cb73-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-433"><a href="#cb73-433" aria-hidden="true" tabindex="-1"></a>To interpret the back-transformed effects, we can substitute in the different values for wealth and solve. For example when wealth = 0:</span>
<span id="cb73-434"><a href="#cb73-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-435"><a href="#cb73-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-436"><a href="#cb73-436" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-437"><a href="#cb73-437" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(0)}<span class="sc">\\</span></span>
<span id="cb73-438"><a href="#cb73-438" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111 \times 1 <span class="sc">\\</span></span>
<span id="cb73-439"><a href="#cb73-439" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111</span>
<span id="cb73-440"><a href="#cb73-440" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-441"><a href="#cb73-441" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-442"><a href="#cb73-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-443"><a href="#cb73-443" aria-hidden="true" tabindex="-1"></a>In R, we use the <span class="in">`^`</span> operator to exponentiate. In our example, to compute the predicted caron dioxide emissions, we use the following:</span>
<span id="cb73-444"><a href="#cb73-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-447"><a href="#cb73-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-448"><a href="#cb73-448" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute predicted CO2 when wealth=0</span></span>
<span id="cb73-449"><a href="#cb73-449" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.17</span>) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="fl">1.19</span> <span class="sc">*</span> <span class="dv">0</span>)</span>
<span id="cb73-450"><a href="#cb73-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-451"><a href="#cb73-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-452"><a href="#cb73-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-453"><a href="#cb73-453" aria-hidden="true" tabindex="-1"></a>The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation). This is how we interpret the intercept! How about countries that have a wealth level of 1 (a one-unit difference in wealth from countries that have a wealth level of 0)?</span>
<span id="cb73-454"><a href="#cb73-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-455"><a href="#cb73-455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-456"><a href="#cb73-456" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-457"><a href="#cb73-457" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(1)}<span class="sc">\\</span></span>
<span id="cb73-458"><a href="#cb73-458" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111 \times 2.28 <span class="sc">\\</span></span>
<span id="cb73-459"><a href="#cb73-459" aria-hidden="true" tabindex="-1"></a>&amp;= 0.253</span>
<span id="cb73-460"><a href="#cb73-460" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-461"><a href="#cb73-461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-462"><a href="#cb73-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-463"><a href="#cb73-463" aria-hidden="true" tabindex="-1"></a>The predicted CO2 emission for a countries that have a wealth level of 1 is 0.253 metric tons per person. This is 2.28 TIMES the emissions of countries that have a wealth level of 0. How about countries that have a wealth level of 2 (a one-unit difference in wealth from countries that have a wealth level of 1)?</span>
<span id="cb73-464"><a href="#cb73-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-465"><a href="#cb73-465" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-466"><a href="#cb73-466" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-467"><a href="#cb73-467" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times 2^{1.19(2)}<span class="sc">\\</span></span>
<span id="cb73-468"><a href="#cb73-468" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111 \times 5.21 <span class="sc">\\</span></span>
<span id="cb73-469"><a href="#cb73-469" aria-hidden="true" tabindex="-1"></a>&amp;= 0.578</span>
<span id="cb73-470"><a href="#cb73-470" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-471"><a href="#cb73-471" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-472"><a href="#cb73-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-473"><a href="#cb73-473" aria-hidden="true" tabindex="-1"></a>Using another rule of exponents we could re-write this last fitted equation as:</span>
<span id="cb73-474"><a href="#cb73-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-475"><a href="#cb73-475" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-476"><a href="#cb73-476" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-477"><a href="#cb73-477" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= 2^{-3.17} \times (2^{1.19})^2<span class="sc">\\</span></span>
<span id="cb73-478"><a href="#cb73-478" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111 \times 2.28^2 <span class="sc">\\</span></span>
<span id="cb73-479"><a href="#cb73-479" aria-hidden="true" tabindex="-1"></a>&amp;= 0.111 \times 2.28 \times 2.28 <span class="sc">\\</span></span>
<span id="cb73-480"><a href="#cb73-480" aria-hidden="true" tabindex="-1"></a>&amp;= 0.578</span>
<span id="cb73-481"><a href="#cb73-481" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-482"><a href="#cb73-482" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-483"><a href="#cb73-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-484"><a href="#cb73-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-485"><a href="#cb73-485" aria-hidden="true" tabindex="-1"></a>This is 2.28 TIMES the emissions of countries that have a wealth level of 1. Each 1-unit increase in wealth is associated with an increase in CO2 emissions of a factor of 2.28 (i.e., 2.28 times higher CO2 emissions). The technical language we use to express "2.28 times" is a "2.28-fold difference". So we would conventionally interpret this as:</span>
<span id="cb73-486"><a href="#cb73-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-487"><a href="#cb73-487" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average.</span></span>
<span id="cb73-488"><a href="#cb73-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-489"><a href="#cb73-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-490"><a href="#cb73-490" aria-hidden="true" tabindex="-1"></a>To summarize, when we back-transform from interpretations of log-*Y* to *Y* the rate-of-change is **multiplicative rather than additive**. And to determine the multiplicative rate-of-change, we take the base we chose to the power of the estimated slope, that is:</span>
<span id="cb73-491"><a href="#cb73-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-492"><a href="#cb73-492" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-493"><a href="#cb73-493" aria-hidden="true" tabindex="-1"></a>\text{Rate-of-Change} = \text{base}^{\hat\beta_1}</span>
<span id="cb73-494"><a href="#cb73-494" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-495"><a href="#cb73-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-496"><a href="#cb73-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-497"><a href="#cb73-497" aria-hidden="true" tabindex="-1"></a>A computational shortcut to obtain the back-transformed interpretations is to exponentiate the output of the <span class="in">`coef()`</span> function (which returns the coefficients from the fitted model).</span>
<span id="cb73-498"><a href="#cb73-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-501"><a href="#cb73-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-502"><a href="#cb73-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain back-transformed interpretations</span></span>
<span id="cb73-503"><a href="#cb73-503" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">^</span> <span class="fu">coef</span>(lm.log2)</span>
<span id="cb73-504"><a href="#cb73-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-505"><a href="#cb73-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-506"><a href="#cb73-506" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-507"><a href="#cb73-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-508"><a href="#cb73-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-509"><a href="#cb73-509" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of the Rate-of-Change as Percent Change</span></span>
<span id="cb73-510"><a href="#cb73-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-511"><a href="#cb73-511" aria-hidden="true" tabindex="-1"></a>The results of log-transformed models are often interpreted as *percent change*. Rather than saying that each one-unit difference in wealth is associated with a 2.28-fold difference in carbon emissions, on average. We can also interpret this change as a percent change. To do this, we compute:</span>
<span id="cb73-512"><a href="#cb73-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-513"><a href="#cb73-513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-514"><a href="#cb73-514" aria-hidden="true" tabindex="-1"></a>\mathrm{Percent~Change} = (2^{\hat{\beta_1}} -1) \times 100</span>
<span id="cb73-515"><a href="#cb73-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-516"><a href="#cb73-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-517"><a href="#cb73-517" aria-hidden="true" tabindex="-1"></a>In our example,</span>
<span id="cb73-518"><a href="#cb73-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-519"><a href="#cb73-519" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-520"><a href="#cb73-520" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-521"><a href="#cb73-521" aria-hidden="true" tabindex="-1"></a>\mathrm{Percent~Change} &amp;= (2^{1.19} -1) \times 100 <span class="sc">\\</span><span class="co">[</span><span class="ot">1ex</span><span class="co">]</span></span>
<span id="cb73-522"><a href="#cb73-522" aria-hidden="true" tabindex="-1"></a>&amp;= 128.15</span>
<span id="cb73-523"><a href="#cb73-523" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-524"><a href="#cb73-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-525"><a href="#cb73-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-526"><a href="#cb73-526" aria-hidden="true" tabindex="-1"></a>Thus the interpretation is:</span>
<span id="cb73-527"><a href="#cb73-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-528"><a href="#cb73-528" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Each one-unit difference in wealth is associated with a 128% change in carbon emissions, on average.</span></span>
<span id="cb73-529"><a href="#cb73-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-530"><a href="#cb73-530" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-531"><a href="#cb73-531" aria-hidden="true" tabindex="-1"></a>**WARNING**</span>
<span id="cb73-532"><a href="#cb73-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-533"><a href="#cb73-533" aria-hidden="true" tabindex="-1"></a>Be very careful when you are working with and interpreting using percents. The phrases "percent change" and "percentage point change" are two very different things. For example, increasing a graduation rate from 50% to 60% represents an increase of 10 percentage points, but it is a 20% increase or a 120% change!</span>
<span id="cb73-534"><a href="#cb73-534" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-535"><a href="#cb73-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-536"><a href="#cb73-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-537"><a href="#cb73-537" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-538"><a href="#cb73-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-539"><a href="#cb73-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-540"><a href="#cb73-540" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plotting the Fitted Model</span></span>
<span id="cb73-541"><a href="#cb73-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-542"><a href="#cb73-542" aria-hidden="true" tabindex="-1"></a>As always, we should plot the fitted model to aid in interpretation. To do this we will use the back-transformed expression of the fitted equation:</span>
<span id="cb73-543"><a href="#cb73-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-544"><a href="#cb73-544" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-545"><a href="#cb73-545" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = 2^{-3.17} \times 2^{1.19(\mathrm{Wealth}_i)}</span>
<span id="cb73-546"><a href="#cb73-546" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-547"><a href="#cb73-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-548"><a href="#cb73-548" aria-hidden="true" tabindex="-1"></a>This can be plotted by using the <span class="in">`geom_function()`</span> layer of <span class="in">`ggplot()`</span>.</span>
<span id="cb73-549"><a href="#cb73-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-552"><a href="#cb73-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-553"><a href="#cb73-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-02-fitted</span></span>
<span id="cb73-554"><a href="#cb73-554" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-555"><a href="#cb73-555" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-556"><a href="#cb73-556" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-557"><a href="#cb73-557" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-558"><a href="#cb73-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-559"><a href="#cb73-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">3.17</span>) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>(<span class="fl">1.19</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb73-560"><a href="#cb73-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-561"><a href="#cb73-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-562"><a href="#cb73-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span>
<span id="cb73-563"><a href="#cb73-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-564"><a href="#cb73-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-565"><a href="#cb73-565" aria-hidden="true" tabindex="-1"></a>Based on this plot, we see a non-linear, positive effect of wealth on carbon emissions. Wealthier countries tend to have higher carbon emissions, on average, but the increase in carbon emissions as countries get wealthier is not constant; it is exponentially increasing.</span>
<span id="cb73-566"><a href="#cb73-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-567"><a href="#cb73-567" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-568"><a href="#cb73-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-569"><a href="#cb73-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-570"><a href="#cb73-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using a Different Base</span></span>
<span id="cb73-571"><a href="#cb73-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-572"><a href="#cb73-572" aria-hidden="true" tabindex="-1"></a>The choice of base-2 for our logarithm was arbitrary. We could have chosen any base. For example, another common base to use is base-10. Now the fitted equation will be represented as:</span>
<span id="cb73-573"><a href="#cb73-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-574"><a href="#cb73-574" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-575"><a href="#cb73-575" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = 10^{\hat\beta_0 + \hat\beta_1(X_i)}</span>
<span id="cb73-576"><a href="#cb73-576" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-577"><a href="#cb73-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-578"><a href="#cb73-578" aria-hidden="true" tabindex="-1"></a>Here we take the base-10 logarithm of both sides of the equation:</span>
<span id="cb73-579"><a href="#cb73-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-580"><a href="#cb73-580" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-581"><a href="#cb73-581" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-582"><a href="#cb73-582" aria-hidden="true" tabindex="-1"></a>\log_{10}(\hat{Y}_i) &amp;= \log_{10}\bigg(10^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg) <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-583"><a href="#cb73-583" aria-hidden="true" tabindex="-1"></a>&amp;= \hat\beta_0 + \hat\beta_1(X_i)</span>
<span id="cb73-584"><a href="#cb73-584" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-585"><a href="#cb73-585" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-586"><a href="#cb73-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-587"><a href="#cb73-587" aria-hidden="true" tabindex="-1"></a>That is, we can regress the base-10 log-transformed values of *Y* onto *X*. To do this, we initially create a new column in the data that includes the base-10 logs of the carbon dioxide emission values. We can then use those as the outcome in our <span class="in">`lm()`</span>.</span>
<span id="cb73-588"><a href="#cb73-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-591"><a href="#cb73-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-592"><a href="#cb73-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base-10 log-transformed CO2 values</span></span>
<span id="cb73-593"><a href="#cb73-593" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb73-594"><a href="#cb73-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-595"><a href="#cb73-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">l10co2 =</span> <span class="fu">log</span>(co2, <span class="at">base =</span> <span class="dv">10</span>)</span>
<span id="cb73-596"><a href="#cb73-596" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-597"><a href="#cb73-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-598"><a href="#cb73-598" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-599"><a href="#cb73-599" aria-hidden="true" tabindex="-1"></a>carbon</span>
<span id="cb73-600"><a href="#cb73-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-601"><a href="#cb73-601" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-602"><a href="#cb73-602" aria-hidden="true" tabindex="-1"></a>lm.log10 <span class="ot">=</span> <span class="fu">lm</span>(l10co2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb73-603"><a href="#cb73-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-604"><a href="#cb73-604" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb73-605"><a href="#cb73-605" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.log10)</span>
<span id="cb73-606"><a href="#cb73-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-607"><a href="#cb73-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-608"><a href="#cb73-608" aria-hidden="true" tabindex="-1"></a>The model-level output is identical to the model-level output from the base-2 model! That is differences in wealth explains 83.8% of the variation in CO2 emissions.</span>
<span id="cb73-609"><a href="#cb73-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-612"><a href="#cb73-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-613"><a href="#cb73-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-614"><a href="#cb73-614" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.log10)</span>
<span id="cb73-615"><a href="#cb73-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-616"><a href="#cb73-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-617"><a href="#cb73-617" aria-hidden="true" tabindex="-1"></a>Because we changed the base, the coefficient estimates for the fitted equation have changed. Writing the new fitted equation:</span>
<span id="cb73-618"><a href="#cb73-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-619"><a href="#cb73-619" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-620"><a href="#cb73-620" aria-hidden="true" tabindex="-1"></a>\log_{10}(\widehat{\mathrm{CO2}_i}) = -0.954 + 0.358(\mathrm{Wealth}_i)</span>
<span id="cb73-621"><a href="#cb73-621" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-622"><a href="#cb73-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-623"><a href="#cb73-623" aria-hidden="true" tabindex="-1"></a>Or, back-transforming the left-hand side:</span>
<span id="cb73-624"><a href="#cb73-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-625"><a href="#cb73-625" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-626"><a href="#cb73-626" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = 10^{-0.954} \times 10^{0.358(\mathrm{Wealth}_i)}</span>
<span id="cb73-627"><a href="#cb73-627" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-628"><a href="#cb73-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-629"><a href="#cb73-629" aria-hidden="true" tabindex="-1"></a>To interpret these, we exponentiate the coefficients using base-10.</span>
<span id="cb73-630"><a href="#cb73-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-633"><a href="#cb73-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-634"><a href="#cb73-634" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="sc">^</span> <span class="fu">coef</span>(lm.log10)</span>
<span id="cb73-635"><a href="#cb73-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-636"><a href="#cb73-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-637"><a href="#cb73-637" aria-hidden="true" tabindex="-1"></a>We get the exact same back-transformed coefficients as we did when we back-transformed the base-2 coefficients! Based on these, the interpretations are:</span>
<span id="cb73-638"><a href="#cb73-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-639"><a href="#cb73-639" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Intercept:** The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation).</span>
<span id="cb73-640"><a href="#cb73-640" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Rate-of-Change:** Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average. OR using the language of percent change, each one-unit difference in wealth level is associated with a 128% increase in carbon emissions, on average.</span>
<span id="cb73-641"><a href="#cb73-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-642"><a href="#cb73-642" aria-hidden="true" tabindex="-1"></a>Lastly, we can plot the fitted curve.</span>
<span id="cb73-643"><a href="#cb73-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-644"><a href="#cb73-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-647"><a href="#cb73-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-648"><a href="#cb73-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-10-fitted</span></span>
<span id="cb73-649"><a href="#cb73-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-650"><a href="#cb73-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-651"><a href="#cb73-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-652"><a href="#cb73-652" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-653"><a href="#cb73-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-654"><a href="#cb73-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.954</span>) <span class="sc">*</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">0.358</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb73-655"><a href="#cb73-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-656"><a href="#cb73-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-657"><a href="#cb73-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span>
<span id="cb73-658"><a href="#cb73-658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-659"><a href="#cb73-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-660"><a href="#cb73-660" aria-hidden="true" tabindex="-1"></a>This is the exact same fitted curve we obtained from the base-2 model.</span>
<span id="cb73-661"><a href="#cb73-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-662"><a href="#cb73-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-663"><a href="#cb73-663" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-664"><a href="#cb73-664" aria-hidden="true" tabindex="-1"></a>**FYI**</span>
<span id="cb73-665"><a href="#cb73-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-666"><a href="#cb73-666" aria-hidden="true" tabindex="-1"></a>It isn't shown here, but because the fitted curve is exactly the same (i.e., the *Y*-hat values are the same), the residuals are exactly the same for the base-10 and base-2 models. This implies the residual plots will be identical as well. Changing the base does NOT change the fit of the model!</span>
<span id="cb73-667"><a href="#cb73-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-668"><a href="#cb73-668" aria-hidden="true" tabindex="-1"></a>Changing the base does not change any of the information we get from the model. The model-level output is the same regardless of base. While the fitted equation changes depending on the base chosen, the back-transformed interpretations of the coefficients and the plot of the fitted curve are the same. Moreover the residuals and therefore your evaluations of the assumptions will be the same regardless of base!</span>
<span id="cb73-669"><a href="#cb73-669" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-670"><a href="#cb73-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-671"><a href="#cb73-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-672"><a href="#cb73-672" aria-hidden="true" tabindex="-1"></a><span class="fu">## One More Base: Base-e</span></span>
<span id="cb73-673"><a href="#cb73-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-674"><a href="#cb73-674" aria-hidden="true" tabindex="-1"></a>One base that is commonly used for log-transformations in the social sciences is base-*e*. *e* is a mathematical constant (Euler's number) that is approximately equal to 2.71828.^[Fun Fact: *e* also happens to be Andy's favorite number. Google founders might also enjoy *e*, as their IPO indicated they were going to raise *e*-billion dollars (see this [Forbes article](https://www.forbes.com/sites/jayritter/2014/08/07/googles-ipo-10-years-later/?sh=13a7d532e6ca)).] We can obtain this by using the `exp()` function in R. This function takes *e* to some exponent that is given as the argument. So to obtain the approximation of *e* we use</span>
<span id="cb73-675"><a href="#cb73-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-678"><a href="#cb73-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-679"><a href="#cb73-679" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb73-680"><a href="#cb73-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-681"><a href="#cb73-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-682"><a href="#cb73-682" aria-hidden="true" tabindex="-1"></a>The base-*e* logarithm for a number, referred to as the *natural logarithm*, can be obtained using the `log()` function with the argument `base=exp(1)`. However, this base is so commonly used that it is the default value for the `base=` argument. So, if we use the `log()` function without defining the `base=` argument, it will automatically use base-*e*. For example, the natural logarithm of 10 can be computed as</span>
<span id="cb73-683"><a href="#cb73-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-686"><a href="#cb73-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-687"><a href="#cb73-687" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>)</span>
<span id="cb73-688"><a href="#cb73-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-689"><a href="#cb73-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-690"><a href="#cb73-690" aria-hidden="true" tabindex="-1"></a>If we took $e^{2.303}$ we would obtain 10. The natural logarithm even has its own mathematical notation; $\ln$. For example, we would mathematically express the natural logarithm of 10 as</span>
<span id="cb73-691"><a href="#cb73-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-692"><a href="#cb73-692" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-693"><a href="#cb73-693" aria-hidden="true" tabindex="-1"></a>\ln (10) = 2.303</span>
<span id="cb73-694"><a href="#cb73-694" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-695"><a href="#cb73-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-696"><a href="#cb73-696" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-697"><a href="#cb73-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-698"><a href="#cb73-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-699"><a href="#cb73-699" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting the Model Using Base-e Logarithms</span></span>
<span id="cb73-700"><a href="#cb73-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-701"><a href="#cb73-701" aria-hidden="true" tabindex="-1"></a>The fitted equation will be represented as:</span>
<span id="cb73-702"><a href="#cb73-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-703"><a href="#cb73-703" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-704"><a href="#cb73-704" aria-hidden="true" tabindex="-1"></a>\hat{Y}_i = e^{\hat\beta_0 + \hat\beta_1(X_i)}</span>
<span id="cb73-705"><a href="#cb73-705" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-706"><a href="#cb73-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-707"><a href="#cb73-707" aria-hidden="true" tabindex="-1"></a>Here we take the natural logarithm of both sides of the equation:</span>
<span id="cb73-708"><a href="#cb73-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-709"><a href="#cb73-709" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-710"><a href="#cb73-710" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-711"><a href="#cb73-711" aria-hidden="true" tabindex="-1"></a>\ln(\hat{Y}_i) &amp;= \ln\bigg(e^{\hat\beta_0 + \hat\beta_1(X_i)}\bigg) <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-712"><a href="#cb73-712" aria-hidden="true" tabindex="-1"></a>&amp;= \hat\beta_0 + \hat\beta_1(X_i)</span>
<span id="cb73-713"><a href="#cb73-713" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-714"><a href="#cb73-714" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-715"><a href="#cb73-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-716"><a href="#cb73-716" aria-hidden="true" tabindex="-1"></a>That is, we can regress the natural log-transformed values of *Y* onto *X*. To do this, we initially create a new column in the data that includes the natural logs of the carbon dioxide emission values. We can then use those as the outcome in our <span class="in">`lm()`</span>.</span>
<span id="cb73-717"><a href="#cb73-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-720"><a href="#cb73-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-721"><a href="#cb73-721" aria-hidden="true" tabindex="-1"></a><span class="co"># Create natural log-transformed CO2 values</span></span>
<span id="cb73-722"><a href="#cb73-722" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb73-723"><a href="#cb73-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-724"><a href="#cb73-724" aria-hidden="true" tabindex="-1"></a>    <span class="at">lnco2 =</span> <span class="fu">log</span>(co2)</span>
<span id="cb73-725"><a href="#cb73-725" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb73-726"><a href="#cb73-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-727"><a href="#cb73-727" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-728"><a href="#cb73-728" aria-hidden="true" tabindex="-1"></a>carbon</span>
<span id="cb73-729"><a href="#cb73-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-730"><a href="#cb73-730" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-731"><a href="#cb73-731" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(lnco2 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb73-732"><a href="#cb73-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-733"><a href="#cb73-733" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb73-734"><a href="#cb73-734" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.ln)</span>
<span id="cb73-735"><a href="#cb73-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-736"><a href="#cb73-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-737"><a href="#cb73-737" aria-hidden="true" tabindex="-1"></a>The model-level output is identical to the model-level output from the base-2 and base-10 model, which we expected. That is differences in wealth explains 83.8% of the variation in CO2 emissions.</span>
<span id="cb73-738"><a href="#cb73-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-741"><a href="#cb73-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-742"><a href="#cb73-742" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-743"><a href="#cb73-743" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.ln)</span>
<span id="cb73-744"><a href="#cb73-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-745"><a href="#cb73-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-746"><a href="#cb73-746" aria-hidden="true" tabindex="-1"></a>Because we changed the base, the coefficient estimates for the fitted equation have changed. Writing the new fitted equation:</span>
<span id="cb73-747"><a href="#cb73-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-748"><a href="#cb73-748" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-749"><a href="#cb73-749" aria-hidden="true" tabindex="-1"></a>\ln(\widehat{\mathrm{CO2}_i}) = -2.20 + 0.824(\mathrm{Wealth}_i)</span>
<span id="cb73-750"><a href="#cb73-750" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-751"><a href="#cb73-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-752"><a href="#cb73-752" aria-hidden="true" tabindex="-1"></a>Or, back-transforming the left-hand side:</span>
<span id="cb73-753"><a href="#cb73-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-754"><a href="#cb73-754" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-755"><a href="#cb73-755" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = e^{2.20} \times e^{0.824(\mathrm{Wealth}_i)}</span>
<span id="cb73-756"><a href="#cb73-756" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-757"><a href="#cb73-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-758"><a href="#cb73-758" aria-hidden="true" tabindex="-1"></a>To interpret these, we exponentiate the coefficients using base-e.</span>
<span id="cb73-759"><a href="#cb73-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-762"><a href="#cb73-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-763"><a href="#cb73-763" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponentiate using base-e</span></span>
<span id="cb73-764"><a href="#cb73-764" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(lm.ln))</span>
<span id="cb73-765"><a href="#cb73-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-766"><a href="#cb73-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-767"><a href="#cb73-767" aria-hidden="true" tabindex="-1"></a>We get the exact same back-transformed coefficients as we did when we back-transformed the base-2 coefficients. Again, this is expected. Based on these, the interpretations are:</span>
<span id="cb73-768"><a href="#cb73-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-769"><a href="#cb73-769" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Intercept:** The predicted CO2 emissions for a countries that have a wealth level of 0 is 0.111 metric tons per person, on average (extrapolation).</span>
<span id="cb73-770"><a href="#cb73-770" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Rate-of-Change:** Each one-unit difference in wealth level is associated with a 2.28-fold difference in carbon emissions, on average. OR using the language of percent change, each one-unit difference in wealth level is associated with a 128% increase in carbon emissions, on average.</span>
<span id="cb73-771"><a href="#cb73-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-772"><a href="#cb73-772" aria-hidden="true" tabindex="-1"></a>Lastly, we can plot the fitted curve.</span>
<span id="cb73-773"><a href="#cb73-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-774"><a href="#cb73-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-777"><a href="#cb73-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-778"><a href="#cb73-778" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-e-fitted</span></span>
<span id="cb73-779"><a href="#cb73-779" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-780"><a href="#cb73-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted CO2 emisssions as a function of wealth."</span></span>
<span id="cb73-781"><a href="#cb73-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-782"><a href="#cb73-782" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-783"><a href="#cb73-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-784"><a href="#cb73-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.20</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.824</span><span class="sc">*</span>x)} ) <span class="sc">+</span></span>
<span id="cb73-785"><a href="#cb73-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-786"><a href="#cb73-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-787"><a href="#cb73-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 emissions (in metric tones per person)"</span>)</span>
<span id="cb73-788"><a href="#cb73-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-789"><a href="#cb73-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-790"><a href="#cb73-790" aria-hidden="true" tabindex="-1"></a>This is the exact same fitted curve we obtained from the base-2 and base-10 models. Once again, this is completely expected.</span>
<span id="cb73-791"><a href="#cb73-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-792"><a href="#cb73-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-793"><a href="#cb73-793" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is Special About Base-e</span></span>
<span id="cb73-794"><a href="#cb73-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-795"><a href="#cb73-795" aria-hidden="true" tabindex="-1"></a>Other than being a cool number, why do Social Scientists like using base-e? It turns out that if the slope estimate is small (e.g., $\hat\beta_k &lt; 0.20$), we can directly take the slope value from the <span class="in">`coef()`</span> output, multiply it by 100, and interpret it as the percent change. That is because for small values of the slope,</span>
<span id="cb73-796"><a href="#cb73-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-797"><a href="#cb73-797" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-798"><a href="#cb73-798" aria-hidden="true" tabindex="-1"></a>(e^{\hat{\beta_1}} -1) \approx \hat{\beta_1}</span>
<span id="cb73-799"><a href="#cb73-799" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-800"><a href="#cb73-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-801"><a href="#cb73-801" aria-hidden="true" tabindex="-1"></a>In our example, the slope is not less than 0.20, so we have to do the math, $(e^{0.824}-1)\times 100=128$, to compute the percent change.</span>
<span id="cb73-802"><a href="#cb73-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-803"><a href="#cb73-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-804"><a href="#cb73-804" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modeling the Remaining Non-Linearity</span></span>
<span id="cb73-805"><a href="#cb73-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-806"><a href="#cb73-806" aria-hidden="true" tabindex="-1"></a>Remember that the residual plots suggested that the problem of heterogeneity in the residuals was "fixed" by using the log-transformed outcome, but it did not completely fix the non-linearity. We can also  see this by plotting the log-transformed CO2 emisssions versus wealth.</span>
<span id="cb73-807"><a href="#cb73-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-810"><a href="#cb73-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-811"><a href="#cb73-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatterplot-log-take2</span></span>
<span id="cb73-812"><a href="#cb73-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot between wealth and log-transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot."</span></span>
<span id="cb73-813"><a href="#cb73-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Scatterplot between wealth and log-transformed CO2 emissions. The loess smoother (blue, dashed line) is also displayed. The two countries with extreme carbon emissions are also identified on this plot."</span></span>
<span id="cb73-814"><a href="#cb73-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb73-815"><a href="#cb73-815" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb73-816"><a href="#cb73-816" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> <span class="fu">log</span>(co2))) <span class="sc">+</span></span>
<span id="cb73-817"><a href="#cb73-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-818"><a href="#cb73-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb73-819"><a href="#cb73-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-820"><a href="#cb73-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-821"><a href="#cb73-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"ln(Carbon emissions)"</span>) <span class="sc">+</span></span>
<span id="cb73-822"><a href="#cb73-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="fl">3.64</span>, <span class="at">label =</span> <span class="st">"Quatar"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb73-823"><a href="#cb73-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">4.6</span>, <span class="at">y =</span> <span class="fl">3.44</span>, <span class="at">label =</span> <span class="st">"Trinidad and Tobago"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb73-824"><a href="#cb73-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-825"><a href="#cb73-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-826"><a href="#cb73-826" aria-hidden="true" tabindex="-1"></a>How do we model the non-linearity we observe in the relationship even after we log-transformed the outcome? The pattern shown by the loess smoother in the plot, suggests a curvilinear pattern similar to what we observed in the college data in previous sets of notes. This means we can try to model the non-linearity by including a polynomial effect of wealth in the model. </span>
<span id="cb73-827"><a href="#cb73-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-828"><a href="#cb73-828" aria-hidden="true" tabindex="-1"></a>To see if this improves our assumptions we will fit the polynomial model and examine the residuals. Here we fit the model by creating the natural logarithm of the CO2 values directly in the <span class="in">`lm()`</span>. (If we do that, we don't have to create a new column of log-transfomed values in the data!)</span>
<span id="cb73-829"><a href="#cb73-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-832"><a href="#cb73-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-833"><a href="#cb73-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-residuals-log-quad</span></span>
<span id="cb73-834"><a href="#cb73-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Density plots of the standardized residuals and scatterplot of the standardized residuals versus the fitted values for the model using the linear and quadratic effects of wealth to predict variation in log-transfomed carbon emissions. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area) in the scatterplot. The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-835"><a href="#cb73-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Density plots of the standardized residuals and scatterplot of the standardized residuals versus the fitted values for the model using the linear and quadratic effects of wealth to predict variation in log-transfomed carbon emissions. The reference line of Y=0 is also displayed along with the 95% confidence envelope (grey shaded area) in the scatterplot. The loess smoother (solid, blue line) shows the empirical relationship betwen the residuals and fitted values."</span></span>
<span id="cb73-836"><a href="#cb73-836" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb73-837"><a href="#cb73-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb73-838"><a href="#cb73-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "80%"</span></span>
<span id="cb73-839"><a href="#cb73-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-840"><a href="#cb73-840" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit polynomial model</span></span>
<span id="cb73-841"><a href="#cb73-841" aria-hidden="true" tabindex="-1"></a>lm.poly <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb73-842"><a href="#cb73-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-843"><a href="#cb73-843" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots</span></span>
<span id="cb73-844"><a href="#cb73-844" aria-hidden="true" tabindex="-1"></a><span class="fu">residual_plots</span>(lm.poly)</span>
<span id="cb73-845"><a href="#cb73-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-846"><a href="#cb73-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-847"><a href="#cb73-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-848"><a href="#cb73-848" aria-hidden="true" tabindex="-1"></a>Based on the residual plots, the polynomial model shows good fit to all the assumptions. Although this is reason enough to adopt the model that includes the quadratic term, we can also evaluate this by computing and comparing the AICc (and associated information theoretic metrics) for this model and the model that only includes the linear effect of wealth.</span>
<span id="cb73-849"><a href="#cb73-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-850"><a href="#cb73-850" aria-hidden="true" tabindex="-1"></a>Because the <span class="in">`aictab()`</span> function requires us to use the exact same outcome (computed in exactly the same way), we will refit the linear and quadratic models by computing the natural log of CO2 emissions directly in the <span class="in">`lm()`</span>.</span>
<span id="cb73-851"><a href="#cb73-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-852"><a href="#cb73-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-855"><a href="#cb73-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-856"><a href="#cb73-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb73-857"><a href="#cb73-857" aria-hidden="true" tabindex="-1"></a>lm.ln <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth, <span class="at">data =</span> carbon)</span>
<span id="cb73-858"><a href="#cb73-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-859"><a href="#cb73-859" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit polynomial model</span></span>
<span id="cb73-860"><a href="#cb73-860" aria-hidden="true" tabindex="-1"></a>lm.poly <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> carbon)</span>
<span id="cb73-861"><a href="#cb73-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-862"><a href="#cb73-862" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb73-863"><a href="#cb73-863" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb73-864"><a href="#cb73-864" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.ln, lm.poly),</span>
<span id="cb73-865"><a href="#cb73-865" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Linear effect"</span>, <span class="st">"Quadratic effect"</span>)</span>
<span id="cb73-866"><a href="#cb73-866" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-867"><a href="#cb73-867" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-868"><a href="#cb73-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-869"><a href="#cb73-869" aria-hidden="true" tabindex="-1"></a>The empirical evidence supports adopting the polynomial model that includes both the quadratic and linear effects of wealth.</span>
<span id="cb73-870"><a href="#cb73-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-873"><a href="#cb73-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-874"><a href="#cb73-874" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm.poly)</span>
<span id="cb73-875"><a href="#cb73-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-876"><a href="#cb73-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-877"><a href="#cb73-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-878"><a href="#cb73-878" aria-hidden="true" tabindex="-1"></a>Examining the model-level summary information from the quadratic polynomial model, we find that the model explains 86.3% of the variation in CO2 emisssions.</span>
<span id="cb73-879"><a href="#cb73-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-882"><a href="#cb73-882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-883"><a href="#cb73-883" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-884"><a href="#cb73-884" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.poly)</span>
<span id="cb73-885"><a href="#cb73-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-886"><a href="#cb73-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-887"><a href="#cb73-887" aria-hidden="true" tabindex="-1"></a>From the coefficient-level output, the fitted equation is:</span>
<span id="cb73-888"><a href="#cb73-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-889"><a href="#cb73-889" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-890"><a href="#cb73-890" aria-hidden="true" tabindex="-1"></a>\ln\left(\widehat{\mathrm{CO2}_i}\right) = -2.90 + 1.38(\mathrm{Wealth}_i) - 0.0837(\mathrm{Wealth}_i^2)</span>
<span id="cb73-891"><a href="#cb73-891" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-892"><a href="#cb73-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-893"><a href="#cb73-893" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-894"><a href="#cb73-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-895"><a href="#cb73-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-896"><a href="#cb73-896" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting the Effect of Wealth</span></span>
<span id="cb73-897"><a href="#cb73-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-898"><a href="#cb73-898" aria-hidden="true" tabindex="-1"></a>Since the quadratic term is an interaction term, we interpret the effect of wealth generally as:</span>
<span id="cb73-899"><a href="#cb73-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-900"><a href="#cb73-900" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-901"><a href="#cb73-901" aria-hidden="true" tabindex="-1"></a>**INTERPRETATION**</span>
<span id="cb73-902"><a href="#cb73-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-903"><a href="#cb73-903" aria-hidden="true" tabindex="-1"></a>The effect of wealth on carbon dioxide emissions depends on the level of wealth.</span>
<span id="cb73-904"><a href="#cb73-904" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-905"><a href="#cb73-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-906"><a href="#cb73-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-907"><a href="#cb73-907" aria-hidden="true" tabindex="-1"></a>To better understand the nature of this relationship we plot the fitted curve. To do so, we first back-transform the metric of log-carbon emission to the metric of raw carbon emissions. Remember, this creates a multiplicative relationship among the exponentiated coefficients. Exponentiating both sides of the fitted equation:</span>
<span id="cb73-908"><a href="#cb73-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-909"><a href="#cb73-909" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-910"><a href="#cb73-910" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = e^{-2.90} \times e^{1.38(\mathrm{Wealth}_i)} \times e^{-0.0837(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-911"><a href="#cb73-911" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-912"><a href="#cb73-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-913"><a href="#cb73-913" aria-hidden="true" tabindex="-1"></a>Plotting this function will allow us to understand the relationship between wealth and carbon emissions from the polynomial model. Inputting this into the <span class="in">`geom_function()`</span> layer of our <span class="in">`ggplot()`</span> syntax, we get:</span>
<span id="cb73-914"><a href="#cb73-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-915"><a href="#cb73-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-918"><a href="#cb73-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-919"><a href="#cb73-919" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-poly-fitted</span></span>
<span id="cb73-920"><a href="#cb73-920" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model."</span></span>
<span id="cb73-921"><a href="#cb73-921" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model."</span></span>
<span id="cb73-922"><a href="#cb73-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb73-923"><a href="#cb73-923" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-924"><a href="#cb73-924" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-925"><a href="#cb73-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-926"><a href="#cb73-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">2.90</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.38</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.0837</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)} ) <span class="sc">+</span></span>
<span id="cb73-927"><a href="#cb73-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-928"><a href="#cb73-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-929"><a href="#cb73-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>)</span>
<span id="cb73-930"><a href="#cb73-930" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-931"><a href="#cb73-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-932"><a href="#cb73-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-933"><a href="#cb73-933" aria-hidden="true" tabindex="-1"></a>:::FYI</span>
<span id="cb73-934"><a href="#cb73-934" aria-hidden="true" tabindex="-1"></a>**Answering the First Research Question**</span>
<span id="cb73-935"><a href="#cb73-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-936"><a href="#cb73-936" aria-hidden="true" tabindex="-1"></a>The relationship between wealth and carbon emisssions is complicated. It combines the positive exponential growth we saw earlier with the change in curvature of the negative quadratic effect. In general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels.</span>
<span id="cb73-937"><a href="#cb73-937" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-938"><a href="#cb73-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-939"><a href="#cb73-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-940"><a href="#cb73-940" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-941"><a href="#cb73-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-942"><a href="#cb73-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-943"><a href="#cb73-943" aria-hidden="true" tabindex="-1"></a><span class="fu">## RQ 2: Does the quadratic effect of wealth persist after controlling for urbanization?</span></span>
<span id="cb73-944"><a href="#cb73-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-945"><a href="#cb73-945" aria-hidden="true" tabindex="-1"></a>To answer the second research we will include urbanization in the model as a covariate. That is, we will fit the model:</span>
<span id="cb73-946"><a href="#cb73-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-947"><a href="#cb73-947" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-948"><a href="#cb73-948" aria-hidden="true" tabindex="-1"></a>\ln\left(\mathrm{CO2}_i\right) = \beta_0 + \beta_1(\mathrm{Wealth}_i) + \beta_2(\mathrm{Wealth}_i^2) + \beta_3(\mathrm{Urbanization_i}) + \epsilon_i</span>
<span id="cb73-949"><a href="#cb73-949" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-950"><a href="#cb73-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-951"><a href="#cb73-951" aria-hidden="true" tabindex="-1"></a>where $\epsilon_i\overset{\mathrm{i.i.d.}}{\sim}\mathcal{N}(0,\sigma^2_{\epsilon})$.</span>
<span id="cb73-952"><a href="#cb73-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-955"><a href="#cb73-955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-956"><a href="#cb73-956" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-957"><a href="#cb73-957" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.3</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization, <span class="at">data =</span> carbon)</span>
<span id="cb73-958"><a href="#cb73-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-959"><a href="#cb73-959" aria-hidden="true" tabindex="-1"></a><span class="co"># Model-level output</span></span>
<span id="cb73-960"><a href="#cb73-960" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm<span class="fl">.3</span>)</span>
<span id="cb73-961"><a href="#cb73-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-962"><a href="#cb73-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-963"><a href="#cb73-963" aria-hidden="true" tabindex="-1"></a>This model explains 86.1% of the variation in carbon emissions. We also look at the model evidence.</span>
<span id="cb73-964"><a href="#cb73-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-967"><a href="#cb73-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-968"><a href="#cb73-968" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of model evidence</span></span>
<span id="cb73-969"><a href="#cb73-969" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb73-970"><a href="#cb73-970" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm.ln, lm.poly, lm<span class="fl">.3</span>),</span>
<span id="cb73-971"><a href="#cb73-971" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"Wealth"</span>, <span class="st">"Wealth, Wealth^2"</span>, <span class="st">"Wealth, Wealth^2, Urbanization"</span>)</span>
<span id="cb73-972"><a href="#cb73-972" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-973"><a href="#cb73-973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-974"><a href="#cb73-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-975"><a href="#cb73-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-976"><a href="#cb73-976" aria-hidden="true" tabindex="-1"></a>The model that included urbanization has more empirical evidence than the model that doesn't, but the $\Delta$AICc values and model probabilities suggest that both models are reasonable candidates.</span>
<span id="cb73-977"><a href="#cb73-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-978"><a href="#cb73-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-981"><a href="#cb73-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-982"><a href="#cb73-982" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-983"><a href="#cb73-983" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm<span class="fl">.3</span>)</span>
<span id="cb73-984"><a href="#cb73-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-985"><a href="#cb73-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-986"><a href="#cb73-986" aria-hidden="true" tabindex="-1"></a>From the coefficient-level output, the fitted equation is:</span>
<span id="cb73-987"><a href="#cb73-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-988"><a href="#cb73-988" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-989"><a href="#cb73-989" aria-hidden="true" tabindex="-1"></a>\ln\left(\widehat{\mathrm{CO2}_i}\right) = -2.74 + 1.34(\mathrm{Wealth}_i) -0.08(\mathrm{Wealth}_i^2) - 0.03(\mathrm{Urbanization}_i)</span>
<span id="cb73-990"><a href="#cb73-990" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-991"><a href="#cb73-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-992"><a href="#cb73-992" aria-hidden="true" tabindex="-1"></a>Interpreting these in the log-metric:</span>
<span id="cb73-993"><a href="#cb73-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-994"><a href="#cb73-994" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The intercept, $\hat{\beta_0} = -2.74$, is the average predicted natural log of CO2 emissions for countries with a wealth level of 0 and an urbanization of 0 (extrapolation).</span>
<span id="cb73-995"><a href="#cb73-995" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The linear slope of wealth would not be interpreted because it is part of an interaction term.</span>
<span id="cb73-996"><a href="#cb73-996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The effect of wealth on carbon emissions depends on the level of wealth, after controlling for differences in urbanization.</span>
<span id="cb73-997"><a href="#cb73-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The urbanization effect indicates that each one-point difference in the urbanization measure is associated with lower natural log values of CO2 emissions by $0.03$, on average, after controlling for differences in wealth.</span>
<span id="cb73-998"><a href="#cb73-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-999"><a href="#cb73-999" aria-hidden="true" tabindex="-1"></a>Back-transforming the fitted equation, we get:</span>
<span id="cb73-1000"><a href="#cb73-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1001"><a href="#cb73-1001" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1002"><a href="#cb73-1002" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} = e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(\mathrm{Urbanization}_i)}</span>
<span id="cb73-1003"><a href="#cb73-1003" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1004"><a href="#cb73-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1005"><a href="#cb73-1005" aria-hidden="true" tabindex="-1"></a>If we exponentiate the coefficients:</span>
<span id="cb73-1006"><a href="#cb73-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1009"><a href="#cb73-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1010"><a href="#cb73-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(lm<span class="fl">.3</span>))</span>
<span id="cb73-1011"><a href="#cb73-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1012"><a href="#cb73-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1013"><a href="#cb73-1013" aria-hidden="true" tabindex="-1"></a>Interpreting these :</span>
<span id="cb73-1014"><a href="#cb73-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1015"><a href="#cb73-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The average predicted CO2 emissions for countries with a wealth level of 0 and an urbanization of 0 is .064 tonnes (extrapolation).</span>
<span id="cb73-1016"><a href="#cb73-1016" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The linear slope of wealth would not be interpreted because it is part of an interaction term.</span>
<span id="cb73-1017"><a href="#cb73-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The effect of wealth on carbon emissions depends on the level of wealth, after controlling for differences in urbanization.</span>
<span id="cb73-1018"><a href="#cb73-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each one-point difference in the urbanization measure is associated with a 0.96-fold change in CO2 emissions, on average, after controlling for differences in wealth. OR Each one-point difference in the urbanization measure is associated with a 3.25% decrease in CO2 emissions, on average, after controlling for differences in wealth.</span>
<span id="cb73-1019"><a href="#cb73-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1020"><a href="#cb73-1020" aria-hidden="true" tabindex="-1"></a>Plotting this function will allow us to understand the relationship between wealth, urbanization, and carbon emissions from the polynomial model. Here I choose a low level of urbanization (0.8) and a high level of urbanization (6.2) based on the data. We substitute these into the fitted equation to get an equation expressing carbon dioxide emissions as a function of wealth which we will then input into a <span class="in">`geom_function()`</span> layer of our <span class="in">`ggplot()`</span> syntax.</span>
<span id="cb73-1021"><a href="#cb73-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1022"><a href="#cb73-1022" aria-hidden="true" tabindex="-1"></a>**Low Urbanization**</span>
<span id="cb73-1023"><a href="#cb73-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1024"><a href="#cb73-1024" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1025"><a href="#cb73-1025" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1026"><a href="#cb73-1026" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(0.8)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1027"><a href="#cb73-1027" aria-hidden="true" tabindex="-1"></a>&amp;= .065 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times .976 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1028"><a href="#cb73-1028" aria-hidden="true" tabindex="-1"></a>&amp;= .0634 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1029"><a href="#cb73-1029" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1030"><a href="#cb73-1030" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1031"><a href="#cb73-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1032"><a href="#cb73-1032" aria-hidden="true" tabindex="-1"></a>**High Urbanization**</span>
<span id="cb73-1033"><a href="#cb73-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1034"><a href="#cb73-1034" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1035"><a href="#cb73-1035" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1036"><a href="#cb73-1036" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.74} \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times e^{- 0.03(6.2)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1037"><a href="#cb73-1037" aria-hidden="true" tabindex="-1"></a>&amp;= .065 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)} \times .830 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1038"><a href="#cb73-1038" aria-hidden="true" tabindex="-1"></a>&amp;= .054 \times e^{1.34(\mathrm{Wealth}_i)} \times e^{-0.08(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1039"><a href="#cb73-1039" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1040"><a href="#cb73-1040" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1041"><a href="#cb73-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1042"><a href="#cb73-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1043"><a href="#cb73-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1046"><a href="#cb73-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1047"><a href="#cb73-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rq2</span></span>
<span id="cb73-1048"><a href="#cb73-1048" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries with low (light blue) and high (dark blue) urbanization."</span></span>
<span id="cb73-1049"><a href="#cb73-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries with low (light blue) and high (dark blue) urbanization."</span></span>
<span id="cb73-1050"><a href="#cb73-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb73-1051"><a href="#cb73-1051" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-1052"><a href="#cb73-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-1053"><a href="#cb73-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-1054"><a href="#cb73-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">0634</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.34</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.08</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#56b4e9"</span>) <span class="sc">+</span></span>
<span id="cb73-1055"><a href="#cb73-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">054</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.34</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.08</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#0072b2"</span>) <span class="sc">+</span></span>
<span id="cb73-1056"><a href="#cb73-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-1057"><a href="#cb73-1057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-1058"><a href="#cb73-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>)</span>
<span id="cb73-1059"><a href="#cb73-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1060"><a href="#cb73-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1061"><a href="#cb73-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1062"><a href="#cb73-1062" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-1063"><a href="#cb73-1063" aria-hidden="true" tabindex="-1"></a>**Answering the Second Research Question**</span>
<span id="cb73-1064"><a href="#cb73-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1065"><a href="#cb73-1065" aria-hidden="true" tabindex="-1"></a>Here we see that in general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels. This pattern is similar for countries with both low and high urbanization, although the countries with higher urbanization have lower carbon dioxide emissions.</span>
<span id="cb73-1066"><a href="#cb73-1066" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-1067"><a href="#cb73-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1068"><a href="#cb73-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1069"><a href="#cb73-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1070"><a href="#cb73-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">## RQ 3: Does the Effect of Wealth Vary Between World Regions?</span></span>
<span id="cb73-1071"><a href="#cb73-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1072"><a href="#cb73-1072" aria-hidden="true" tabindex="-1"></a>To answer the third research question, we will include world region and urbanization into the model along with our linear and quadratic effects of wealth. To determine if the effects of wealth are different across the different regions we have to include interaction effects between wealth and world region. Since our model includes a quadratic effect of wealth we need to include both:</span>
<span id="cb73-1073"><a href="#cb73-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1074"><a href="#cb73-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Wealth} \times \mathrm{World~Region}$, and</span>
<span id="cb73-1075"><a href="#cb73-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathrm{Wealth}^2 \times \mathrm{World~Region}$</span>
<span id="cb73-1076"><a href="#cb73-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1077"><a href="#cb73-1077" aria-hidden="true" tabindex="-1"></a>Since world region is categorical, we will need to create a set of dummy variables to represent it in the models.</span>
<span id="cb73-1078"><a href="#cb73-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1081"><a href="#cb73-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1082"><a href="#cb73-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dummy variables for world region</span></span>
<span id="cb73-1083"><a href="#cb73-1083" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">=</span> carbon <span class="sc">|&gt;</span></span>
<span id="cb73-1084"><a href="#cb73-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb73-1085"><a href="#cb73-1085" aria-hidden="true" tabindex="-1"></a>    <span class="at">africa =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Africa"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb73-1086"><a href="#cb73-1086" aria-hidden="true" tabindex="-1"></a>    <span class="at">asia =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Asia"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb73-1087"><a href="#cb73-1087" aria-hidden="true" tabindex="-1"></a>    <span class="at">americas =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Americas"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb73-1088"><a href="#cb73-1088" aria-hidden="true" tabindex="-1"></a>    <span class="at">europe =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Europe"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb73-1089"><a href="#cb73-1089" aria-hidden="true" tabindex="-1"></a>    <span class="at">oceania =</span> <span class="fu">if_else</span>(region <span class="sc">==</span> <span class="st">"Oceania"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb73-1090"><a href="#cb73-1090" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-1091"><a href="#cb73-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1092"><a href="#cb73-1092" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb73-1093"><a href="#cb73-1093" aria-hidden="true" tabindex="-1"></a>carbon</span>
<span id="cb73-1094"><a href="#cb73-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1095"><a href="#cb73-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1096"><a href="#cb73-1096" aria-hidden="true" tabindex="-1"></a>We will start by fitting a model that includes the main-effect of world region in addition to our effects of wealth and urbanization. As always, when we have multiple dummy variables representing a predictor, we include all but one of the dummies in the model. Here we will omit Oceania (our reference group).</span>
<span id="cb73-1097"><a href="#cb73-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1100"><a href="#cb73-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1101"><a href="#cb73-1101" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-1102"><a href="#cb73-1102" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.4</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization <span class="sc">+</span> asia <span class="sc">+</span> africa <span class="sc">+</span> americas <span class="sc">+</span> europe, <span class="at">data =</span> carbon)</span>
<span id="cb73-1103"><a href="#cb73-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1104"><a href="#cb73-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1105"><a href="#cb73-1105" aria-hidden="true" tabindex="-1"></a>We also want to include our interactions between world region and wealth. To do this we have to include multiple interaction terms because we have multiple dummy variables. For example, here is the model that includes interactions between region and the lineqar effect of wealth and region and the quadratic effects of wealth where, once again, Oceania is our references group.</span>
<span id="cb73-1106"><a href="#cb73-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1107"><a href="#cb73-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1110"><a href="#cb73-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1111"><a href="#cb73-1111" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-1112"><a href="#cb73-1112" aria-hidden="true" tabindex="-1"></a>lm<span class="fl">.5</span> <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(co2) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wealth <span class="sc">+</span> <span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> urbanization <span class="sc">+</span></span>
<span id="cb73-1113"><a href="#cb73-1113" aria-hidden="true" tabindex="-1"></a>            asia <span class="sc">+</span> africa <span class="sc">+</span> americas <span class="sc">+</span> europe <span class="sc">+</span></span>
<span id="cb73-1114"><a href="#cb73-1114" aria-hidden="true" tabindex="-1"></a>            asia<span class="sc">:</span>wealth <span class="sc">+</span> africa<span class="sc">:</span>wealth <span class="sc">+</span> americas<span class="sc">:</span>wealth <span class="sc">+</span> europe<span class="sc">:</span>wealth <span class="sc">+</span></span>
<span id="cb73-1115"><a href="#cb73-1115" aria-hidden="true" tabindex="-1"></a>            asia<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> africa<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> americas<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> europe<span class="sc">:</span><span class="fu">I</span>(wealth<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb73-1116"><a href="#cb73-1116" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> carbon)</span>
<span id="cb73-1117"><a href="#cb73-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1118"><a href="#cb73-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1119"><a href="#cb73-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1120"><a href="#cb73-1120" aria-hidden="true" tabindex="-1"></a>Evaluating these models:</span>
<span id="cb73-1121"><a href="#cb73-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1124"><a href="#cb73-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1125"><a href="#cb73-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(</span>
<span id="cb73-1126"><a href="#cb73-1126" aria-hidden="true" tabindex="-1"></a>  <span class="at">cand.set =</span> <span class="fu">list</span>(lm<span class="fl">.3</span>, lm<span class="fl">.4</span>, lm<span class="fl">.5</span>),</span>
<span id="cb73-1127"><a href="#cb73-1127" aria-hidden="true" tabindex="-1"></a>  <span class="at">modnames =</span> <span class="fu">c</span>(<span class="st">"No world region"</span>, <span class="st">"Main effect of region"</span>, <span class="st">"Interaction between region and wealth"</span>)</span>
<span id="cb73-1128"><a href="#cb73-1128" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-1129"><a href="#cb73-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1130"><a href="#cb73-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1131"><a href="#cb73-1131" aria-hidden="true" tabindex="-1"></a>Here, the empirical evidence favors the model that includes the main effect of world region indicating that there is not evidence of an interaction between world region and wealth. Below we look at the coefficients and write the fitted equation.</span>
<span id="cb73-1132"><a href="#cb73-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1135"><a href="#cb73-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1136"><a href="#cb73-1136" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients</span></span>
<span id="cb73-1137"><a href="#cb73-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm<span class="fl">.4</span>)</span>
<span id="cb73-1138"><a href="#cb73-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1139"><a href="#cb73-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1140"><a href="#cb73-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1141"><a href="#cb73-1141" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1142"><a href="#cb73-1142" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1143"><a href="#cb73-1143" aria-hidden="true" tabindex="-1"></a>\ln\left(\widehat{\mathrm{CO2}_i}\right) = &amp;-2.14 + 1.28(\mathrm{Wealth}_i) -0.07(\mathrm{Wealth}_i^2) - 0.10(\mathrm{Urbanization}_i) <span class="sc">\\</span></span>
<span id="cb73-1144"><a href="#cb73-1144" aria-hidden="true" tabindex="-1"></a>&amp;-0.16(\mathrm{Asia}_i) - .36(\mathrm{Africa}_i) - .59(\mathrm{Americas}_i) - 0.71(\mathrm{Europe}_i)</span>
<span id="cb73-1145"><a href="#cb73-1145" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1146"><a href="#cb73-1146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1147"><a href="#cb73-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1148"><a href="#cb73-1148" aria-hidden="true" tabindex="-1"></a>Recall that the coefficients associated with the different regions are comparisons to the reference group. For example, the Asia coefficient indicates that Asia has lower log-CO2 emissions than Oceania by 0.16, on average, controlling for differences in wealth and urbanization. We can also back transform this and interpret it as percent change:</span>
<span id="cb73-1149"><a href="#cb73-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1150"><a href="#cb73-1150" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1151"><a href="#cb73-1151" aria-hidden="true" tabindex="-1"></a>e^{-.16} - 1 = -.147</span>
<span id="cb73-1152"><a href="#cb73-1152" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1153"><a href="#cb73-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1154"><a href="#cb73-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1155"><a href="#cb73-1155" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Asia's carbon emissions are 14.7% lower than Oceania's carbon emissions, on average, controlling for differences in wealth and urbanization.</span></span>
<span id="cb73-1156"><a href="#cb73-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1157"><a href="#cb73-1157" aria-hidden="true" tabindex="-1"></a>In this analysis, we are most interested in the effect of wealth on CO2 emissions. So I will again create a plot of this model's results. After creating this plot we can describe any regional differences, but we will not make inferences about regional differences. To create this plot I will set urbanization to its mean level (2.00) and then produce a fitted equation for each world region. I will do this with the back-transformed outcome.</span>
<span id="cb73-1158"><a href="#cb73-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1159"><a href="#cb73-1159" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-1160"><a href="#cb73-1160" aria-hidden="true" tabindex="-1"></a>**PROTIP**</span>
<span id="cb73-1161"><a href="#cb73-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1162"><a href="#cb73-1162" aria-hidden="true" tabindex="-1"></a>If the goal of the analysis was to compare different regions, you would have to fit other models to make the different comparisons. If we were using *p*-values for variable selection, you would also have to adjust based on the total number of pairwise (region-to-region) comparisons using something like the Boferroni or Benjamini-Hochberg adjustments. However, it is less clear how to view multiple comparisons when using information criteria. @Dayton:1998 laid out a framework for using measures such as AIC for the multiple comparisons problem.</span>
<span id="cb73-1163"><a href="#cb73-1163" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-1164"><a href="#cb73-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1165"><a href="#cb73-1165" aria-hidden="true" tabindex="-1"></a>**Asia**</span>
<span id="cb73-1166"><a href="#cb73-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1167"><a href="#cb73-1167" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1168"><a href="#cb73-1168" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1169"><a href="#cb73-1169" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)} \times e^{-.16(1)} \times e^{-.36(0)} \times e^{-.59(0)} \times e^{-.71(0)}<span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1170"><a href="#cb73-1170" aria-hidden="true" tabindex="-1"></a>&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .852  \times 1 \times 1 \times 1<span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1171"><a href="#cb73-1171" aria-hidden="true" tabindex="-1"></a>&amp;= .082 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1172"><a href="#cb73-1172" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1173"><a href="#cb73-1173" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1174"><a href="#cb73-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1175"><a href="#cb73-1175" aria-hidden="true" tabindex="-1"></a>From this we note that the effects of the regions that were not Asia became 1 and dropped out of the model. We can use this in our other world regions to shorten the fitted equation.</span>
<span id="cb73-1176"><a href="#cb73-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1177"><a href="#cb73-1177" aria-hidden="true" tabindex="-1"></a>**Africa**</span>
<span id="cb73-1178"><a href="#cb73-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1179"><a href="#cb73-1179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1180"><a href="#cb73-1180" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1181"><a href="#cb73-1181" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.36(1)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1182"><a href="#cb73-1182" aria-hidden="true" tabindex="-1"></a>&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .698 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1183"><a href="#cb73-1183" aria-hidden="true" tabindex="-1"></a>&amp;= .067 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1184"><a href="#cb73-1184" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1185"><a href="#cb73-1185" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1186"><a href="#cb73-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1187"><a href="#cb73-1187" aria-hidden="true" tabindex="-1"></a>**Americas**</span>
<span id="cb73-1188"><a href="#cb73-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1189"><a href="#cb73-1189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1190"><a href="#cb73-1190" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1191"><a href="#cb73-1191" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.59(1)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1192"><a href="#cb73-1192" aria-hidden="true" tabindex="-1"></a>&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .54 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1193"><a href="#cb73-1193" aria-hidden="true" tabindex="-1"></a>&amp;= .053 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1194"><a href="#cb73-1194" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1195"><a href="#cb73-1195" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1196"><a href="#cb73-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1197"><a href="#cb73-1197" aria-hidden="true" tabindex="-1"></a>**Europe**</span>
<span id="cb73-1198"><a href="#cb73-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1199"><a href="#cb73-1199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1200"><a href="#cb73-1200" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1201"><a href="#cb73-1201" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)}  \times e^{-.71(1)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1202"><a href="#cb73-1202" aria-hidden="true" tabindex="-1"></a>&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 \times .491 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1203"><a href="#cb73-1203" aria-hidden="true" tabindex="-1"></a>&amp;= .047 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1204"><a href="#cb73-1204" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1205"><a href="#cb73-1205" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1206"><a href="#cb73-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1207"><a href="#cb73-1207" aria-hidden="true" tabindex="-1"></a>**Oceania**</span>
<span id="cb73-1208"><a href="#cb73-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1209"><a href="#cb73-1209" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1210"><a href="#cb73-1210" aria-hidden="true" tabindex="-1"></a>\begin{split}</span>
<span id="cb73-1211"><a href="#cb73-1211" aria-hidden="true" tabindex="-1"></a>\widehat{\mathrm{CO2}_i} &amp;= e^{-2.14} \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times e^{-.10(2.00)} <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1212"><a href="#cb73-1212" aria-hidden="true" tabindex="-1"></a>&amp;= .117 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)} \times .819 <span class="sc">\\</span><span class="co">[</span><span class="ot">2ex</span><span class="co">]</span></span>
<span id="cb73-1213"><a href="#cb73-1213" aria-hidden="true" tabindex="-1"></a>&amp;= .096 \times e^{1.28(\mathrm{Wealth}_i)} \times e^{-.07(\mathrm{Wealth}_i^2)}</span>
<span id="cb73-1214"><a href="#cb73-1214" aria-hidden="true" tabindex="-1"></a>\end{split}</span>
<span id="cb73-1215"><a href="#cb73-1215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb73-1216"><a href="#cb73-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1217"><a href="#cb73-1217" aria-hidden="true" tabindex="-1"></a>Then we will create our plot by adding one <span class="in">`geom_function()`</span> layer for each region.</span>
<span id="cb73-1218"><a href="#cb73-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1219"><a href="#cb73-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1222"><a href="#cb73-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb73-1223"><a href="#cb73-1223" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rq3</span></span>
<span id="cb73-1224"><a href="#cb73-1224" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries from different regions of the world. Urbanization has been adjusted for by setting it to its mean value."</span></span>
<span id="cb73-1225"><a href="#cb73-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt: "Plot of predicted carbon emisssions as a function of wealth for the quadratic polynomial model shown for countries from different regions of the world. Urbanization has been adjusted for by setting it to its mean value."</span></span>
<span id="cb73-1226"><a href="#cb73-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "60%"</span></span>
<span id="cb73-1227"><a href="#cb73-1227" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library for color in caption</span></span>
<span id="cb73-1228"><a href="#cb73-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb73-1229"><a href="#cb73-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1230"><a href="#cb73-1230" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-1231"><a href="#cb73-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> carbon, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> co2)) <span class="sc">+</span></span>
<span id="cb73-1232"><a href="#cb73-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-1233"><a href="#cb73-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">082</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#1b2a41"</span>) <span class="sc">+</span> <span class="co">#Asia</span></span>
<span id="cb73-1234"><a href="#cb73-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">067</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#99c24d"</span>) <span class="sc">+</span> <span class="co">#Africa</span></span>
<span id="cb73-1235"><a href="#cb73-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">053</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#d30c7b"</span>) <span class="sc">+</span> <span class="co">#Americas</span></span>
<span id="cb73-1236"><a href="#cb73-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">047</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#adcad6"</span>) <span class="sc">+</span> <span class="co">#Europe</span></span>
<span id="cb73-1237"><a href="#cb73-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {.<span class="dv">096</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">1.28</span><span class="sc">*</span>x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>)}, <span class="at">color =</span> <span class="st">"#bc69aa"</span>) <span class="sc">+</span> <span class="co">#Oceania</span></span>
<span id="cb73-1238"><a href="#cb73-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb73-1239"><a href="#cb73-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Wealth"</span>) <span class="sc">+</span></span>
<span id="cb73-1240"><a href="#cb73-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted CO2 (in metric tons per person)"</span>) <span class="sc">+</span></span>
<span id="cb73-1241"><a href="#cb73-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-1242"><a href="#cb73-1242" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Region: &lt;b style = 'color:#1b2a41;'&gt;Asia&lt;/b&gt;, &lt;b style = 'color:#99c24d;'&gt;Africa&lt;/b&gt;, &lt;b style = 'color:#d30c7b;'&gt;Americas&lt;/b&gt;, &lt;b style = 'color:#adcad6;'&gt;Europe&lt;/b&gt;, and &lt;b style = 'color:#bc69aa;'&gt;Oceania&lt;/b&gt;. "</span></span>
<span id="cb73-1243"><a href="#cb73-1243" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-1244"><a href="#cb73-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb73-1245"><a href="#cb73-1245" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_textbox_simple</span>()</span>
<span id="cb73-1246"><a href="#cb73-1246" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-1247"><a href="#cb73-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb73-1248"><a href="#cb73-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1249"><a href="#cb73-1249" aria-hidden="true" tabindex="-1"></a>:::fyi</span>
<span id="cb73-1250"><a href="#cb73-1250" aria-hidden="true" tabindex="-1"></a>**Answering the Third Research Question**</span>
<span id="cb73-1251"><a href="#cb73-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1252"><a href="#cb73-1252" aria-hidden="true" tabindex="-1"></a>Here we see that in general wealthier countries have exponentially increasing CO2 emissions that begins to diminish for countries with exceptionally high wealth levels. This pattern is true for countries with both low and high urbanization, although the countries with higher urbanization have lower exponentially increasing carbon emissions.</span>
<span id="cb73-1253"><a href="#cb73-1253" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb73-1254"><a href="#cb73-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1255"><a href="#cb73-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1256"><a href="#cb73-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1257"><a href="#cb73-1257" aria-hidden="true" tabindex="-1"></a>&lt;br /&gt;</span>
<span id="cb73-1258"><a href="#cb73-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1259"><a href="#cb73-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1260"><a href="#cb73-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1261"><a href="#cb73-1261" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>